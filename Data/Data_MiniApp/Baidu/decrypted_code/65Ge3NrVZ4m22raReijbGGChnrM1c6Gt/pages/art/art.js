!function(e){e.global,e.Function;var t=e.setTimeout;e.setInterval,e.setImmediate,e.requestAnimationFrame,e.swanGlobal,e.jsNative,e.masterManager,e._openSourceDebugInfo,e.System,e.Bdbox_aiapps_jsbridge,e.Bdbox_android_jsbridge,e.Bdbox_android_utils,e._naFile,e._naInteraction,e._naNetwork,e._naRouter,e._naSetting,e._naStorage,e._naUtils,e.globalThis;window.define("20",(function(e,a,o,n,i,s,r,c,l,d,u,g,h,p,f,m,w,v,T,S,I,D,y){"use strict";var P=s();Component({properties:{isShowShareIcon:{type:Boolean,value:!0,observer:function(e,t){}},isShowShareDia:{type:Boolean,value:!1,observer:function(e,t){}},cover:{type:String,value:""},taiyangma:{type:String,value:""},title:{type:String,value:""},summary:{type:String,value:""}},data:{sqHide:!0,shareHide:!0,src:"",times:0},methods:{showShareDia:function(){this.setData({isShowShareDia:!0})},hideShareDia:function(e){this.setData({isShowShareDia:!1})},drawText:function(e,t,a,o,n,i){for(var s=t,r=0,c=i,l=0,d=0;d<e.length;d++)(r+=s.measureText(e[d]).width)>c-2*a&&(s.fillText(e.substring(l,d),a,o),o+=n,r=0,l=d),d==e.length-1&&s.fillText(e.substring(l,d+1),a,o);s.save()},drawTextFromRight:function(e,t,a,o,n,i){for(var s=t,r=0,c=i,l=0,d=0;d<e.length;d++)(r+=s.measureText(e[d]).width)>c-a&&(s.fillText(e.substring(l,d),a,o),o+=n,r=0,l=d),d==e.length-1&&s.fillText(e.substring(l,d+1),a-r,o);return s.save(),r},getImg:function(e,t){i.getImageInfo({src:e,success:function(e){t&&t(e)},fail:function(e){t&&t()}})},round:function(e,t,a,o,n,i){var s=Math.min(o,n);return i>s/2&&(i=s/2),e.beginPath(),e.moveTo(t+i,a),e.arcTo(t+o,a,t+o,a+n,i),e.arcTo(t+o,a+n,t,a+n,i),e.arcTo(t,a+n,t,a,i),e.arcTo(t,a,t+o,a,i),e.closePath(),e},saveImageDo:function(){var e=this;i.saveImageToPhotosAlbum({filePath:this.data.src,success:function(t){i.showToast({title:"图片保存成功！",icon:"success",duration:2e3}),e.setData({sqHide:!0})},fail:function(e){i.showToast({title:"图片保存失败！",icon:"none",duration:2e3})}})},saveImage:function(){var e=this;if(""==e.data.src||null==e.data.src)return P.alert("图片加载失败"),!1;i.getSetting({success:function(t){console.log(t.authSetting["scope.writePhotosAlbum"],"scope.writePhotosAlbum"),t.authSetting["scope.writePhotosAlbum"]?e.saveImageDo():(console.log(t.authSetting["scope.userInfo"],"scope.userInfo"),t.authSetting["scope.userInfo"]?i.openSetting({success:function(t){t.authSetting["scope.writePhotosAlbum"]||0==e.data.times?e.saveImageDo():(P.alert("授权失败"),e.setData({sqHide:!1}))}}):(i.authorize({scope:"scope.writePhotosAlbum",success:function(){e.saveImageDo()},fail:function(){0!=e.data.times&&i.openSetting({success:function(t){1==t.authSetting["scope.writePhotosAlbum"]?e.saveImageDo():(P.alert("授权失败"),e.setData({sqHide:!1}))}}),e.setData({times:++e.data.times,sqHide:!1})}}),console.log("到authorize来了吗？")))}})},drawImage:function(e){var a=this;e.draw(!0,(function(){t((function(){i.canvasToTempFilePath({x:0,y:0,width:670,height:1200,destWidth:1340,destHeight:2400,canvasId:"createImg",fileType:"png",success:function(e){a.setData({shareHide:!1,src:e.tempFilePath}),i.hideLoading()}})}),500)}))},drawImageBefore:function(){i.showLoading({title:"生成海报中..."});var e=this,t=i.createCanvasContext(e.data.canvasid||"createImg");e.round(t,0,0,670,1200,20),t.clip(),t.restore(),t.rect(0,0,670,1200),t.setFillStyle("#FFF"),t.fill(),t.draw(),e.getImg(e.data.taiyangma,(function(a){if(a){t.drawImage(a.path,278,965,120,120),t.fill();var o=e.data.cover||"https://www1.pconline.com.cn/weapp/2018/pconline/images/default_cover.jpg";e.getImg(o,(function(a){a&&(t.drawImage(a.path,0,0,670,501),e.drawImage(t)),e.getImg("https://www1.pconline.com.cn/weapp/2018/pconline/images/sharepic_pconline.png",(function(a){if(a){t.drawImage(a.path,0,421,670,80),t.save(),t.setFontSize(40),t.setTextAlign("left"),t.fillStyle="#333";var o=e.data.title;o.length>28&&(o=o.substring(0,28)+"..."),e.drawText(o,t,40,580,60,670),t.beginPath(),t.rect(40,690,80,4),t.setFillStyle("#333"),t.setFontSize(26),t.setTextAlign("left"),t.fillStyle="#777777";var n=e.data.summary.substring(0,60)+"......";e.drawText(n,t,40,760,46,630),t.fill(),t.beginPath(),t.rect(40,1025,219,1),t.rect(411,1025,219,1),t.setFillStyle("#eaeaea"),t.fill(),e.drawImage(t)}}))}));var n="长按识别二维码，进入太平洋电脑网查看原文";n.indexOf("太平洋电脑网");t.setFontSize(26),t.fillStyle="#333333";var s=n.substring(0,n.indexOf("太平洋电脑网")),r=n.substring(n.indexOf("太平洋电脑网")+"太平洋电脑网".length,n.length);t.fillText(s,75,1150,590),t.fillStyle="#247ef2",t.fillText("太平洋电脑网",75+t.measureText(s).width,1150,590),t.fillStyle="#333333",t.fillText(r,75+t.measureText(s+"太平洋电脑网").width,1150,590),t.fill()}else i.hideLoading(),P.alert("海报生成失败！")})),t.fill(),e.setData({isShowShareDia:!1})},createShare:function(){this.drawImageBefore()},onShow:function(){this.setData({sqHide:!0})},closeSqbox:function(){this.setData({sqHide:!0})},closeShare:function(){this.setData({shareHide:!0})}},attached:function(){this.onShow()}})})),window.define("25",(function(e,t,a,o,n,i,s,r,c,l,d,u,g,h,p,f,m,w,v,T,S,I,D){"use strict";Component({properties:{type:{type:String,value:"0"},proList:{type:Array,value:[],observer:function(e,t){}}},data:{swiperCurrent:0},attached:function(){},detached:function(){},methods:{swiperChangeCustom:function(e){this.setData({swiperCurrent:e.detail.current})}}})})),window.define("28",(function(e,t,a,o,n,i,s,r,c,l,d,u,g,h,p,f,m,w,v,T,S,I,D){"use strict";t.exports={formatTime:function(e){var t=e.split(","),a=new Date,o=new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5]),n=Math.ceil((a-o)/6e4);return 0<n&&n<60?n+"分钟":60<n&&n<1440?(n=Math.floor(n/60))+"小时":1440<n&&n<10080?(n=Math.floor(n/1440))+"天":10080<n&&n<40320?(n=Math.floor(n/10080))+"周":40320<n?(n=Math.round(n/43200))+"月":void 0}}})),window.define("34",(function(e,a,o,n,i,s,r,c,l,d,u,g,h,p,f,m,w,v,T,S,I,D,y){"use strict";function P(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var b=s(),C=e(32),_=e(35),x=e(28),A=e(40);Page({data:{articleId:"12063140",showSkeleton:!0,article:[],relation:[],videoUrl:"",isShowvideo:!1,scrollTop:0,goTop:!1,agreeNum:0,touched:"",showNum:"",disabled:"",voteTip:"您已经赞过了哦",isShowShareIcon:!0,isShowShareDia:!1,inputHide:!0,pageCmtNo:1,cmtPageNo:1,cmtPageSize:5,pageUrl:"",commentDataLen:0,__uuid:0,channalId:11567,needTieba:!1,cmtTop:0,cmtTitle:"评论",agreeTitle:"点赞",authorPic:"https://i7.3conline.com/images/upload/upc/face/0/0_100x100",openType:"redirect",ttsTxt:"播放",isPlay:!1,canUserTTS:!1,isAgree:0,agreeArr:[],isFaved:!1,favCode:2,favStatus:"收藏",logined:!1,showRelaPro:!1,productList:[],mallEventId:{2:646,3:647,more:645},bestProArr:[]},onLoad:function(e){var t=null!=i.getStorageSync(C.COMID),a=e.articleId||this.data.articleId;a.indexOf("_")>=0&&(a=a.split("_")[0]),this.setData({articleId:a,openType:1==getCurrentPages().length?"navigate":"redirect",logined:t}),console.log(getCurrentPages(),getCurrentPages().length,this.data.openType,"----------------------"),this.getArtsInfo(a);var o=i.canIUse("getStreamTTSManager");this.setData({canUserTTS:o}),this.data.canUserTTS&&this.initTTS(),this.query=i.createSelectorQuery(),this.getBestInfo()},onReady:function(){b.setvisited("art",(function(e){2==e&&b.ifSupport("3.70.00",(function(){console.log("show fav more than 2 times"),A.open("11")})),e>2&&t(b.addFav,3e3)})),this.setData({showSkeleton:!1})},onShow:function(){void 0!==this.data.articleId&&(this.checkFav(),this.getArtAgreeNum(this.data.articleId))},initTTS:function(){var e=this,t=i.getStreamTTSManager();t.streamStatus((function(e){console.log("streamStatus--------",JSON.stringify(e))})),t.onPlay((function(t){console.log("onPlay --------",JSON.stringify(t)),e.setData({ttsTxt:"暂停",isPlay:!0})})),t.onPause((function(t){console.log("onPause --------",JSON.stringify(t)),e.setData({ttsTxt:"播放",isPlay:!1})})),t.onEnded((function(t){console.log("onEnded --------",JSON.stringify(t)),e.setData({ttsTxt:"播放",isPlay:!1})})),t.onStop((function(t){console.log("onStop --------",JSON.stringify(t)),e.setData({ttsTxt:"播放",isPlay:!1})})),e.streamTTSManager=t},getBestInfo:function(){var e=this,t=C.getAPI("getJczInfo");i.request({url:t,header:{"content-type":"application/json"},success:function(t){var a=t.data;if(200===a.code){for(var o=[],n=0;n<a.data.length;n+=3)o.push(a.data.slice(n,n+3));console.log(o),e.setData({bestProArr:o}),console.log(e.data.bestProArr)}else console.log("getBestInfo:"),console.log(a.code);console.log(t),console.log(a)},fail:function(e){i.showToast({title:"网络不稳定，请检查网络或稍后再试！",icon:"none",duration:2e3})}})},speak:function(){this.data.isPlay?this.streamTTSManager.pause():(i.showToast({title:"开始播放"}),this.streamTTSManager.playStream({title:this.data.article.title,context:{paragraphCount:this.data.voiceContent.length,letterCount:this.data.contentWordLength,imageUrl:"",iconImageUrl:""},content:this.data.voiceContent}))},getArtsInfo:function(e){var a=this,o=e;i.showLoading({title:"加载中"}),t((function(){i.hideLoading()}),1e4);var n=C.getAPI("wx_art");n||console.error("wx_art is required!"),i.request({url:n,usePrefetchCache:!1,data:{articleId:o,refresh:!0},header:{"content-type":"application/json"},success:function(e){var o=e.data.data,n=o.content;n=(n=(n=n.replace(/(<div>)(.*?)(<\/div>)/g,"<p>$2</p>").replace(/<p(\s+[^>]*)?>/g,"<p>").replace(/<(h\d{1})([^>]*)>/g,"<$1>")).replace(/(<img\s+[^>]*src="\w+:\/\/ad.doubleclick\.net[^"]*"[^>]*>)/gi,"").replace(/<p(\s+[^>]*)?><img[^>]*style="display:none;"[^>]*><\/p>/g,"").replace(/<p(\s+[^>]*)?><iframe[^>]*><\/iframe><\/p>/g,"")).replace(/<img\s+([^>]*)src=\"(https:\/\/img\d)(w)([^"]*)(\/spcgroup\/width_640-qua_50)([^"]*(?=\.gif))([^"]*)"([^>]*)>/,(function(e,t,a,o,n,i,s,r,c){return console.log(e,t,a,o,n,i,s,r,c),"<img "+t+' src="'+a+n+s+"_thumb"+r+'"'+c+">"})),console.log("art=======",n),_.wxParse("art","html",n,a,5);var s=e.data.relation;s.map((function(e,t){e.publishDate=x.formatTime(e.publishDate2)})),a.setData({showSkeleton:!1,article:o,relation:s,pageUrl:o.commentUrl,authorPic:o.authorimg?o.authorimg:a.data.authorPic,__uuid:a.data.articleId,wd:o.title,productList:void 0!==e.data.data.productList?e.data.data.productList:[]});var r=n.replace(/(<\w+(\s+[^>]*)?>(\s)*<img[^>]*><\/\w+>)/g,"").replace(/<strong\s+class="js2-16[^"]*"[^>]*>(.*?)<\/strong>/g,"").replace(/(<\w+(\s+[^>]*)?>(\s*)<\/\w+>)/g,"").replace(/(<\w+(\s+[^>]*)?>(\s*)<\/\w+>)/g,"").match(/<p(\s+[^>]*)?>(.*?)<\/p>/g),c=0,l=r.map((function(e,t){return e=e.replace(/<\w+(\s+[^>]*)?>(.*?)<\/\w+>/g,"$2").replace(/<\w+(\s+[^>]*)?>(.*?)<\/\w+>/g,"$2").replace(/\s+/g,""),c+=e.length,{data:e,type:"text",index:t}}));a.setData({voiceContent:l,contentWordLength:c}),t((function(){i.hideLoading(),a.getCMTtop((function(e){a.setData({cmtTop:e})}))}),800),i.setPageInfo({title:a.data.article.title,keywords:a.data.article.keywords,description:a.data.article.summary,releaseDate:a.data.article.publishDate,image:o.headPicUrl?o.headPicUrl:"https://www1.pconline.com.cn/weapp/2018/pconline/images/default_cover.jpg",success:function(){console.log("setPageInfo success")},fail:function(e){console.log("setPageInfo fail",e)}})},fail:function(e){i.showToast({title:"网络不稳定，请检查网络或稍后再试！",icon:"none",duration:2e3}),t((function(){i.hideLoading()}),500)}})},getArtAgreeNum:function(e){var t=this,a=e,o=C.getAPI("wx_art_agree");o||console.error("wx_art_agree is required!"),i.request({url:o+"?act=getArticleCount&siteId=1&articleId="+a,header:{"content-type":"application/json"},data:P({},C.COMID,i.getStorageSync(C.COMID)),success:function(e){var a=e.data;console.log(e),t.setData({agreeNum:a.agreeCount,agreeTitle:a.agreeCount>0?a.agreeCount:"点赞",touched:"1"==a.isAgree?"touched":"",disabled:"1"==a.isAgree?"disabled":"",isAgree:a.isAgree})},fail:function(e){i.showToast({title:"网络不稳定，请检查网络或稍后再试！",icon:"none",duration:2e3})}})},addAgree:function(e){var t=this,a=t.data.isAgree||e.currentTarget.dataset.isAgree;if(!i.getStorageSync(C.COMID))return b.showToast("none","未登录!即将跳转登录页",(function(){i.navigateTo({url:"/pages/login/login"})})),!1;console.log(a);var o="1"==a?"delArtAgree":"addArtAgree",n=t.data.agreeNum,s=parseInt(t.data.articleId),r=C.getAPI("wx_art_addAgree");r||console.error("wx_art_addAgree is required!"),i.request({url:r+"?articleId="+s+"&act="+o+"&siteId=1&isAgree=1&req_enc=UTF-8&resp_enc=UTF-8",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:P({},C.COMID,i.getStorageSync(C.COMID)),success:function(e){console.log(e),0==e.data.code?"delArtAgree"==o?(n-=1,t.setData(P({showNum:"",agreeNum:n,touched:"",disabled:"",agreeTitle:0==n?"点赞":n,isAgree:"0"},C.COMID,i.getStorageSync(C.COMID))),b.alert("点赞已取消！")):(n+=1,t.setData({showNum:"showNum",agreeNum:n,touched:"touched",disabled:"disabled",agreeTitle:n,isAgree:"1"}),b.alert("点赞成功！")):(t.setData({showNum:"",touched:"touched",disabled:"disabled"}),b.alert("您已经点赞过了哦！"))},fail:function(e){b.alert("网络不稳定，请检查网络或稍后再试！")}})},checkFav:function(){var e=this,t=parseInt(e.data.articleId),a=C.getAPI("wx_art_addAgree");a||console.error("fav is required!"),i.request({url:a+"?act=isCollect&siteId=1&req_enc=UTF-8&resp_enc=UTF-8",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:P({articleId:t},C.COMID,i.getStorageSync(C.COMID)),success:function(t){console.log(t,"添加收藏");var a=t.data.code;e.setData({favCode:a,isFaved:1==a,favStatus:1==a?"已收藏":"收藏"})},fail:function(e){b.alert("网络不稳定，请检查网络或稍后再试！")}})},addFav:function(e){var a=this,o=e.currentTarget.dataset.faved;if(console.log(o),-1==a.data.favCode)return b.alert("未登录!即将跳转登录页"),t((function(){i.navigateTo({url:"/pages/login/login"})}),2500),!1;var n=1==o?"delMyCollection":"addArtCollect",s=parseInt(a.data.articleId),r=C.getAPI("wx_art_addAgree");r||console.error("wx_art_addFav is required!"),i.request({url:r+"?act="+n+"&siteId=1&req_enc=UTF-8&resp_enc=UTF-8",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:P({articleId:s},C.COMID,i.getStorageSync(C.COMID)),success:function(e){console.log(e),0==e.data.code?"delMyCollection"==n?(a.setData({isFaved:!1,favCode:2,favStatus:"收藏"}),b.alert("已取消收藏")):(a.setData({isFaved:!0,favCode:1,favStatus:"已收藏"}),b.alert("收藏成功！")):b.alert(e.data.message)},fail:function(e){b.alert("网络不稳定，请检查网络或稍后再试！")}})},countCmtTotal:function(e){this.setData({cmtTotal:e.detail.total})},loadComplete:function(e){if(e.detail.loadIsOk){var t=this.data.pageCmtNo+1;this.setData({pageCmtNo:t})}},hideInput:function(e){this.setData({inputHide:e.detail.hideInput})},commentDataLen:function(e){console.log(e.detail),this.setData({commentDataLen:e.detail.commentDataLen})},myPosChange:function(e){var t=e.detail.scrollTop;this.setData({scrollTop:t})},scroll:function(e){this.setData({goTop:e.detail.scrollTop>700})},playVideo:function(e){var t=e.currentTarget.dataset.src;this.setData({videoUrl:t,isShowvideo:!0})},showShareDia:function(){this.setData({isShowShareDia:!0})},minipChange:function(e){console.log(e,"成功")},minipFail:function(e){console.log(e,"失败")},wxParseTagATap:function(e){var t=e.currentTarget.dataset.src;"undefined"==t&&(t=this.data.article.pubUrl),t.indexOf("http:")<0&&t.indexOf("https:")<0&&(t="https:"+t),i.setClipboardData({data:t,success:function(e){b.alert("链接已复制，请在浏览器打开查看详情")},fail:function(){b.alert("复制链接失败！")}})},navigateToSmartProgram:function(){i.navigateToSmartProgram({appKey:"sc9Tq1iKawTnj5GhG6i77vzeIt4Crt5u",path:"baiduboxapp://swan/sc9Tq1iKawTnj5GhG6i77vzeIt4Crt5u/?_baiduboxapp=%7B%22from%22%3A%221151002300000000%22%2C%22ext%22%3A%7B%7D%7D&callback=_bdbox_js_275&upgrade=0",extraData:{foo:"baidu"},success:function(e){console.log("navigateToSmartProgram success",e)},fail:function(e){console.log("navigateToSmartProgram fail",e)}})},getCMTtotal:function(e){var t=e.detail.cmtTotal;t>0&&this.setData({cmtTitle:t})},getCMTtop:function(e){this.selectorQuery=i.createSelectorQuery(),this.selectorQuery.select("#JcmtBox").boundingClientRect().exec((function(t){console.log("节点信息",t);var a=t[0].top;e&&e(a)}))},scrollToCMT:function(){this.setData({toView:"JcmtBox"})},showProPopu:function(){this.setData({showRelaPro:!0})},closeProPopu:function(){this.setData({showRelaPro:!1})},stopHide:function(){return!1},onShareAppMessage:function(){return{title:this.data.article.title,path:"pages/art/art?articleId="+this.data.articleId,imageUrl:this.data.article.headPicUrl||"https://www1.pconline.com.cn/weapp/2018/pconline/images/default_cover.jpg"}}})})),window.__swanRoute="components/share/share",window.usingComponents=[],window.usingPluginComponents=[],require("20"),window.__swanRoute="components/best-swiper/best-swiper",window.usingComponents=["components/best-swiper/best-swiper"],window.usingPluginComponents=[],require("25"),window.__swanRoute="pages/art/art",window.usingComponents=["components/video/video","components/gohome/gohome","components/share/share","components/gotop/gotop","components/count/count","components/cmt/list/list","components/mallList/mallList","components/best-swiper/best-swiper"],window.usingPluginComponents=[],require("34")}(__hacked);
//# sourceMappingURL=C:\output\pages\art\art.js.map