window.defineDynamicLib("dynamicLib://swan-interaction",(function(t,e,i,n){t("src/comment-list/index",(function(t,e){e.exports={isSwanComponent:!0,swanComponentCss:[{path:"components/like/index.css"},{path:"components/list/index.css"},{path:"components/toolbar/index.css"},[1],".comment-list-view-more-slot","{border-top: 0.08vw solid #e6e6e6; height: 12vw; text-align: center; line-height: 3.13; margin: 0 4vw; font-size: 3.8400000000000003vw; }",[1],".comment-list-view-more:active","{opacity: .2; }",[1],".comment-list-view-more span","{vertical-align: middle; }",[1],".comment-list-view-more-arrow","{display: inline-block; vertical-align: middle; width: 2.8800000000000003vw; height: 2.8800000000000003vw; background-image: url('https://b.bdstatic.com/searchbox/icms/searchbox/img/swan-interaction/view-more-arrow-r.png'); background-size: 100% 100%; }"],swanComponentFactory:function(t,e){var i=m(t(2)),n=m(t(11)),s=t(3),o=t(9),a=t(6),c=t(12);function m(t){return t&&t.__esModule?t:{default:t}}var d={20000024:"手速太快，休息一下再试",20000025:"字数不符合规则，请修改后再试"},r=void 0;e.exports={template:'\n        <swan-comment-list>\n            <div\n                s-ref="commentListWrap"\n                class="comment-list-div"\n                on-mousewheel="addScrollEvent"\n                on-touchmove="addScrollEvent"\n            >\n                <comment-list \n                    s-if="__ready"\n                    s-ref="commentList"\n                    class="\n                        {{needToolbar ? \'comment-list-wrapper\' : \'\'}}\n                        {{isFolded ? \'comment-list-wrapper-folded\': \'\'}}\n                    "\n                    need-padding-bottom="{{__isNeedPaddingBottom}}"\n                    comment-list="{{commentList}}"\n                    is-page-scroll="{{isPageScroll}}"\n                    is-empty="{{__isEmpty}}"\n                    is-in-detail-page="{{__isInDetailPage}}"\n                    content-fold="{{true}}"\n                    has-child-reply="{{true}}"\n                    load-status="{{__loadStatus}}"\n                    is-folded="{{isFolded}}"\n                >\n                    <div\n                        slot="view-more"\n                        s-if="__fixedToolbarConfig.comment.count > foldNum"\n                        class="comment-list-view-more-slot">\n                        <div class="comment-list-view-more" on-click="clickViewMore">\n                            <span>查看</span>\n                            <span \n                                style="color: {{viewMoreStyle.color}}"\n                            >全部{{__fixedToolbarConfig.comment.count}}条</span>\n                            <span>评论</span>\n                            <span class="comment-list-view-more-arrow"></span>\n                        </div>\n                    </div>\n                </comment-list>\n            </div>\n            <tool-bar \n                s-if="{{__isBaiduAccount && (needToolbar || __isShowEditor)}}"\n                s-ref="toolbar"\n                is-show-reply-editor="{{__isShowEditor}}"\n                is-show-comment-in-web="{{isAllowCommentInWeb}}"\n                content="{{content}}"\n                tempFile="{{tempFile}}"\n                class="comment-list-toolbar"\n                placeholder="{{toolbarConfig.placeholder}}"\n                module-list="{{toolbarConfig.moduleList}}"\n                share-config="{{toolbarConfig.share}}"\n                like-config="{{__fixedToolbarConfig.like}}"\n                comment-config="{{__fixedToolbarConfig.comment}}"/>\n        </swan-comment-list>\n    ',components:{"comment-list":i.default,"tool-bar":n.default},initData:function(){return{commentParam:{},needToolbar:!0,toolbarConfig:{placeholder:"回复评论",moduleList:["comment","like","favor","share"],share:{title:""}},isPageScroll:!0,commentList:[],isFolded:!1,foldNum:3,viewMorePath:"",viewMoreStyle:{color:"#3388ff"},__isEmpty:!1,__loadStatus:c.LOAD_STATUS.MORE,__fixedToolbarConfig:{comment:{},like:{}},__ready:!1,__isBaiduAccount:!1,__isShowEditor:!1,__isInDetailPage:!1,content:"",isAllowCommentInWeb:!1,needPaddingBottom:!0,paddingBottom:""}},computed:{__isNeedPaddingBottom:function(){return this.data.get("needToolbar")&&this.data.get("needPaddingBottom")}},messages:{bindclickcomment:function(t){var e=t.value.item,i={status:"success",data:{srid:e.reply_id}};this.data.get("detailPath")&&this.navigateToDetail(e.reply_id),this.dispatchEvent("bindclickcomment",i)},publishcomment:function(t){this.publishComment(t.value)},loadmore:function(){this.loadMore()},"scroll-to-comment-list-top":function(){this.scrollToCommentListTop()},reply:function(t){this.publishComment(t.value)},replyInWeb:function(t){var e=t.value,i=e.res,n=e.type,s=e.item,o=e.index;this.publishComment({res:i,type:n,item:s,index:o})},openWebEditor:function(t){var e=this,i=t.value,n=i.item,s=i.index,o=i.type,a=this.data.get("needToolbar");this.data.set("__isShowEditor",!0),a?this.ref("toolbar").openWebEditor({type:o,placeholder:n.uname,item:n,index:s}):this.nextTick((function(){e.ref("toolbar").openWebEditor({type:o,placeholder:n.uname,item:n,index:s})}))},inputBlur:function(t){var e=t.value,i=e.content,n=e.tempFile;this.data.get("needToolbar")||(this.data.set("content",i),this.data.set("tempFile",n)),this.data.set("__isShowEditor",!1)}},created:function(){var t=this;this.data.set("__isBaiduAccount",(0,s.isBaiduAccount)()),this.start=0,this.bottomDistance=(0,s.isIphoneX)()?51:30,(0,s.allowCommentInWeb)().then((function(e){t.data.set("isAllowCommentInWeb",e)}));var e=this.data.get(),i=e.commentParam,n=e.isFolded,o=e.foldNum,a=e.viewMoreStyle;if(this.getInitCommentList(i),this.watch("commentParam",(function(e){return t.getInitCommentList(e)})),this.watch("addComment",(function(e){e&&(t.data.get("isAllowCommentInWeb")?(0,s.isLogin)()?(t.data.set("__isShowEditor",!0),t.nextTick((function(){t.ref("toolbar").openWebEditor({type:"add",from:"parent"})}))):(0,s.loginByAPI)(t).then((function(){t.data.set("__isShowEditor",!0),t.nextTick((function(){t.ref("toolbar").openWebEditor({type:"add",from:"parent"})}))})):t.publishComment({}))})),n){var c=o>10?10:o;this.data.set("foldNum",c),!a.color&&this.data.set("viewMoreStyle.color","#3388ff")}},attached:function(){this.listenCommentEvent();var t=this.data.get(),e=t.isPageScroll;!t.isFolded&&e&&(r=this.reachBottom.bind(this),window.addEventListener("scroll",r,{passive:!0}))},detached:function(){var t=this.data.get(),e=t.isPageScroll;!t.isFolded&&e&&window.removeEventListener("scroll",r,{passive:!0})},composeListRequestData:function(){var t=this.data.get(),e=t.isFolded,i=t.foldNum;return{use_list:1,num:e?i:c.LIST_PAGE_MAX_NUM,start:this.start,is_folded:e}},getInitCommentList:function(t){var e=this;if(t&&t.snid){this.start=0;var i=this.nativeAPI||this.swaninterface.boxjs;(0,s.getOpenId)(i).then((function(e){t.openid=e})).finally((function(){(0,s.storeCommentParam)(t);var i=e.composeListRequestData();(0,o.normalRequest)({commentApi:c.API_MAP_NAME.COMMENT_LIST,data:i}).then((function(t){if(0==+t.errno&&t.ret&&e.initCommentListData(t.ret),!t.ret.list.length)return Promise.reject()})).catch((function(){e.initEmptyCommentList();var t=c.LOG_PREFIX+"[Request failed] get comment list fail with data: "+JSON.stringify(i);(0,s.sendLog)(new Error(t))}))}))}else console.error("初始commentParam为空，请传入参数")},initCommentListData:function(t){var e=t.comment_count&&(0,s.isString)(t.comment_count)&&(0,s.isNumber)(+t.comment_count)?+t.comment_count:0,i=!!+t.is_uped,n=t.like_count&&(0,s.isString)(t.like_count)&&(0,s.isNumber)(+t.like_count)?+t.like_count:0;this.data.set("__fixedToolbarConfig.comment.count",e),this.data.set("__fixedToolbarConfig.like.isLiked",i),this.data.set("__fixedToolbarConfig.like.likeCount",n),t.list&&t.list.length&&(this.start+=c.LIST_PAGE_MAX_NUM,this.data.set("commentList",t.list),t.is_over&&this.data.set("__loadStatus",c.LOAD_STATUS.OVER)),this.data.set("__ready",!0)},initEmptyCommentList:function(){this.data.set("__isEmpty",!0),this.data.set("commentList",[]),this.data.set("__loadStatus",c.LOAD_STATUS.OVER),this.data.set("__ready",!0)},deleteComment:function(t,e){if(t){var i=this.data.get("commentList").findIndex((function(e){return e.reply_id===t}));this.data.splice("commentList",[i,1]),this.changeToolbarMsgCount(0,e),0===this.data.get("commentList").length&&this.data.set("__isEmpty",!0),swan.showToast({title:"删除成功"})}},publishComment:function(t){var e=this,i=t.res,n=void 0===i?"":i,o=t.type,a=void 0===o?c.PUBLISH_COMMENT_TYPE.REPLY:o,m=t.item,d=void 0===m?{}:m,r=t.index,p=void 0===r?0:r;if(this.data.get("__isBaiduAccount"))if((0,s.isLogin)()||(0,s.isWebInBrowser)())this.data.get("isAllowCommentInWeb")?this.sendCommentContent({res:n,type:a,item:d,index:p}):this.openEditor({type:a,item:d,index:p});else if(s.useBoxjsLogin){var l=this.nativeAPI||this.swaninterface.boxjs;(0,s.loginWithBoxjs)(l).then((function(){e.data.get("isAllowCommentInWeb")?e.sendCommentContent({res:n,type:a,item:d,index:p}):e.openEditor({type:a,item:d,index:p})}))}else this.dispatchEvent("bindunlogin",{type:a,item:d,index:p});else swan.showToast({title:c.PUBLISH_FAIL_TEXT.NOT_SUPPORT})},openEditor:function(t){var e=this,i=t.type,n=t.item,o=t.index,a=this.composeEditorPlaceholder({type:i,item:n});(0,s.openEditor)({contentPlaceholder:a}).then((function(t){t.status===c.EDITOR_STATUS.SEND&&e.sendCommentContent({res:t,type:i,item:n,index:o})})).catch((function(t){swan.closeReplyEditor(),(0,s.sendLog)(new Error(c.LOG_PREFIX+"openReplyEditor fail with error: "+JSON.stringify(t)))}))},composeEditorPlaceholder:function(t){var e=t.type,i=t.item;return e===c.PUBLISH_COMMENT_TYPE.SECONDARY_REPLY?"回复"+i.uname:c.EDITOR_DEFAULT_PLACEHOLDER},sendCommentContent:function(t){var e=this,i=t.res,n=t.type,s=t.item,a=t.index;this.composePublishRequestData({type:n,res:i,item:s}).then((function(t){(0,o.commentRequest)({commentApi:c.API_MAP_NAME.PUBLISH,data:t}).then((function(t){return e.publishSuccess({type:n,res:t,item:s,index:a})})).catch((function(t){return e.publishFail({type:n,err:t})}))})).catch((function(t){return e.publishFail({type:n,err:t})})).finally((function(){e.ref("toolbar")&&e.ref("toolbar").replyComplete(),e.data.set("__isShowEditor",!1),e.data.set("content",""),e.data.set("tempFile","")})),swan.closeReplyEditor()},composePublishRequestData:function(t){var e=t.type,i=t.res,n=t.item,o=e===c.PUBLISH_COMMENT_TYPE.SECONDARY_REPLY,a={comment:i.content};return o&&(a.spid=n.reply_id),(0,s.processImageParam)(i).then((function(t){return t&&(a.comment_images=t),Promise.resolve(a)})).catch((function(){return console}))},publishSuccess:function(t){var e=t.type,i=t.res,n=t.item,s=t.index;e===c.PUBLISH_COMMENT_TYPE.SECONDARY_REPLY?this.replyComment({item:n,index:s,res:i}):this.addComment(i),this.dispatchEvent("bindreply",{status:"success",data:{srid:i.reply_id}}),this.changeToolbarMsgCount(1)},publishFail:function(t){var e=t.type,i=t.err,n=d[i.errno]||c.PUBLISH_FAIL_TEXT.NORMAL,s=i.sub_msg;e===c.PUBLISH_COMMENT_TYPE.SECONDARY_REPLY&&s&&~s.indexOf(c.WAIT_TO_AUDIT_ERRNO)&&(n=c.PUBLISH_FAIL_TEXT.WAIT_TO_AUDIT),s&&~s.indexOf(c.FREQUENT_REQUEST_ERRNO)&&(n=c.PUBLISH_FAIL_TEXT.FREQUENT_REQUEST),swan.showToast({title:n,icon:"none"}),this.data.set("content","")},addComment:function(t){var e=this,i=this.data.get(),n=i.commentList,s=i.isFolded,o=i.foldNum;n.length?(this.data.unshift("commentList",t),s&&n.length>o&&this.data.pop("commentList")):this.data.set("commentList",[t]),this.nextTick((function(){e.scrollToCommentListTop()}))},replyComment:function(t){var e=this,i=t.item,n=t.index,s=t.res,o="commentList."+n+".reply_list",a="commentList."+n+".reply_count";i.reply_list&&Object.keys(i.reply_list).length?this.data.unshift(o,s):this.data.set(o,[s]),this.nextTick((function(){e.data.set(a,++i.reply_count)}))},canLoadMore:function(){var t=this.data.get("__loadStatus");return"LOAD"!==t&&"OVER"!==t},loadMore:function(){var t=this;if(this.canLoadMore()){var e=this.data.get("__loadStatus");this.data.set("__loadStatus",c.LOAD_STATUS.LOAD);var i=this.composeListRequestData(),n=(0,o.commentRequest)({commentApi:c.API_MAP_NAME.COMMENT_LIST,data:i});n?n.then((function(e){0==+e.errno&&e.ret&&e.ret.list?t.loadMoreSuccess(e.ret):t.loadMoreFail()})).catch((function(){return t.loadMoreFail()})):this.data.set("__loadStatus",e)}},loadMoreSuccess:function(t){var e=this.data.get("commentList");e=e.concat(t.list),this.data.set("commentList",e),this.data.set("__loadStatus",t.is_over?c.LOAD_STATUS.OVER:c.LOAD_STATUS.MORE),this.start+=c.LIST_PAGE_MAX_NUM},loadMoreFail:function(){this.data.set("__loadStatus",c.LOAD_STATUS.FAIL)},changeToolbarMsgCount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=this.data.get("__fixedToolbarConfig.comment.count")||0;i=t?i+e:i-e,this.data.set("__fixedToolbarConfig.comment.count",i)},scrollToCommentListTop:function(){var t=this.data.get("isPageScroll");t?(0,a.scrollToSelector)(this.ref("commentList"),t):(0,a.scrollSmoothTo)(this.ref("commentListWrap"),0)},addScrollEvent:function(){var t=this.data.get(),e=t.isFolded,i=t.isPageScroll;if(!e&&!i){var n=this.ref("commentListWrap");n.scrollTop+n.offsetHeight+this.bottomDistance>=n.scrollHeight&&this.loadMore()}},reachBottom:function(){(0,a.getScrollTop)()+(0,a.getWindowHeight)()+this.bottomDistance>=(0,a.getScrollHeight)()&&this.loadMore()},navigateToDetail:function(t){var e=this.data.get("detailPath");e+=~e.lastIndexOf("?")?"&srid="+t:"?srid="+t,(0,s.sendMessageToMaster)({context:this,eventType:"navigate",eventValue:{type:"navigateTo",params:{url:e}}})},updateCommentList:function(){var t=this,e=this.composeListRequestData();e.start=0,(0,o.normalRequest)({commentApi:c.API_MAP_NAME.COMMENT_LIST,data:e}).then((function(e){if(0==+e.errno&&e.ret){var i=t.data.get(),n=i.commentList;i.isFolded?t.data.set("commentList",e.ret.list):t.data.set("commentList",(0,s.mergeArrayByKey)(n,e.ret.list,"reply_id")),t.data.set("__fixedToolbarConfig.comment.count",+e.ret.comment_count)}})).catch((function(){}))},listenCommentEvent:function(){var t=this;try{this.communicator.onMessage(c.MESSAGE_TYPE.DEL_COMMENT,(function(e){if(!t.data.get("isFolded")){var i=e.value,n=i.srid,s=i.count;t.deleteComment(n,s)}})),this.communicator.onMessage(c.MESSAGE_TYPE.UPDATE_LIST,(function(){t.updateCommentList()}))}catch(t){t.message="[Lifecycle attached] call communicator fail:\n "+t.message,(0,s.sendLog)(t)}},clickViewMore:function(){var t=this.data.get("viewMorePath");t&&(0,s.sendMessageToMaster)({context:this,eventType:"navigate",eventValue:{type:"navigateTo",params:{url:t}}}),this.dispatchEvent("bindviewmore")}}}}})),t("2",(function(t,e){var i=t(3),n=t(6),s=a(t(7)),o=a(t(8));function a(t){return t&&t.__esModule?t:{default:t}}var c={MORE:"点击加载更多",LOAD:"正在加载...",OVER:"已经到底啦",FAIL:"加载失败 点击重新加载"};e.exports={template:s.default,filters:{transformTime:function(t){return(0,i.passedTimeTransfer)(t)}},components:{like:o.default},computed:{commentCount:function(){return this.data.get("commentList").length},bottomText:function(){return c[this.data.get("loadStatus")]},commentPaddingClass:function(){return this.data.get("needPaddingBottom")?(0,i.isIphoneX)()?"comment-list-padding-bottom-with-safe-area":"comment-list-wrapper-padding-bottom":""}},created:function(){var t=this;(0,i.allowCommentInWeb)().then((function(e){t.data.set("isShowCommentInWeb",e)}))},attached:function(){this.data.get("needMoreBtn")&&window.addEventListener("click",this.hideMoreOperation.bind(this)),window.getInterActionCopyText=i.getCopyResult},detached:function(){this.data.get("needMoreBtn")&&window.removeEventListener("click",this.hideMoreOperation.bind(this)),window.getInterActionCopyText=void 0},initData:function(){return{needMoreBtn:!1,showMoreOptionsUp:!1,contentFold:!1,allowDelete:!1,hasParentReply:!1,hasChildReply:!1,isPageScroll:!0,loadStatus:"MORE",commentList:[],emptyImg:"https://b.bdstatic.com/searchbox/icms/searchbox/img/empty-comment.png",isIphoneX:(0,i.isIphoneX)(),isFolded:!1,isShowCommentInWeb:!1,isInDetailPage:!1,disabledInput:!(0,i.getEnv)("isLogin"),needPaddingBottom:!0,paddingBottom:""}},contentUrl:function(t){var e=t.thumb&&t.thumb.url;return e&&/\.gif/.test(e)&&(e=t.large.url),e},replyLikeStatus:function(t){return t&&+t?1:0},sliceReplyList:function(t){return t.reply_list&&t.reply_list.slice(0,2)},hasMoreReply:function(t){return t.reply_count&&+t.reply_count>2},hasReplyToInfo:function(t){return this.data.get("hasChildReply")&&t.reply_list&&Object.keys(t.reply_list).length},hasDetailReplyToReply:function(t){return this.data.get("hasParentReply")&&t.reply_to_single_comment&&Object.keys(t.reply_to_single_comment).length},isShowMoreOperation:function(t){return this.data.get("commentList."+t+".isShowMore")},clickListItem:function(t){var e=t.item,i=t.index;this.dispatch("bindclickcomment",{item:e,index:i})},navToPersonalHome:function(t){t&&(0,i.isBaiduApp)()&&(0,i.openUserProfile)(t)},showMoreOperation:function(t){(0,n.getWindowHeight)()-t.target.getBoundingClientRect().bottom<120?this.data.set("showMoreOptionsUp",!0):this.data.set("showMoreOptionsUp",!1);var e=+t.target.dataset.index,i="commentList."+e+".isShowMore",s=this.data.get(i);this.data.set(i,!s),this.hideMoreOperation(e)},hideMoreOperation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=this.data.get("commentList");if(e.length){var i=!0,n=!1,s=void 0;try{for(var o,a=Object.keys(e)[Symbol.iterator]();!(i=(o=a.next()).done);i=!0){var c=o.value;t!==+c&&e[c].isShowMore&&this.data.set("commentList."+c+".isShowMore",!1)}}catch(t){n=!0,s=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw s}}}},delComment:function(t){var e=t.item,i=t.index;this.dispatch("binddelete",{item:e,index:i})},publishComment:function(t){var e=t.type,i=void 0===e?"add":e,n=t.item,s=void 0===n?{}:n,o=t.index,a=void 0===o?0:o;this.dispatch("publishcomment",{type:i,item:s,index:a})},tipOff:function(t){var e=t.item,i=t.index;this.dispatch("tipoff",{item:e,index:i})},changeEmoji:function(t){return(0,i.changeEmoji)(t)},copy:function(t){swan.setClipboardData({data:t,success:function(){swan.showToast({title:"已复制到剪贴板"})}})},previewImage:function(t){var e=t.large&&t.large.url;e&&swan.previewImage({current:e,urls:[e]})},loadMore:function(){this.dispatch("loadmore")},openToolbarEditor:function(t,e){var n=this,s=e.item,o=void 0===s?{}:s,a=e.index,c=void 0===a?0:a,m=e.type,d=void 0===m?"add":m;if(t.stopPropagation(),!(0,i.getEnv)("isLogin"))return this.data.set("disabledInput",!0),void(0,i.loginByAPI)(this.owner).then((function(){n.dispatch("openWebEditor",{item:o,index:c,type:d})})).finally((function(){n.data.set("disabledInput",!1)}));this.data.set("disabledInput",!1),this.dispatch("openWebEditor",{item:o,index:c,type:d})}}})),t("3",(function(t,e){var i,n=t(4),s=(i=t(5))&&i.__esModule?i:{default:i},o={systemInfo:{swanApi:"getSystemInfoSync",defaultValue:{}},isLogin:{swanApi:"isLoginSync",childKey:"isLogin",defaultValue:!1},appKey:{swanApi:"getEnvInfoSync",childKey:"appKey",defaultValue:""},swanId:{swanApi:"getSwanId",childKey:"swanid",defaultValue:""}},a={},c=function(t){if(!a[t]){var e=o[t],i=e.swanApi,n=e.childKey,s=e.defaultValue;try{var c=swan[i]();a[t]=n?c[n]:c}catch(e){a[t]=s||""}}return a[t]},m=function(){var t=this;return new Promise((function(e){if(a.appInfo&&Object.keys(a.appInfo).length)return e(a.appInfo);a.appInfo={scene:""};var i=t.nativeAPI||t.swaninterface.boxjs;try{a.appInfo=i.data.get({name:"swan-appInfoSync"})}catch(t){}e(a.appInfo)}))},d=function(t){return new Promise((function(e,i){try{swan.uploadFileToBos({filePath:t,success:e,fail:function(t){return i(t)}})}catch(t){i("当前环境不支持 swan.uploadFileToBos")}}))},r=function(){return"web"===c("systemInfo").platform&&!("index"===window._swanWebGlobal._SWAN_ENV?window:window.parent)._naSwan},p=["iphone x","iphone 11","iphone 12","iphone 13"],l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"yyyy-MM-dd hh:mm:ss";try{var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));var i=!0,n=!1,s=void 0;try{for(var o,a=Object.keys(e)[Symbol.iterator]();!(i=(o=a.next()).done);i=!0){var c=o.value;if(new RegExp("("+c+")").test(t)){var m=e[c];t=t.replace(RegExp.$1,1===RegExp.$1.length?m:("00"+m).substr((""+m).length))}}}catch(t){n=!0,s=t}finally{try{!i&&a.return&&a.return()}finally{if(n)throw s}}return t}catch(t){return""}},h=function(t){a.commentParam=t},u=function(){return a.commentParam},f=function(){var t=c("systemInfo").host;return"baiduboxapp"===t||"web"===t},g=function(t,e){t=t.split("."),e=e.split(".");for(var i=Math.max(t.length,e.length);t.length<i;)t.push("0");for(;e.length<i;)e.push("0");for(var n=0;n<i;n++){var s=parseInt(t[n],10),o=parseInt(e[n],10);if(s>o)return 1;if(s<o)return-1}return 0},b=c("systemInfo").SDKVersion,_=g(b,"3.270.0")>=0,v=g(b,"3.710.0")>=0,w=function(t){return new Promise((function(e,i){"devtools"===c("systemInfo").platform?i():t.invoke({name:"getOpenId",data:{callback:function(t){0==+t.status?e(t.data.openid):i(t)}}}).catch((function(t){i(t)}))}))},x=function(t){return new Promise((function(e,i){t.invoke({name:"login",data:{invokeFrom:"component",callback:function(n){0==+n.status?w(t).then((function(t){h(Object.assign({},u(),{openid:t})),e(n)})).catch((function(t){console.warn("开发者工具和 web 化中不支持发布评论"),i(t)})):i(n)}}})}))},y=function(t){return Object.prototype.toString.call(t).slice(8,-1)},E=void 0,T=function(t){if(!t)return"";var e="";return s.default.packages[0].emoticons.forEach((function(i){i.text===t&&(e=i.icon)})),e};function I(t){for(;!(t.nativeAPI&&t.swaninterface||"swan-page"===t.tagName);)t=t.parent.owner;return t}e.exports={loginStatusUbcReporter:function(t,e){var i=this.nativeAPI||this.swaninterface.boxjs;m().then((function(n){var s={ubcId:"1936",data:{from:"swan",type:"swan-interaction-login",value:e,ext:{invokeFrom:t,appName:n.appname}}};i.log({name:"boxjs.ubcStatisticEvent",data:s})}))},getEnv:c,getEnvAsync:function(t){var e=o[t],i=e.swanApi,n=e.childKey,s=e.defaultValue;return void 0===a[t]&&swan[i]?new Promise((function(e,o){swan[i]({success:function(i){a[t]=(n?i.data[n]:i.data)||s,e(a[t])},fail:function(t){o(t)}})})):("undefined"===a[t]&&(a[t]=s||""),Promise.resolve(a[t]))},getAppInfo:m,openEditor:function(t){var e=t.contentPlaceholder,i=void 0===e?"回复评论":e;return new Promise((function(t,e){try{swan.openReplyEditor({sendBackgroundColor:"#fff",sendTextColor:"#4e6ef2",sendText:"发送",contentPlaceholder:i,moduleList:v?["image","emoji"]:["image"],emojiPath:v?"dynamicLib://swan-interaction/emojidata":"",success:t,fail:e})}catch(t){e("当前环境不支持 swan.openReplyEditor")}}))},openUserProfile:function(t){swan.openUserProfile&&swan.openUserProfile({scheme:t})},isIphoneX:function(){return void 0===a.isIphoneX&&(a.isIphoneX=function(){try{var t=c("systemInfo"),e=t.model.toLowerCase();return!(!e.includes("iphone")||r())&&(t.safeArea?t.screenHeight>t.safeArea.bottom:!!p.find((function(t){return e.includes(t)})))}catch(t){return!1}}()),a.isIphoneX},mergeArrayByKey:function(t,e,i){var n=e.map((function(t){return[t[i],t]})),s=new Map(n);return t.map((function(t){return Object.assign({},t,s.get(t[i])||{})}))},passedTimeTransfer:function(t){try{var e=new Date(1e3*+t),i=l.apply(e,["yyyy-MM-dd-hh-mm"]).split("-"),n=l.apply(new Date,["yyyy-MM-dd-hh-mm"]).split("-").map((function(t,e){return+t-+i[e]}));switch(!0){case n[0]>=1:return l.apply(e,["yyyy-MM-dd"]);case n[1]>=1:return l.apply(e,["MM-dd"]);case n[2]>1:return n[2]+"天前";case 1===n[2]:return"昨天";case n[3]>=1&&n[4]>=0:return n[3]+"小时前";case n[3]>=1:return 60+n[4]+"分钟前";case n[4]>=1:return n[4]+"分钟前";default:return"刚刚"}}catch(t){return""}},storeCommentParam:h,getCommentParam:u,isLogin:function(){return c("isLogin")&&a.commentParam&&a.commentParam.openid},processImageParam:function(t){return new Promise((function(e,i){var n,s=r()?t.tempFile:t.tempFile&&t.tempFile.path;s?Promise.all([d(s),(n=s,new Promise((function(t,e){swan.getImageInfo&&swan.getImageInfo({src:n,success:t,fail:function(t){return e(t)}})})))]).then((function(t){var i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],n=!0,s=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(n=(a=c.next()).done)&&(i.push(a.value),!e||i.length!==e);n=!0);}catch(t){s=!0,o=t}finally{try{!n&&c.return&&c.return()}finally{if(s)throw o}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(t,2),n=i[0],s=i[1],o=[{url:n.bosUrl,height:s.height+"",width:s.width+"",type:"gif"===s.type?"1":"0"}];e(o)})).catch((function(t){return i(t)})):e()}))},sendMessageToMaster:function(t){var e=t.context,i=t.eventType,n=t.eventValue;try{e.communicator.sendMessage("master",{type:i,value:n,slaveId:e.slaveId})}catch(t){}},sendLog:function(t){m().then((function(e){var i=e.appid,n=window.pageInfo.accessUri;_swanApp&&_swanApp.thirdExceptionReporter.warn({error:t,ext:{pagePath:n,appId:i}},{isPrint:!1})})).catch(console.error)},isBaiduApp:f,isBaiduAccount:function(){try{return swan.isBaiduAccountSync().isBaiduAccount}catch(t){return console.warn("当前环境不支持 swan.isBaiduAccountSync"),f()}},useBoxjsLogin:_,loginWithBoxjs:x,isWebInBrowser:r,getOpenId:w,isNumber:function(t){return"Number"===y(t)},isString:function(t){return"String"===y(t)},allowCommentInWeb:function(){return new Promise((function(t,e){return void 0!==E?t(E):r()?void m().then((function(i){var s={app_key:i.bundleId,component_name:"swan-interaction"};swan.request({url:n.commentApiMap.getPrivilige,method:"GET",data:s,dataType:"json",header:{"content-type":"application/json"},success:function(i){return 200==+i.statusCode&&0==+i.data.errno?(E=i.data.data&&i.data.data.is_web_available,t(E)):e()},fail:function(){return e()}})})).catch((function(){return e()})):(E=!1,e())}))},isAndroid:function(){return c("systemInfo").system.toLowerCase().indexOf("android")>=0},isIOS:function(){return c("systemInfo").system.toLowerCase().indexOf("ios")>=0},isQuark:function(){return window.navigator.userAgent.toLowerCase().indexOf("quark")>=0},needCompatForiOS:function(){return c("systemInfo").system.toLowerCase().indexOf("ios 16")>=0},getIndexWindow:function(){return window._swanWebGlobal&&"index"===window._swanWebGlobal._SWAN_ENV?window:window.parent},animate:function(t){var e=t.timing,i=t.draw,n=t.params,s=t.duration,o=t.callback,a=performance.now();requestAnimationFrame((function t(c){var m=(c-a)/s;m>1&&(m=1);var d=e(m);i(Object.assign({},n,{progress:d})),m<1?requestAnimationFrame(t):o&&o()}))},getOwnerWithModules:I,loginByAPI:function(t){return new Promise((function(e,i){if(_){var n=I(t),s=n.nativeAPI||n.swaninterface.boxjs;x(s).then((function(){e("useBoxjsLogin")})).catch((function(t){i(t)}))}else swan.login({success:function(){e("useSwanLogin")},fail:function(t){i()}})}))},changeEmoji:function(t){if(!t)return t;for(var e=[],i=[],n=0;n<t.length;n++){var s=t.charAt(n);if("["===s&&i.length>0){var o=i.join("");e.push({type:"text",value:o}),(i=[]).push(s)}else if("]"===s&&i.length>0){i.push(s);var a=i.join(""),c=T(a),m=c?{type:"img",value:c,tag:a}:{type:"text",value:a};e.push(m),i=[]}else i.push(s)}if(0!==i.length){var d=i.join("");e.push({type:"text",value:d})}return e},getCopyResult:function(){var t="",e=window.getSelection().getRangeAt(0).cloneContents();return e&&e.childNodes&&0!==e.childNodes.length?(e.childNodes.forEach((function(e){3===e.nodeType?t+=e.nodeValue:1===e.nodeType&&e.childNodes.forEach((function(e){"IMG"===e.nodeName?t+=e.alt:"SPAN"===e.nodeName&&(t+=e.innerText.trimLeft())}))})),t):t}}})),t("4",(function(t,e){var i="https://ossapi.baidu.com",n={comment:i+"/ma/component/comment",commentList:i+"/ma/component/comment/list",commentDetail:i+"/ma/component/comment/detail",commentDelete:i+"/ma/component/comment/delete",commentReport:i+"/ma/component/comment/report",likeUgc:i+"/oss/publisher/ugc/like",likeComment:i+"/ma/component/comment/like",getPrivilige:i+"/ma/component/getconfig"};e.exports={commentApiMap:n}})),t("5",(function(t,e){e.exports=JSON.parse('{"version":"1","packages":[{"id":"1","name":"emoji","package_icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/package_01.png","emoticons":[{"id":"001001","text":"[微笑]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_01.png"},{"id":"001004","text":"[大笑]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_04.png"},{"id":"001005","text":"[鼓掌]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_05.png"},{"id":"001206","text":"[嘻嘻]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_206.png"},{"id":"001023","text":"[色]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_23.png"},{"id":"001025","text":"[得意]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_25.png"},{"id":"001159","text":"[挤眼]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_159.png"},{"id":"001071","text":"[滑稽]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_71.png"},{"id":"001197","text":"[困]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_197.png"},{"id":"001271","text":"[虎年大吉]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_271.png"},{"id":"001079","text":"[财神]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_79.png"},{"id":"001251","text":"[牛福到]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_251.png"},{"id":"001056","text":"[中国加油]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_56.png"},{"id":"001011","text":"[汗]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_11.png"},{"id":"001073","text":"[左捂脸]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_73.png"},{"id":"001266","text":"[金牌]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_266.png"},{"id":"001274","text":"[银牌]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_274.png"},{"id":"001275","text":"[铜牌]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_275.png"},{"id":"001272","text":"[虎妞妞]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_272.png"},{"id":"001273","text":"[小脑斧]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_273.png"},{"id":"001196","text":"[可怜]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_196.png"},{"id":"001024","text":"[舔屏]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_24.png"},{"id":"001065","text":"[打call]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_65.png"},{"id":"001003","text":"[期待]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_03.png"},{"id":"001098","text":"[亲吻]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_98.png"},{"id":"001012","text":"[抠鼻]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_12.png"},{"id":"001219","text":"[ok啊]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_219.png"},{"id":"001068","text":"[没眼看]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_68.png"},{"id":"001034","text":"[偷笑]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_34.png"},{"id":"001013","text":"[哼]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_13.png"},{"id":"001033","text":"[你懂的]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_33.png"},{"id":"001215","text":"[欧耶]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_215.png"},{"id":"001016","text":"[不高兴]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_16.png"},{"id":"001066","text":"[尬笑]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_66.png"},{"id":"001239","text":"[泪奔]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_239.png"},{"id":"001019","text":"[大哭]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_19.png"},{"id":"001020","text":"[流泪]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_20.png"},{"id":"001038","text":"[鄙视]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_38.png"},{"id":"001015","text":"[委屈]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_15.png"},{"id":"001228","text":"[挠头]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_228.png"},{"id":"001192","text":"[费解]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_192.png"},{"id":"001026","text":"[疑问]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_26.png"},{"id":"001226","text":"[苦思冥想]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_226.png"},{"id":"001027","text":"[晕]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_27.png"},{"id":"001051","text":"[爱钱]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_51.png"},{"id":"001069","text":"[嘿哈]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_69.png"},{"id":"001029","text":"[二哈]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_29.png"},{"id":"001028","text":"[大哈]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_28.png"},{"id":"001030","text":"[三哈]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_30.png"},{"id":"001217","text":"[惊恐]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_217.png"},{"id":"001241","text":"[石化]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_241.png"},{"id":"001041","text":"[衰]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_41.png"},{"id":"001018","text":"[惊哭]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_18.png"},{"id":"001009","text":"[啊]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_09.png"},{"id":"001166","text":"[生病]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_166.png"},{"id":"001037","text":"[再见]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_37.png"},{"id":"001036","text":"[哈欠]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_36.png"},{"id":"001187","text":"[并不简单]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_187.png"},{"id":"001218","text":"[社会]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_218.png"},{"id":"001216","text":"[嫌弃]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_216.png"},{"id":"001031","text":"[白眼]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_31.png"},{"id":"001002","text":"[开心]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_02.png"},{"id":"001067","text":"[坏笑]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_67.png"},{"id":"001022","text":"[亲亲]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_22.png"},{"id":"001221","text":"[撇嘴]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_221.png"},{"id":"001188","text":"[馋嘴]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_188.png"},{"id":"001203","text":"[思考]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_203.png"},{"id":"001220","text":"[耶耶耶]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_220.png"},{"id":"001191","text":"[顶]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_191.png"},{"id":"001154","text":"[感冒]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_154.png"},{"id":"001222","text":"[emmm]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_222.png"},{"id":"001044","text":"[闭嘴]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_44.png"},{"id":"001231","text":"[摸头]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_231.png"},{"id":"001209","text":"[右哼哼]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_209.png"},{"id":"001210","text":"[左哼哼]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_210.png"},{"id":"001202","text":"[失望]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_202.png"},{"id":"001017","text":"[囧]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_17.png"},{"id":"001039","text":"[抓狂]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_39.png"},{"id":"001040","text":"[咒骂]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_40.png"},{"id":"001070","text":"[前面的别走]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_70.png"},{"id":"001050","text":"[友军]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_50.png"},{"id":"001049","text":"[同上]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_49.png"},{"id":"001195","text":"[互粉]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_195.png"},{"id":"001122","text":"[加油啊]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_122.png"},{"id":"001238","text":"[呕]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_238.png"},{"id":"001189","text":"[吃瓜]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_189.png"},{"id":"001227","text":"[奥利给]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_227.png"},{"id":"001043","text":"[嘘]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_43.png"},{"id":"001224","text":"[拒绝]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_224.png"},{"id":"001225","text":"[观望]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_225.png"},{"id":"001232","text":"[nonono]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_232.png"},{"id":"001237","text":"[戳脸]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_237.png"},{"id":"001236","text":"[走你]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_236.png"},{"id":"001230","text":"[无所谓]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_230.png"},{"id":"001223","text":"[暗中观察]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_223.png"},{"id":"001190","text":"[打脸]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_190.png"},{"id":"001010","text":"[哟]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_10.png"},{"id":"001233","text":"[握草]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_233.png"},{"id":"001234","text":"[苦笑]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_234.png"},{"id":"001032","text":"[阴险]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_32.png"},{"id":"001045","text":"[呆]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_45.png"},{"id":"001168","text":"[太开心]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_168.png"},{"id":"001186","text":"[悲伤]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_186.png"},{"id":"001148","text":"[爱你]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_148.png"},{"id":"001006","text":"[悠闲]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_06.png"},{"id":"001046","text":"[什么鬼]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_46.png"},{"id":"001235","text":"[饮酒醉]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_235.png"},{"id":"001047","text":"[吐]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_47.png"},{"id":"001240","text":"[额]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_240.png"},{"id":"001229","text":"[凝视]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_229.png"},{"id":"001008","text":"[不要啊]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_08.png"},{"id":"001175","text":"[武汉加油]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_175.png"},{"id":"001256","text":"[温暖]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_256.png"},{"id":"001257","text":"[Salute]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_257.png"},{"id":"001258","text":"[叹气]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_258.png"},{"id":"001259","text":"[裂开]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_259.png"},{"id":"001260","text":"[厉害]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_260.png"},{"id":"001261","text":"[吃鲸]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_261.png"},{"id":"001263","text":"[AWSL]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_263.png"},{"id":"001072","text":"[捂脸]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_72.png"},{"id":"001007","text":"[笑哭]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_07.png"},{"id":"001014","text":"[发怒]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_14.png"},{"id":"001021","text":"[害羞]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_21.png"},{"id":"001194","text":"[黑线]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_194.png"},{"id":"001156","text":"[给力]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_156.png"},{"id":"001262","text":"[比心]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_262.png"},{"id":"001057","text":"[庆祝]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_57.png"},{"id":"001264","text":"[打工人]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_264.png"},{"id":"001265","text":"[小红花]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_265.png"},{"id":"001048","text":"[已阅]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_48.png"},{"id":"001162","text":"[男孩儿]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_162.png"},{"id":"001163","text":"[女孩儿]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_163.png"},{"id":"001185","text":"[抱抱]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_185.png"},{"id":"001193","text":"[跪了]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_193.png"},{"id":"001204","text":"[摊手]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_204.png"},{"id":"001167","text":"[酸]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_167.png"},{"id":"001074","text":"[666]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_74.png"},{"id":"001123","text":"[勤洗手]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_123.png"},{"id":"001125","text":"[n95口罩]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_125.png"},{"id":"001207","text":"[心]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_207.png"},{"id":"001124","text":"[中国]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_124.png"},{"id":"001055","text":"[鲜花]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_55.png"},{"id":"001160","text":"[礼物]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_160.png"},{"id":"001176","text":"[喜]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_176.png"},{"id":"001150","text":"[旅行]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_150.png"},{"id":"001173","text":"[围脖]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_173.png"},{"id":"001165","text":"[伤心]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_165.png"},{"id":"001060","text":"[赞同]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_60.png"},{"id":"001095","text":"[双手鼓掌]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_95.png"},{"id":"001211","text":"[作揖]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_211.png"},{"id":"001200","text":"[拳头]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_200.png"},{"id":"001212","text":"[haha]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_212.png"},{"id":"001208","text":"[耶]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_208.png"},{"id":"001205","text":"[握手]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_205.png"},{"id":"001214","text":"[ok]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_214.png"},{"id":"001198","text":"[来]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_198.png"},{"id":"001201","text":"[弱]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_201.png"},{"id":"001101","text":"[加油]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_101.png"},{"id":"001213","text":"[NO]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_213.png"},{"id":"001184","text":"[good]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_184.png"},{"id":"001105","text":"[小黄鸭]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_105.png"},{"id":"001102","text":"[泡泡枪]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_102.png"},{"id":"001104","text":"[棒棒糖]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_104.png"},{"id":"001114","text":"[小老鼠]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_114.png"},{"id":"001199","text":"[喵喵]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_199.png"},{"id":"001053","text":"[国宝]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_53.png"},{"id":"001054","text":"[羊驼]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_54.png"},{"id":"001170","text":"[兔子]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_170.png"},{"id":"001174","text":"[围观]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_174.png"},{"id":"001118","text":"[钱袋]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_118.png"},{"id":"001117","text":"[灯笼]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_117.png"},{"id":"001151","text":"[点亮平安灯]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_151.png"},{"id":"001120","text":"[舞狮]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_120.png"},{"id":"001149","text":"[奥特曼]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_149.png"},{"id":"001061","text":"[药丸]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_61.png"},{"id":"001063","text":"[鸡蛋]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_63.png"},{"id":"001155","text":"[干杯]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_155.png"},{"id":"001180","text":"[炸鸡腿]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_180.png"},{"id":"001152","text":"[肥皂]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_152.png"},{"id":"001171","text":"[威武]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_171.png"},{"id":"001157","text":"[给你小心心]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_157.png"},{"id":"001178","text":"[音乐]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_178.png"},{"id":"001082","text":"[火车]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_82.png"},{"id":"001083","text":"[飞机]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_83.png"},{"id":"001158","text":"[话筒]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_158.png"},{"id":"001182","text":"[钟]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_182.png"},{"id":"001181","text":"[照相机]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_181.png"},{"id":"001161","text":"[绿丝带]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_161.png"},{"id":"001172","text":"[微风]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_172.png"},{"id":"001169","text":"[太阳]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_169.png"},{"id":"001126","text":"[月亮]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_126.png"},{"id":"001153","text":"[浮云]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_153.png"},{"id":"001177","text":"[下雨]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_177.png"},{"id":"001164","text":"[沙尘暴]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_164.png"},{"id":"001179","text":"[赞啊]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_179.png"},{"id":"001247","text":"[雪花]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_247.png"},{"id":"001252","text":"[云红包]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_252.png"},{"id":"001255","text":"[云喝酒]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_255.png"},{"id":"001103","text":"[气球]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_103.png"},{"id":"001268","text":"[星星]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_268.png"},{"id":"001269","text":"[半星]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_269.png"},{"id":"001267","text":"[牛啤]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_267.png"},{"id":"001276","text":"[滑雪]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_276.png"},{"id":"001078","text":"[鞭炮]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_78.png"},{"id":"001090","text":"[足球]","icon":"https://b.bdstatic.com/miniapp/assets/docs/swan-interaction/emoji/face_90.png"}]}]}')})),t("6",(function(t,e){var i=function(t,e){var i=t.scrollTop;!function n(){var s=e-i;i+=s/5,Math.abs(s)<1?t.scrollTo(0,e):(t.scrollTo(0,i),setTimeout(n,30))}()},n=function(t){for(var e=0,i=t,n=!0;n&&i;)i.offsetTop?(e=+i.offsetTop,n=!1):i=i.parentElement;return{nodeParent:i,offsetTop:e}};e.exports={getScrollTop:function(){var t=0;return document.documentElement&&(t=document.documentElement.scrollTop),0-t>0?0:t},getWindowHeight:function(){var t=0;return document.documentElement&&(t=document.documentElement.clientHeight),t},getScrollHeight:function(){var t=0;return document.documentElement&&(t=document.documentElement.scrollHeight),0-t>0?0:t},scrollToSelector:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var s=n(t.el),o=s.nodeParent,a=s.offsetTop;e?swan.pageScrollTo({scrollTop:a,duration:200}):i(o,0)}catch(t){}},findParentNode:n,scrollSmoothTo:i}})),t("7",(function(t,e){e.exports='\n    <div class="comment-list-wrap {{commentPaddingClass}}"\n        style="{{(needPaddingBottom && paddingBottom) ? \'padding-bottom:\' + paddingBottom  : \'\'}}"\n    >\n        <div class="{{isFolded ？\'comment-list-not-scroll\' : \'comment-list\'}}"\n            s-if="commentCount > 0">\n            <div s-for="item, index in commentList"\n                class="comment-list-item"\n                on-click="clickListItem({item, index})">\n                \x3c!-- 列表项左侧，只包含头像 --\x3e\n                <div class="left">\n                    <img src="{{item.avatar}}"\n                        class="comment-list-item-avatar"\n                        on-click="stop:navToPersonalHome(item.personalpage_schema)">\n                </div>\n\n                \x3c!-- 列表项右侧 --\x3e\n                <div class="right">\n                    <div class="line-one">\n                        \x3c!-- 昵称 --\x3e\n                        <span on-click="stop:navToPersonalHome(item.personalpage_schema)"\n                            class="comment-list-item-uname">{{item.uname}}</span>\n\n                        \x3c!-- 功能区 --\x3e\n                        <span class="comment-list-item-aside">\n                            \x3c!-- 点赞 --\x3e\n                            <span class="comment-list-item-like">\n                                <like mode=\'mixture\'\n                                    like-param="{{{spid: item.reply_id}}}"\n                                    is-liked="{{replyLikeStatus(item.is_uped)}}"\n                                    like-num="{{item.like_count}}"\n                                    like-type="{{1}}"\n                                ></like>\n                            </span>\n                            <div class="comment-list-item-more"\n                                s-if="needMoreBtn"\n                                data-index="{{index}}"\n                                on-click="stop:showMoreOperation"></div>\n                            <div s-if="needMoreBtn && isShowMoreOperation(index)"\n                                class="comment-list-item-more-box \n                                {{showMoreOptionsUp ? \'comment-list-item-more-box-up\' : \'\'}}" >\n                                <div class="comment-list-item-more-toast\n                                    {{showMoreOptionsUp ? \'comment-list-item-more-toast-up\' : \'\'}}">\n                                </div> \n                                <div class="comment-list-item-more-options\n                                        {{showMoreOptionsUp ? \'comment-list-item-more-options-up\' : \'\'}}">\n                                    <div s-if="item.is_author" on-click="stop:delComment({item, index})">\n                                        删除\n                                    </div>\n                                    <div s-else on-click="stop:tipOff({item, index})">举报</div>\n                                    <div class="comment-list-item-more-breakline"></div>\n                                    <div on-click="stop:copy(item.content)">复制</div>\n                                </div>\n                            </div>\n                        </span>\n                    </div>\n\n                    <div class="comment-list-item-second-line">\n                        \x3c!-- 评论时间 --\x3e\n                        <span class="comment-list-item-createtime">{{item.create_time | transformTime}}</span>\n                        <span class="comment-list-item-area" s-if="item.area">{{item.area}}</span>\n                    </div>\n\n                    \x3c!-- 评论内容 --\x3e\n                    <div class="comment-list-item-content {{contentFold ? \'comment-list-item-content-fold\' : \'\'}}"\n                        style="position:relative"\n                    >\n                        <div class="comment-list-item-content-detail-reply-box" s-if="hasDetailReplyToReply(item)">\n                            \x3c!-- 详情页有父级评论 --\x3e\n                            <span class="comment-list-reply-wrap">\n                                <span class="comment-list-item-content-reply-uname"\n                                on-click=\n                                "stop:navToPersonalHome(item.reply_to_single_comment.user.personalpage_schema)">\n                                    @{{item.reply_to_single_comment.user.uname}}:\n                                </span>\n                                <block s-for="textItem in changeEmoji(item.reply_to_single_comment.content)">\n                                    <span class="comment-list-item-reply-item-text"\n                                        s-if="textItem.type === \'text\'">{{textItem.value}}</span>\n                                    <img class="comment-list-item-reply-item-emoji"\n                                        s-if="textItem.type === \'img\'" src="{{textItem.value}}" alt={{textItem.tag}} />\n                                </block>\n                                <span s-if="item.reply_to_single_comment.image_list\n                                    && item.reply_to_single_comment.image_list.large"\n                                    class="comment-list-item-reply-item-image"\n                                    on-click="stop:previewImage(item.reply_to_single_comment.image_list)"\n                                    >查看图片</span>\n                            </span>   \n                        </div>\n                        <span class="text-selectable comment-list-content-wrap">\n                            <block s-for="textItem in changeEmoji(item.content)">\n                                <span class="comment-list-item-content-text"\n                                    s-if="textItem.type === \'text\'">{{textItem.value}}</span>\n                                <img class="comment-list-item-content-emoji"\n                                    s-if="textItem.type === \'img\'" src="{{textItem.value}}" alt={{textItem.tag}} />\n                            </block>\n                        </span>\n                        <input s-if="isInDetailPage && isShowCommentInWeb" class="list-hidden-input" />\n                    </div>\n\n                    \x3c!-- 内容里包含图片 --\x3e\n                    <div s-if="item.image_list"\n                        class="comment-list-item-content-img"\n                        on-click="stop:previewImage(item.image_list)">\n                        <div\n                            style="background-image: url({{contentUrl(item.image_list)}})"\n                            class="comment-list-item-content-img-thumb"\n                        ></div>\n                    </div>\n\n                    <div class="comment-list-item-content-bottom"\n                        s-if="allowDelete && item.is_author" on-click="stop:delComment({item, index})">\n                        \x3c!-- 删除按钮 --\x3e\n                        <span class="comment-list-item-del-icon"></span>\n                        <span class="comment-list-item-del-btn">删除</span>\n                    </div>\n                    <div class="comment-list-item-content-bottom" s-elif="!isShowCommentInWeb"\n                        on-click="stop:publishComment({type: \'reply\', item, index})">\n                        <span class="comment-list-item-reply-icon"></span>\n                        <span class="comment-list-item-reply-btn">\n                            回复\n                        </span>\n                    </div>\n                    <div s-else class="comment-list-item-content-bottom"\n                        on-click="stop:openToolbarEditor($event, {item, index, type: \'reply\'})">\n                        <span class="comment-list-item-reply-icon"></span>\n                        <span class="comment-list-item-reply-btn">\n                            回复\n                        </span>\n                        <input class="reply-hidden-input"\n                            disabled="disabledInput"\n                        />\n                    </div>\n\n                    \x3c!-- 二级回复 --\x3e\n                    <div class="comment-list-item-reply"\n                        s-if="hasReplyToInfo(item)">\n                        <div s-for="reply in sliceReplyList(item)" class="comment-list-item-reply-item">\n                            <span class="comment-list-item-reply-item-uname comment-list-item-reply-item-text"\n                                on-click="stop:navToPersonalHome(reply.personalpage_schema)">\n                                {{reply.uname}}\n                            </span>\n                            <span class="comment-list-item-reply-item-text" s-if="reply.reply_to_uname">回复</span>\n                            <span s-if="reply.reply_to_uname"\n                                class="comment-list-item-reply-item-uname comment-list-item-reply-item-text"\n                                on-click="stop:navToPersonalHome(reply.reply_to_personalpage_schema)">\n                                {{reply.reply_to_uname}}\n                            </span>\n                            <span class="comment-list-item-reply-item-text">：</span>\n                            <span class="comment-list-reply-wrap">\n                                <block s-for="textItem in changeEmoji(reply.content)">\n                                    <span class="comment-list-item-reply-item-text"\n                                        s-if="textItem.type === \'text\'">{{textItem.value}}</span>\n                                    <img class="comment-list-item-reply-item-emoji"\n                                        s-if="textItem.type === \'img\'" src="{{textItem.value}}" alt={{textItem.tag}}/>\n                                </block>\n                            </span>\n                            <span s-if="reply.image_list && reply.image_list.large"\n                                class="comment-list-item-reply-item-image"\n                                on-click="stop:previewImage(reply.image_list)"\n                                >查看图片</span>\n                        </div>\n\n                        \x3c!-- 超出 2 条回复显示更多按钮 --\x3e\n                        <div s-if="hasMoreReply(item)" class="comment-list-item-reply-count">\n                            查看{{item.reply_count}}条回复<span class="icon-arrow-right"></span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            \x3c!-- 折叠列表的底部，可放置需要的模块 --\x3e\n            <div s-if="isFolded" class="comment-list-margin-top">\n                <slot name="view-more"></slot>\n            </div>\n            \x3c!-- 普通列表的加载更多 --\x3e\n            <div s-else\n                class="comment-list-bottom\n                {{needSecureBottom ? \'comment-list-bottom-secure\' : \'\'}}\n                {{loadStatus === \'MORE\' || loadStatus === \'FAIL\' ? \'comment-list-bottom-active\' : \'\'}}"\n                on-click="loadMore">\n                <span class="simple-spinner" s-if="loadStatus === \'LOAD\'"></span>\n                <span>{{bottomText}}</span>\n            </div>\n        </div>\n\n        \x3c!-- 评论空态 --\x3e\n        <div s-if="isEmpty && commentCount === 0"\n            class="{{isFolded ? \'\' : \'comment-list-empty-wrapper\'}}">\n            \x3c!-- 折叠列表的评论空态 --\x3e\n            <div s-if="isFolded">\n                <div class="comment-list-empty-folded">\n                    <span class="comment-list-empty-folded-text">还没有人评论，快来抢沙发~</span>\n                    <span s-if="!isShowCommentInWeb" \n                        class="comment-list-empty-folded-reply-btn" \n                        on-click="publishComment">\n                        立即评论\n                    </span>\n                    <block s-else on-click="stop:openToolbarEditor($event, {type: \'add\'})">\n                        <span class="comment-list-empty-folded-reply-btn">立即评论</span>\n                        <input class="empty-hidden-input" disabled="disabledInput"/>\n                    </block>\n                </div>\n            </div>\n\n            \x3c!-- 普通列表的评论空态 --\x3e\n            <div s-else class="comment-list-empty">\n                <img class="comment-list-empty-icon" src="{{emptyImg}}"/>\n                <div class="comment-list-empty-text">还没有人评论，快来抢沙发~</div>\n                <div s-if="!isShowCommentInWeb" \n                    class="comment-list-empty-reply-btn" \n                    on-click="publishComment">\n                    立即评论\n                </div>\n                <block s-else on-click="stop:openToolbarEditor($event, {type: \'add\'})">\n                    <div class="comment-list-empty-reply-btn">立即评论                     \n                    </div>\n                    <input class="empty-hidden-input" disabled="disabledInput"/>\n                </block>\n            </div>\n        </div>\n    </div>\n'})),t("8",(function(t,e){var i,n=t(3),s=t(9),o=(i=t(10))&&i.__esModule?i:{default:i},a=["已点赞","已取消"];e.exports={template:'\n        <swan-like\n            class="like {{isLiked ? \'has-like\' : \'none-like\'}}\n                {{isAnimate ? \'animate\' : \'\'}}"\n            on-click="stop:onTap"\n        >\n            <div s-if="{{mode === \'icon\'}}" class="icon-wrap">\n                <div s-if="needIconShow" class="icon-like icon-type-like \n                {{animationType === 1 ? \'icon-like-anim\' : \'\'}}"></div>\n                <div s-if="{{likeCount && likeCount > 0}}" class="tip">\n                    {{likeCount}}\n                </div>\n                <div s-if="{{animationType === 2}}" class="icon-animate"></div>\n            </div>\n            <div s-if="{{mode === \'mixture\'}}" class="mixture-btn">\n                <div class="text {{likeNum > 0 ? \'red\': \'\'}}">{{likeNum <= 0 ? likeText : likeNum}}</div>\n                <div s-if="needIconShow" class="icon-like {{animationType === 1 ? \'icon-like-anim\' : \'\'}}"></div>\n                <div s-else class="icon-hold"></div>\n                <div s-if="{{animationType === 2}}" class="icon-animate"></div>\n            </div>\n        </swan-like>\n    ',initData:function(){return{mode:"icon",iconType:"hand",style:"none",likeText:"抢首赞",likeNum:0,likeCount:0,isLiked:!1,likeType:0,likeParam:{openid:"",snid:"",spid:"",title:"",path:"",swanid:""},animationType:2,isShowToast:!1,isAnimate:!1,needIconShow:!0}},attached:function(){var t=this;this.swanid=this.data.get("likeParam").swanid,this.swanid||(0,n.getEnvAsync)("swanId").then((function(e){t.swanid=e}))},tapActionHandler:function(t){var e=this,i=this.data.get("isLiked");t.postLikeRequest(t),i?this.data.set("isAnimate",!1):(this.data.set("isAnimate",!0),this.data.set("needIconShow",!1),setTimeout((function(){e.data.set("isAnimate",!1)}),920),setTimeout((function(){e.data.set("needIconShow",!0)}),460))},onTap:(0,o.default)((function(){this.tapActionHandler(this)}),1200),postLikeRequest:function(t){var e=t.composeLikeRequestData(),i=e.commentApi,n=e.data;(0,s.normalRequest)({commentApi:i,data:n}).then((function(e){t.likeSuccess()})).catch((function(e){t.likeFail(e)}))},composeLikeRequestData:function(){var t=this.data.get("likeParam");t||(t=(0,n.getCommentParam)(),this.data.set("likeParam",t));var e=t,i=e.openid,s=e.snid,o=e.title,a=e.path,c=e.spid,m=e.srid,d=this.data.get(),r=d.likeType,p=d.isLiked;return{commentApi:1==+r?"likeComment":"likeUgc",data:{swanid:this.swanid,type:!p,openid:i,snid:s,title:o,path:a,spid:c||m}}},likeSuccess:function(){var t=this.data.get(),e=t.isShowToast,i=t.isLiked,n=t.likeParam,s=+this.data.get("likeNum");s=i?s-1:s+1;var o=+this.data.get("likeCount");o=i?o-1:o+1,this.data.set("isLiked",!i),this.data.set("likeNum",s),this.data.set("likeCount",o),e&&swan.showToast({icon:"none",title:i?a[1]:a[0]});var c={isLiked:!i,spid:n.spid,likeNum:s};this.fire("success",c),this.dispatch("like-status-change",c)},likeFail:function(t){this.fire("fail",t)}}})),t("9",(function(t,e){var i,n=(i=t(10))&&i.__esModule?i:{default:i},s=t(3),o=t(4),a={0:"4",1:"1",2:"6",3:"3",4:"9"},c=["反动违法","色情低俗","谩骂攻击","营销广告","其他"],m=function(t){var e=t.commentApi,i=t.method,n=void 0===i?"POST":i,a=t.data;return(0,s.getAppInfo)().then((function(t){var e=(0,s.getEnv)("systemInfo"),i=e.host,n=e.model,o=e.platform,a=e.screenWidth,c=e.screenHeight,m=e.system,d=e.version,r=e.pixelRatio,p=(0,s.getEnv)("appKey");return"?ua="+ +a*+r+"_"+ +c*+r+"_"+("ios"===o?"iphone":"android")+"_"+d+"_0&ut="+("ios"===o?n.replace(/<[^>]*>/g,"")+"_"+m.replace("iOS ",""):n+"_"+m.replace("Android ","")+"_0_")+"&osbranch="+("android"===o?"a0":"i0")+"&host_name="+i+"&app_key="+p+"&platform="+o+"&scene="+t.scene})).then((function(t){var i=o.commentApiMap[e],c=(0,s.getCommentParam)();if(Object.assign(a,c),i)return(0,s.getEnvAsync)("swanId").then((function(e){return a.swanid=e,function(t){var e=t.url,i=t.method,n=void 0===i?"POST":i,s=t.data,o=t.query;return new Promise((function(t,i){swan.request({url:e+o,method:n,data:s,dataType:"json",header:{"content-type":"application/json"},success:function(e){if(200==+e.statusCode&&0==+e.data.errno)return t(e.data.data);i(e.data)},fail:function(t){i(t)}})}))}({url:i,method:n,data:a,query:t})})).catch((function(t){return Promise.reject(t||"requestCommentServer getSwanId")}))}))};e.exports={normalRequest:m,commentRequest:(0,n.default)(m),tipOff:(0,n.default)((function(t){return new Promise((function(e,i){swan.showActionSheet({itemList:c,itemColor:"#333",success:function(n){var s=a[n.tapIndex];s&&(m({commentApi:"commentReport",data:{srid:t,reason:s}}).then(e).catch(i),swan.showToast({title:"感谢你的举报",icon:"none"}))}})}))}))}})),t("10",(function(t,e){e.exports=function(t,e){var i=null,n=e||300;return function(){var e=this;if(!i){for(var s=arguments.length,o=Array(s),a=0;a<s;a++)o[a]=arguments[a];var c=t.apply(e,o);return i=setTimeout((function(){i=null}),n),c}}}})),t("11",(function(t,e){var i,n=t(3),s=(i=t(8))&&i.__esModule?i:{default:i},o=void 0,a=void 0,c=void 0,m=void 0,d=void 0,r=void 0;function p(t,e){var i=t.data.get("moduleList");return i&&i.length&&i.indexOf(e)>-1}e.exports={components:{like:s.default},template:'\n    <swan-toolbar class="outer-wrap">\n        <div class="mode-comment {{isIphoneX ? \'secure-bottom\': \'\'}}">\n            <div s-if="!isShowCommentInWeb"\n                class="comment-input"\n                on-click="openEditor"\n            >\n                <div  class="placeholder-text">{{placeholder}}</div>\n            </div>\n            <div s-else\n                class="comment-input"\n                style="height:{{commentHeight}}px"\n                on-click="openWebEditor({type: \'add\', from: \'inner\'}, $event)">\n                <textarea s-ref="inputElement"\n                    style="height:{{inputHeight}}px"\n                    class="editor" \n                    rows="3"\n                    clos="20"\n                    minlength="{{replyConfig.minContentLength}}" \n                    maxlength="{{replyConfig.maxContentLength}}"\n                    value="{= content =}"\n                    disabled="{{disabledInput}}"\n                    placeholder="{{placeholder}}"\n                    on-input="inputInWebEditor"\n                    >\n                </textarea>\n                <img s-if="tempFile"\n                    class="image-in-editor"\n                    src="{{tempFile}}"/>\n                <img s-if="tempFile"\n                    class="image-delete-icon"\n                    src="https://b.bdstatic.com/miniapp/assets/swan_interaction/close-icon-1.png"\n                    on-click="deleteImage"\n                    />\n            </div>\n            <button s-if="isShowReplyEditor"\n                class="send-btn-class" \n                style="{{sendBtnStyle}}"\n                disabled="{{!isReadyToComment}}"\n                on-click="reply">\n                {{replyConfig.sendText}}\n            </button>\n            <div s-if="showComment" class="item comment" on-click="clickCommentIcon">\n                <div class="comment-msg">\n                    <div class="icon-msg"></div>\n                    <div s-if="commentConfig.count" class="tip">\n                        {{commentConfig.count}}\n                    </div>\n                </div>\n            </div>\n            <div s-if="showLike" class="like item">\n                <like\n                    class="smt-like"\n                    is-liked="{{likeConfig.isLiked}}"\n                    like-type="{{likeConfig.likeType}}"\n                    animation-type="{{2}}"\n                    like-param="{{likeConfig.likeParam}}"\n                    like-count="{{likeConfig.likeCount}}"\n                >\n                </like>\n            </div>\n            <div s-if="showFavor" class="item favor {{isFavorAnimating ? \'animate\': \'\'}}" on-click="favorHandler">\n                <div class="icon-favor {{favorConfig.chosen? \'chosen\':\'\'}}"></div>\n            </div>\n            <div s-if="showShare" class="item share" on-click="share">\n                <div class="icon-share"></div>\n            </div>\n        </div>\n        <div s-if="{{isShowReplyEditor && isShowImageComment}}"\n            class="comment-type {{isIphoneX ? \'secure-bottom\': \'\'}}">\n            <img class="image-icon"\n                src="https://b.bdstatic.com/miniapp/assets/swan_interaction/chooseImage.png"\n                on-click="chooseImage"/>\n        </div>\n        \x3c!-- ios 16 下，兼容聚焦后发生的不可预期的 webview 上抬行为，使「输入框」始终在可视区域底部展示，为了优化「输入框」的上移/下移体验，添加该节点，作为背景板 --\x3e\n        <div s-ref="back" class="fill-bottom"></div>\n    </swan-toolbar>\n    ',initData:function(){return{placeholder:"回复评论",shareConfig:{title:"分享",url:""},moduleList:["comment","like","favor","share"],commentConfig:{commentTop:0,count:0},likeConfig:{isLiked:!1,likeCount:0,likeParam:{spid:""}},favorConfig:{chosen:!1,pageInfo:{}},readyToShowBar:!0,isIphoneX:(0,n.isIphoneX)(),isClickByLogin:!1,editorClass:"ediotr",verifyAppid:"",isShowReplyEditor:!1,isShowCommentInWeb:!1,isShowImageComment:!((0,n.isQuark)()&&(0,n.isIOS)()),replyConfig:{minContentLength:1,maxContentLength:500,sendBackgroundColor:"#fff",sendTextColor:"#4e6ef2",sendText:"发送"},content:"",lastContent:"",isReadyToComment:!1,disabledInput:!(0,n.getEnv)("isLogin"),inputHeight:14,commentHeight:30,toolbarBottom:0,tempFile:"",currentFile:""}},messages:{"like-status-change":function(t){this.needSendLoginLog("like"),this.fire("likeChange",t.value)}},computed:{showComment:function(){return p(this,"comment")&&!this.data.get("isShowReplyEditor")},showShare:function(){return p(this,"share")&&!this.data.get("isShowReplyEditor")},showLike:function(){return p(this,"like")&&!this.data.get("isShowReplyEditor")},showFavor:function(){return(0,n.isBaiduApp)()&&swan.checkPageFavor&&!this.data.get("isShowReplyEditor")&&p(this,"favor")},sendBtnStyle:function(){var t=this.data.get("replyConfig");return"color:"+t.sendTextColor+";background-color:"+t.sendBackgroundColor}},created:function(){var t=this;this.data.get("isShowCommentInWeb")?this.compatKeyboard():this.watch("isShowCommentInWeb",(function(e){e&&t.compatKeyboard()}))},attached:function(){var t=this,e=this.data.get("likeConfig.likeParam");e&&0!==Object.keys(e).length||this.data.set("likeConfig.likeParam",(0,n.getCommentParam)()),(0,n.isBaiduApp)()&&this.renderFavorBtn(),(0,n.isWebInBrowser)()||swan.onPageFavorChange&&swan.onPageFavorChange((function(e){t.data.set("favorConfig.chosen",!!+e.isPageFavor)})),this.data.set("readyToShowBar",!0),this.data.get("isShowReplyEditor")&&this.openWebEditor({type:"add",isShowReplyEditor:!0,placeholder:"",item:"",index:""})},detached:function(){this.data.get("isShowCommentInWeb")&&this.removeCompatKeyboardListener()},renderFavorBtn:function(){var t=this;swan.checkPageFavor&&(0,n.getEnv)("isLogin")&&swan.checkPageFavor({success:function(e){t.data.set("favorConfig.chosen",!!+e.isPageFavor)}})},clickCommentIcon:function(){this.data.get("commentConfig.count")?this.scrollToTop():this.openEditor()},scrollToTop:function(){this.dispatch("scroll-to-comment-list-top")},share:function(){var t=this,e=this.data.get("shareConfig");if(e.title){var i=e.title,n=e.content,s=e.imageUrl,o=e.path;swan.openShare({title:i,content:n,imageUrl:s,path:o,success:function(e){return t.dispatch("aftershare",{status:"success",data:e})},fail:function(e){return t.dispatch("aftershare",{status:"fail",data:e})}})}},openEditor:function(){this.needSendLoginLog("comment"),this.dispatch("reply",{type:"add"})},addFavor:function(){var t=this,e=(0,n.getCommentParam)(),i=e.title,s=e.images;this.data.get("favorConfig.chosen")||(this.data.set("isFavorAnimating",!0),setTimeout((function(){t.data.set("isFavorAnimating",!1)}),500)),swan.addPageFavor({title:i,img:Array.isArray(s)&&s.length?s[0]:"",success:function(){t.data.set("favorConfig.chosen",!0)}})},deleteFavor:function(){var t=this;swan.deletePageFavor({success:function(){t.data.set("favorConfig.chosen",!1)}})},favorHandler:function(){var t=this,e=this.data.get("favorConfig.chosen"),i=(0,n.getEnv)("isLogin");swan.checkPageFavor&&(i||(0,n.isWebInBrowser)()?e?this.deleteFavor():this.addFavor():((0,n.loginStatusUbcReporter)("favor","notLogin"),(0,n.loginByAPI)(this.owner).then((function(i){e?t.deleteFavor():t.addFavor(),(0,n.loginStatusUbcReporter)("favor","loginSuccess"),"useSwanLogin"===i&&t.dispatch("bindunlogin",{stage:"favor",detail:{chosen:!e}})})).catch((function(t){(0,n.loginStatusUbcReporter)("favor","loginFail")}))))},needSendLoginLog:function(t){var e=(0,n.getEnv)("isLogin"),i=this.data.get("isClickByLogin");e||i||(this.data.set("isClickByLogin",!0),(0,n.loginStatusUbcReporter)(t,"notLogin")),e&&i&&(this.data.set("isClickByLogin",!1),(0,n.loginStatusUbcReporter)(t,"loginSuccess"))},openWebEditor:function(t){var e=this,i=t.type,s=void 0===i?"reply":i,o=t.isShowReplyEditor,a=void 0===o||o,c=t.placeholder,m=t.item,d=t.index,r=t.from,p=void 0===r?"parent":r;if(!(0,n.getEnv)("isLogin"))return this.data.set("isShowReplyEditor",!1),this.data.set("disabledInput",!0),void(0,n.loginByAPI)(this.owner).then((function(){e.data.set("isShowReplyEditor",!0)})).catch((function(t){(0,n.loginStatusUbcReporter)("openEditor","loginFail")})).finally((function(){e.data.set("disabledInput",!1)}));if(this.data.set("disabledInput",!1),this.ref("inputElement")&&this.ref("inputElement").focus(),!this.data.get("isShowReplyEditor")||"inner"!==p){this.data.set("isShowReplyEditor",!0),c?this.data.set("placeholder","回复"+c):this.data.set("placeholder","回复评论"),this.data.set("isShowReplyEditor",a);var l=this.data.get("content"),h=this.data.get("lastContent");!l&&this.data.set("content",h);var u=l.length||h.length,f=this.data.get("replyConfig"),g=this.data.get("tempFile"),b=this.data.get("currentFile");!g&&this.data.set("tempFile",b),u<=f.maxContentLength&&u>=f.minContentLength?this.data.set("isReadyToComment",!0):this.data.set("isReadyToComment",!1),(g||b)&&(this.data.set("isReadyToComment",!0),this.data.set("commentHeight",80),this.data.set("inputHeight",64)),this.data.set("replyItem",m),this.data.set("replyIndex",d),this.data.set("replyType",s)}},inputInWebEditor:function(t){var e=this.ref("inputElement"),i=this.data.get("lastContent"),n=this.data.get("replyConfig"),s=t.target,o=s.value,a=s.scrollHeight,c=s.clientHeight;(o.length>n.maxContentLength||o.length<n.minContentLength)&&!this.data.get("tempFile")?this.data.set("isReadyToComment",!1):this.data.set("isReadyToComment",!0),"deleteContentBackward"===t.inputType&&"\n"===i[i.length-1]&&(e.style.height=c-20>14?c-20+"px":"14px"),a<=80&&!this.data.get("tempFile")&&(this.data.set("commentHeight",a+16),this.data.set("inputHeight",a)),this.data.set("lastContent",o)},blur:function(){this.data.set("commentHeight",30),this.data.set("inputHeight",14),this.data.set("isShowReplyEditor",!1),this.data.set("placeholder","回复评论"),this.data.set("currentFile",this.data.get("tempFile")),this.dispatch("inputBlur",{content:this.data.get("content"),tempFile:this.data.get("tempFile")}),this.data.set("content",""),this.data.set("tempFile","")},reply:function(){var t=this.data.get("content"),e=this.data.get("tempFile"),i=this.data.get("replyType"),n=this.data.get("replyItem"),s=this.data.get("replyIndex");this.needSendLoginLog("comment"),this.dispatch("replyInWeb",{res:{content:t,tempFile:e},type:i,item:n,index:s}),this.data.set("isReadyToComment",!1)},replyComplete:function(){this.data.set("commentHeight",30),this.data.set("inputHeight",14),this.data.set("placeholder","回复评论"),this.data.set("isShowReplyEditor",!1),this.data.set("lastContent",""),this.data.set("content",""),this.data.set("replyItem",""),this.data.set("tempFile",""),this.data.set("currentFile","")},chooseImage:function(){var t=this;swan.chooseImage({count:1,sizeType:["original"],success:function(e){t.ref("inputElement")&&t.ref("inputElement").focus(),t.data.set("commentHeight",80),t.data.set("inputHeight",64),t.data.set("tempFile",e.tempFilePaths[0]),t.data.set("isReadyToComment",!0)}})},deleteImage:function(){this.data.set("tempFile",""),this.data.set("currentFile",""),this.data.set("commentHeight",30),this.data.set("inputHeight",14),!this.data.get("content")&&this.data.set("isReadyToComment",!1)},moveInputToBottomAfterResize:function(t){var e=t.target.height;if(e>=a){var i=this.data.get("toolbarBottom");return this.data.set("toolbarBottom",0),void(0,n.animate)({draw:this.draw.bind(this),timing:this.timing,params:{currentBottom:i,bottom:0},duration:10})}o=a-e;var s=t.target.offsetTop,c=o-s,m=this.data.get("toolbarBottom");m!==c&&(this.data.set("toolbarBottom",c),(0,n.animate)({draw:this.draw.bind(this),timing:this.timing,params:{currentBottom:m,bottom:c},duration:10}))},moveInputToBottomAfterScroll:function(t){if(t.target.height<a){var e=t.target.offsetTop,i=o-e,s=this.data.get("toolbarBottom");s!==i&&(this.data.set("toolbarBottom",i),(0,n.animate)({draw:this.draw.bind(this),timing:this.timing,params:{currentBottom:s,bottom:i},duration:10}))}},compatKeyboard:function(){(0,n.needCompatForiOS)()&&(a=(0,n.getIndexWindow)().innerHeight,c=(0,n.getIndexWindow)().visualViewport,m=this.moveInputToBottomAfterResize.bind(this),d=this.moveInputToBottomAfterScroll.bind(this),c.addEventListener("resize",m),c.addEventListener("scroll",d)),r=this.triggerBlur.bind(this),window.addEventListener("click",r)},triggerBlur:function(t){var e=t.target||t.srcElement,i=this.el;i&&e!==i&&!i.contains(e)&&"swan-web-api-chooseImage"!==e.className&&"INPUT"!==e.tagName&&this.blur()},removeCompatKeyboardListener:function(){(0,n.needCompatForiOS)()&&(c.removeEventListener("resize",m),c.removeEventListener("scroll",d)),window.removeEventListener("click",r)},draw:function(t){var e=t.progress,i=t.currentBottom,n=t.bottom;this.ref("back")&&(this.ref("back").style.height=e*(n-i)+i+"px")},timing:function(t){return t}}})),t("12",(function(t,e){e.exports={LOG_PREFIX:"[Dynamic(swan-interaction)]",API_MAP_NAME:{COMMENT_LIST:"commentList",DETAIL_LIST:"commentDetail",PUBLISH:"comment",DELETE:"commentDelete"},PUBLISH_COMMENT_TYPE:{REPLY:"add",SECONDARY_REPLY:"reply"},EDITOR_DEFAULT_PLACEHOLDER:"回复评论",LOAD_STATUS:{MORE:"MORE",LOAD:"LOAD",OVER:"OVER",FAIL:"FAIL"},TIP_OFF_TYPE:{DETAIL:"detail",REPLY:"reply"},EDITOR_STATUS:{SEND:"reply",DRAFT:"draft"},PUBLISH_FAIL_TEXT:{NORMAL:"发表评论失败",WAIT_TO_AUDIT:"此评论暂无法回复",NOT_SUPPORT:"暂不支持评论",FREQUENT_REQUEST:"手速太快，稍后再试~"},WAIT_TO_AUDIT_ERRNO:"872",FREQUENT_REQUEST_ERRNO:"701",MESSAGE_TYPE:{DEL_COMMENT:"delComment",UPDATE_LIST:"updateList"},LIST_PAGE_MAX_NUM:20}})),t("src/comment-detail/index",(function(t,e){e.exports={isSwanComponent:!0,swanComponentCss:[{path:"components/like/index.css"},{path:"components/list/index.css"},{path:"components/toolbar/index.css"},[1],".page","{font-size: 3.865333333333333vw; display: flex; flex-direction: column; height: 100%; }",[1],".comment-detail-div","{height: 100%; width: 100vw; overflow-y: auto; overflow-x: hidden; }",[1],".main-comment","{display: flex; padding: 5.475066666666667vw 4.1062666666666665vw 5.313999999999999vw; }",[1],".head","{display: flex; }",[1],".author-avatar","{width: 8.454666666666666vw; height: 8.454666666666666vw; border-radius: 50%; }",[1],".detail-right","{display: flex; flex-direction: column; margin-left: 2.8985333333333334vw; flex: 1; }",[1],".uname","{width: 70.45066666666666vw; color: #1f1f1f; font-size: 3.3815999999999997vw; white-space: nowrap; overflow-x: hidden; }",[1],".under-name-line","{display: flex; margin-top: 1.4493333333333331vw; }",[1],".under-name-text","{color: #aaa; font-size: 2.8985333333333334vw; line-height: 1; }",[1],".under-name-area","{margin-left: 2.4154666666666667vw; }",[1],".comment-content","{margin-top: 2.8985333333333334vw; font-size: 3.8648000000000002vw; line-height: 1.47; word-break: break-all; color: #1f1f1f; }",[1],".comment-image","{width: 44.9276vw; height: 44.9276vw; margin-top: 2.496vw; padding-bottom: 0.8vw; }",[1],".thumb","{width: 100%; height: 100%; background-repeat: no-repeat; background-size: cover; background-position: center center; }",[1],".tool","{margin-top: 2.740133333333333vw; display: flex; justify-content: space-between; }",[1],".tool-box","{display: flex; }",[1],".btn-box","{display: flex; font-size: 3.14vw; line-height: 1; align-items: center; justify-content: center; margin-right: 5.0724vw; }",[1],".tool-text","{color: #858585; font-family: PingFangSC-Medium; }",[1],".tool-btn","{width: 3.8648000000000002vw; height: 3.8648000000000002vw; margin-right: 0.9661333333333334vw; }",[1],".icon-reply","{background: url('https://b.bdstatic.com/miniapp/assets/new-reply/reply_new.png') no-repeat; background-size: cover; }",[1],".icon-delete","{background: url('https://b.bdstatic.com/miniapp/assets/new-reply/delete_new.png') no-repeat; background-size: cover; }",[1],".icon-tip-off","{background: url('https://b.bdstatic.com/miniapp/assets/new-reply/jubao.png') no-repeat; background-size: cover; }",[1],".like-btn","{display: flex; align-self: center; }",[1],".divider","{background: #f5f5f5; height: 0.2416vw; width: 100vw; }",[1],".list-area","{display: flex; flex-direction: column; }",[1],".comment-list-box","{padding-top: 4.025333333333333vw; flex: 1; }",[1],".comment-list-title","{font-size: 3.865333333333333vw; margin: 5.313999999999999vw 3.3815999999999997vw 0.40253333333333335vw; color: #1f1f1f; line-height: 1; font-family: PingFangSC-Medium; }",[1],".like","{font-size: 3.381333333333333vw; text-align: center; }",[1],".page .blank-box","{height: auto; top: 50%; transform: translateY(-50%); }"],swanComponentFactory:function(t,e){var i=t(9),n=t(3),s=t(6),o=r(t(8)),a=r(t(2)),c=r(t(11)),m=r(t(14)),d=t(12);function r(t){return t&&t.__esModule?t:{default:t}}var p=void 0;e.exports={components:{like:o.default,list:a.default,toolbar:c.default},template:m.default,initData:function(){return{commentParam:{},srid:"",isPageScroll:!0,backListAfterDelete:!0,needToolbar:!0,__isEmpty:!1,__loadStatus:d.LOAD_STATUS.MORE,__detailItem:{},__toolbarConfig:{placeholder:"回复评论",like:{isLiked:!1,likeType:1,likeParam:{}}},__likeText:"抢首赞",__moduleList:["like"],__commentList:[],__likeParam:{},__ready:!1,__isBaiduAccount:!1,__isShowEditor:!1,__isInDetailPage:!0,content:"",isAllowCommentInWeb:!1,needPaddingBottom:!0,paddingBottom:"45px"}},messages:{loadmore:function(){this.loadMore()},reply:function(t){this.publishComment(t.value)},publishcomment:function(t){var e=this,i=t.value,n=i.type,s=i.item,o=i.index;if(this.data.get("isAllowCommentInWeb"))return this.data.set("__isShowEditor",!0),void this.nextTick((function(){e.ref("toolbar").openWebEditor({type:n,placeholder:s.uname,index:o,item:s,from:"parent"})}));this.publishComment(t.value)},bindclickcomment:function(t){var e=this,i=t.value,n=i.item,s=i.index;if(this.data.get("isAllowCommentInWeb"))return this.data.set("__isShowEditor",!0),void this.nextTick((function(){e.ref("toolbar").openWebEditor({type:d.PUBLISH_COMMENT_TYPE.SECONDARY_REPLY,placeholder:n.uname,index:s,item:n,from:"parent"})}));this.publishComment({type:d.PUBLISH_COMMENT_TYPE.SECONDARY_REPLY,item:n,index:s})},binddelete:function(t){this.confirmDelete(t.value)},tipoff:function(t){this.tipOff({type:d.TIP_OFF_TYPE.REPLY,info:t.value})},replyInWeb:function(t){var e=t.value,i=e.res,n=e.type,s=e.item,o=e.index;this.publishComment({res:i,type:n,item:s,index:o})},openWebEditor:function(t){var e=this,i=t.value,n=i.item,s=i.index,o=i.type,a=this.data.get("needToolbar");this.data.set("__isShowEditor",!0),a?this.ref("toolbar").openWebEditor({type:o,placeholder:n.uname,item:n,index:s,from:"parent"}):this.nextTick((function(){e.ref("toolbar").openWebEditor({type:o,placeholder:n.uname,item:n,index:s,from:"parent"})}))},inputBlur:function(t){var e=t.value,i=e.content,n=e.tempFile;this.data.get("needToolbar")||(this.data.set("content",i),this.data.set("tempFile",n)),this.data.set("__isShowEditor",!1)}},computed:{__isNeedPaddingBottom:function(){return this.data.get("needToolbar")&&this.data.get("needPaddingBottom")}},created:function(){var t=this;this.data.set("__isBaiduAccount",(0,n.isBaiduAccount)()),this.start=0,this.bottomDistance=(0,n.isIphoneX)()?51:30,(0,n.allowCommentInWeb)().then((function(e){t.data.set("isAllowCommentInWeb",e)}));var e=this.data.get("commentParam");this.initRequest(e),this.watch("commentParam",(function(e){return t.initRequest(e)})),this.watch("addComment",(function(e){e&&(t.data.get("isAllowCommentInWeb")?(0,n.isLogin)()?(t.data.set("__isShowEditor",!0),t.nextTick((function(){t.ref("toolbar").openWebEditor({type:"add",from:"parent"})}))):(0,n.loginByAPI)(t).then((function(){t.data.set("__isShowEditor",!0),t.nextTick((function(){t.ref("toolbar").openWebEditor({type:"add",from:"parent"})}))})):t.publishComment({}))}))},attached:function(){this.data.get("isPageScroll")&&(p=this.reachBottom.bind(this),window.addEventListener("scroll",p,{passive:!0}))},detached:function(){this.data.get("isPageScroll")&&window.removeEventListener("scroll",p,{passive:!0})},initRequest:function(t){var e=this;if(t&&t.snid){this.start=0;var s=this.nativeAPI||this.swaninterface.boxjs;(0,n.getOpenId)(s).then((function(e){t.openid=e})).finally((function(){var s=e.data.get("srid");e.data.set("__likeParam.spid",s),e.data.set("__toolbarConfig.like.likeParam.spid",s),(0,n.storeCommentParam)(t);var o=e.composeListRequestData();(0,i.normalRequest)({commentApi:d.API_MAP_NAME.DETAIL_LIST,data:o}).then((function(t){if(0==+t.errno&&t.ret&&e.initDetailSuccess(t.ret),!t.ret.list.length)return Promise.reject();e.data.set("__ready",!0)})).catch((function(){e.data.set("__isEmpty",!0),e.data.set("__commentList",[]),e.data.set("__loadStatus",d.LOAD_STATUS.OVER),e.data.set("__ready",!0);var t=d.LOG_PREFIX+"[Request fail] get comment detail fail with data: "+JSON.stringify(o);(0,n.sendLog)(new Error(t))}))}))}else console.error("初始commentParam为空，请传入参数")},composeListRequestData:function(){var t=this.data.get("srid"),e=(0,n.getCommentParam)().openid;return{use_list:1,num:d.LIST_PAGE_MAX_NUM,start:this.start,srid:t,openid:e}},initDetailSuccess:function(t){t.list&&t.list.length&&this.data.set("__commentList",t.list);var e=t.detail,i=e.image_list;if(i){var s=i.thumb&&i.thumb.url;s&&/\.gif/.test(s)&&(e.image_list.thumb.url=i.large.url)}var o=!!+e.is_uped;this.data.set("__toolbarConfig.like.isLiked",o),e.is_uped=o,e.like_count=+e.like_count||0,e.time=(0,n.passedTimeTransfer)(e.create_time),this.data.merge("__detailItem",e),t.is_over&&this.data.set("__loadStatus",d.LOAD_STATUS.OVER),this.start+=d.LIST_PAGE_MAX_NUM},tipOff:function(t){var e=this,n=t.type,s=void 0===n?d.TIP_OFF_TYPE.DETAIL:n,o=t.info,a=void 0===o?{item:{}}:o,c=this.composeTipOffData({type:s,info:a});(0,i.tipOff)(c).then((function(){return e.tipOffSuccess(s,a)})).catch((function(){return console}))},composeTipOffData:function(t){var e=t.type,i=t.info;return e===d.TIP_OFF_TYPE.DETAIL?this.data.get("__detailItem.reply_id"):i.item.reply_id},tipOffSuccess:function(t,e){var i=e.item,n=e.index;if(t!==d.TIP_OFF_TYPE.DETAIL){this.data.splice("__commentList",[n,1]);var s=+i.reply_count+1;this.changeToolbarMsgCount(0,s)}},navToPersonalHome:function(){var t=this.data.get("__detailItem.personalpage_schema");t&&(0,n.isBaiduApp)()&&(0,n.openUserProfile)(t)},prePublishComment:function(){var t=this;this.data.get("isAllowCommentInWeb")?(this.data.set("__isShowEditor",!0),this.nextTick((function(){t.ref("toolbar").openWebEditor({type:"add",from:"parent"})}))):this.publishComment({})},publishComment:function(t){var e=this,i=t.res,s=t.type,o=void 0===s?d.PUBLISH_COMMENT_TYPE.REPLY:s,a=t.item,c=void 0===a?{}:a,m=t.index,r=void 0===m?0:m;if(this.data.get("__isBaiduAccount"))if((0,n.isLogin)()||(0,n.isWebInBrowser)())this.data.get("isAllowCommentInWeb")?this.sendCommentContent({res:i,type:o,item:c,index:r}):this.openEditor({type:o,item:c,index:r});else if(n.useBoxjsLogin){var p=this.nativeAPI||this.swaninterface.boxjs;(0,n.loginWithBoxjs)(p).then((function(){e.data.get("isAllowCommentInWeb")?e.sendCommentContent({res:i,type:o,item:c,index:r}):e.openEditor({type:o,item:c,index:r})}))}else this.dispatchEvent("bindunlogin",{type:o,item:c,index:r});else swan.showToast({title:d.PUBLISH_FAIL_TEXT.NOT_SUPPORT})},openEditor:function(t){var e=this,i=t.type,s=t.item,o=t.index,a=this.composeEditorPlaceholder({type:i,item:s});(0,n.openEditor)({contentPlaceholder:a}).then((function(t){t.status===d.EDITOR_STATUS.SEND&&e.sendCommentContent({res:t,type:i,item:s,index:o})})).catch((function(t){swan.closeReplyEditor(),(0,n.sendLog)(new Error(d.LOG_PREFIX+"openReplyEditor fail with error: "+JSON.stringify(t)))}))},composeEditorPlaceholder:function(t){var e=t.type,i=t.item;return e===d.PUBLISH_COMMENT_TYPE.SECONDARY_REPLY?"回复"+i.uname:d.EDITOR_DEFAULT_PLACEHOLDER},sendCommentContent:function(t){var e=this,n=t.res,s=t.type,o=t.item;t.index,this.composePublishRequestData({type:s,res:n,item:o}).then((function(t){(0,i.commentRequest)({commentApi:d.API_MAP_NAME.PUBLISH,data:t}).then((function(t){e.publishSuccess(t),swan.closeReplyEditor()})).catch((function(t){return e.publishFail(t)}))})).catch((function(t){e.publishFail(t)})).finally((function(){e.ref("toolbar")&&e.ref("toolbar").replyComplete(),e.data.set("__isShowEditor",!1),e.data.set("content",""),e.data.set("tempFile","")}))},composePublishRequestData:function(t){var e=t.type,i=t.res,s=t.item,o=e===d.PUBLISH_COMMENT_TYPE.SECONDARY_REPLY,a={comment:i.content};return a.spid=o?s.reply_id:this.data.get("srid"),(0,n.processImageParam)(i).then((function(t){return t&&(a.comment_images=t),Promise.resolve(a)})).catch((function(t){return Promise.reject(t)}))},publishSuccess:function(t){var e=this;this.data.unshift("__commentList",t),this.dispatchEvent("bindreply",{status:"success",data:{srid:t.reply_id}}),this.nextTick((function(){e.scrollToCommentListTop()}))},publishFail:function(t){var e=d.PUBLISH_FAIL_TEXT.NORMAL,i=t&&t.sub_msg;i&&~i.indexOf(d.WAIT_TO_AUDIT_ERRNO)&&(e=d.PUBLISH_FAIL_TEXT.WAIT_TO_AUDIT),i&&~i.indexOf(d.FREQUENT_REQUEST_ERRNO)&&(e=d.PUBLISH_FAIL_TEXT.FREQUENT_REQUEST),swan.showToast({title:e,icon:"none"})},scrollToCommentListTop:function(){var t=this.data.get("isPageScroll");t?(0,s.scrollToSelector)(this.ref("comment-detail"),t):(0,s.scrollSmoothTo)(this.ref("comment-detail"),0)},addScrollEvent:function(){if(!this.data.get("isPageScroll")){var t=this.ref("comment-detail");t.scrollTop+t.offsetHeight+this.bottomDistance>=t.scrollHeight&&this.loadMore()}},reachBottom:function(){(0,s.getScrollTop)()+(0,s.getWindowHeight)()+this.bottomDistance>=(0,s.getScrollHeight)()&&this.loadMore()},confirmDelete:function(t){var e=this,i=t.item,n=t.index;swan.showModal({content:"确认删除此条评论",success:function(t){t.confirm&&e.delComment({item:i,index:n})}})},delComment:function(t){var e=this,n=t.item,s=t.index,o=n.reply_id;(0,i.commentRequest)({commentApi:d.API_MAP_NAME.DELETE,data:{srid:o}}).then((function(t){if(void 0!==s)e.data.splice("__commentList",[s,1]);else if(e.data.get("backListAfterDelete")){var i=e.data.get("__commentList");e.navigateBackList({srid:o,count:++i.length})}e.dispatchEvent("binddelete",{status:"success",data:{srid:o}})})).catch((function(){return console}))},deleteAll:function(){this.confirmDelete({item:{reply_id:this.data.get("srid")}})},canLoadMore:function(){var t=this.data.get("__loadStatus");return"LOAD"!==t&&"OVER"!==t},loadMore:function(){var t=this;if(this.canLoadMore()){var e=this.data.get("__loadStatus");this.data.set("__loadStatus",d.LOAD_STATUS.LOAD);var n=this.composeListRequestData(),s=(0,i.commentRequest)({commentApi:d.API_MAP_NAME.DETAIL_LIST,data:n});s?s.then((function(e){e.ret&&e.ret.list?t.loadMoreSuccess(e.ret):t.loadMoreFail()})).catch((function(){return t.loadMoreFail()})):this.data.set("__loadStatus",e)}},loadMoreSuccess:function(t){var e=this.data.get("__commentList");e=e.concat(t.list),this.data.set("__commentList",e),this.data.set("__loadStatus",t.is_over?d.LOAD_STATUS.OVER:d.LOAD_STATUS.MORE),this.start+=d.LIST_PAGE_MAX_NUM},loadMoreFail:function(){this.data.set("__loadStatus",d.LOAD_STATUS.FAIL)},likeStatusChange:function(t){this.data.set("__toolbarConfig.like.isLiked",t.isLiked);var e=+this.data.get("__detailItem.like_count")+(t.isLiked?1:-1);this.data.set("__detailItem.like_count",e)},openImage:function(){var t=this.data.get("item.image_list.large.url");t&&swan.previewImage({current:t,urls:[t]})},navigateBackList:function(t){var e=t.delta,i=void 0===e?1:e,s=t.srid,o=t.count;(0,n.sendMessageToMaster)({context:this,eventType:"navigate",eventValue:{type:"navigateBack",params:{delta:i,srid:s,count:o}}})},changeEmoji:function(t){return(0,n.changeEmoji)(t)}}}}})),t("14",(function(t,e){e.exports='\n    <swan-comment-detail class="page">\n        <div\n            class="comment-detail-div"\n            s-ref="comment-detail"\n            on-mousewheel="addScrollEvent"\n            on-touchmove="addScrollEvent"\n        >\n            <div class="main-comment" s-if="__ready">\n                <div class="head relative">\n                    <img class="author-avatar"\n                        src="{{__detailItem.avatar}}"\n                        on-click="stop:navToPersonalHome"\n                        />\n                    \n                </div>\n                \x3c!-- 右侧区域 --\x3e\n                <div class="detail-right">\n                    <span class="uname"\n                    on-click="stop:navToPersonalHome">{{__detailItem.uname}}</span>\n                    \x3c!-- 时间与地点 --\x3e\n                    <div class="under-name-line">\n                        <span class="under-name-text">{{__detailItem.time}}</span>\n                        <span class="under-name-text under-name-area" s-if="__detailItem.area">\n                            {{__detailItem.area}}\n                        </span>\n                    </div>\n                    \x3c!-- 主内容 --\x3e\n                    <span s-if="__detailItem.content"\n                        class="comment-content" selectable>\n                        <block s-for="textItem in changeEmoji(__detailItem.content)">\n                            <span s-if="textItem.type === \'text\'">{{textItem.value}}</span>\n                            <img class="comment-list-item-content-emoji" s-if="textItem.type === \'img\'"\n                                src="{{textItem.value}}"/>\n                        </block>\n                    </span>\n                    <div class="comment-image"\n                        s-if="__detailItem.image_list"\n                        on-click="stop:openImage">\n                        <div style="background-image: url({{__detailItem.image_list.thumb.url}})"\n                            class="thumb"></div>\n                    </div>\n                    \x3c!-- 功能区 --\x3e\n                    <div class="tool">\n                        \x3c!-- 左侧按钮 --\x3e\n                        <div class="tool-box">\n                            <div class="btn-box" on-click="prePublishComment">\n                                <div class="tool-btn icon-reply"/>\n                                <span class="tool-text">回复</span>\n                            </div>\n                            <div class="btn-box" s-if="__detailItem.is_author" on-click="stop:deleteAll">\n                                <span class="tool-btn icon-delete"></span>\n                                <span class="tool-text">删除</span>\n                            </div>\n                            <div s-else class="btn-box" on-click="stop:tipOff">\n                                <span class="tool-btn icon-tip-off"></span>\n                                <span class="tool-text">举报</span>\n                            </div>\n                        </div>\n                        \x3c!-- 右侧点赞按钮 --\x3e\n                        <div class="like-btn">\n                            <like class="like"\n                                like-num="{{__detailItem.like_count}}"\n                                mode="mixture"\n                                like-type="{{1}}"\n                                is-liked="{{__toolbarConfig.like.isLiked}}"\n                                like-text="{{__likeText}}"\n                                like-param="{{__likeParam}}"\n                                on-success="likeStatusChange">\n                            </like>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="divider"></div>\n            <div class="list-area" s-if="__ready">\n                <div class="comment-list-title">全部回复</div>\n                <list\n                    s-ref="commentDetailList"\n                    class="comment-start {{needToolbar ? \'comment-list-wrapper\' : \'\'}}"\n                    comment-list="{{__commentList}}"\n                    is-empty="{{__isEmpty}}"\n                    is-in-detail-page="{{__isInDetailPage}}"\n                    need-more-btn="{{true}}"\n                    allow-delete="{{true}}"\n                    has-parent-reply="{{true}}"\n                    is-page-scroll="{{isPageScroll}}"\n                    load-status="{{__loadStatus}}"\n                    need-padding-bottom="{{__isNeedPaddingBottom}}"\n                ></list>\n            </div>\n        </div>\n\n        <toolbar s-ref="toolbar" s-if="{{__isBaiduAccount && (needToolbar || __isShowEditor)}}"\n            is-show-reply-editor="{{__isShowEditor}}"\n            is-show-comment-in-web="{{isAllowCommentInWeb}}"\n            class="comment-list-toolbar"\n            content="{{content}}"\n            tempFile="{{tempFile}}"\n            placeholder="{{__toolbarConfig.placeholder}}"\n            like-config="{{__toolbarConfig.like}}"\n            module-list="{{__moduleList}}"\n            on-addcomment="detailpublishComment"\n            on-likeChange="likeStatusChange"\n        ></toolbar>\n    </swan-comment-detail>\n'}))}),{"dynamicLib://swan-interaction/comment-list":"src/comment-list/index","dynamicLib://swan-interaction/comment-detail":"src/comment-detail/index"});