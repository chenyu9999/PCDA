$gwx_XC_69=function(_,_v,_n,_p,_s,_wp,_wl,$gwn,$gwl,$gwh,wh,$gstack,$gwrt,gra,grb,TestTest,wfor,_ca,_da,_r,_rz,_o,_oz,_1,_1z,_2,_2z,_m,_mz,nv_getDate,nv_getRegExp,nv_console,nv_parseInt,nv_parseFloat,nv_isNaN,nv_isFinite,nv_decodeURI,nv_decodeURIComponent,nv_encodeURI,nv_encodeURIComponent,$gdc,nv_JSON,_af,_gv,_ai,_grp,_gd,_gapi,$ixc,_ic,_w,_ev,_tsd){return function(path,global){
if(typeof global==='undefined'){if (typeof __GWX_GLOBAL__==='undefined')global={};else global=__GWX_GLOBAL__;}if(typeof __WXML_GLOBAL__ === 'undefined') {__WXML_GLOBAL__={};
}__WXML_GLOBAL__.modules = __WXML_GLOBAL__.modules || {};
var e_={}
if(typeof(global.entrys)==='undefined')global.entrys={};e_=global.entrys;
var d_={}
if(typeof(global.defines)==='undefined')global.defines={};d_=global.defines;
var f_={}
if(typeof(global.modules)==='undefined')global.modules={};f_=global.modules || {};
var p_={}
__WXML_GLOBAL__.ops_cached = __WXML_GLOBAL__.ops_cached || {}
__WXML_GLOBAL__.ops_set = __WXML_GLOBAL__.ops_set || {};
__WXML_GLOBAL__.ops_init = __WXML_GLOBAL__.ops_init || {};
var z=__WXML_GLOBAL__.ops_set.$gwx_XC_69 || [];
function gz$gwx_XC_69_1(){
if( __WXML_GLOBAL__.ops_cached.$gwx_XC_69_1)return __WXML_GLOBAL__.ops_cached.$gwx_XC_69_1
__WXML_GLOBAL__.ops_cached.$gwx_XC_69_1=[];
(function(z){var a=11;function Z(ops){z.push(ops)}
Z([3,'video-box'])
Z([[2,'&&'],[[7],[3,'videoPlayed']],[[7],[3,'liveFlow']]])
Z([1,true])
Z([3,'liveError'])
Z([3,'liveStateChange'])
Z([3,'video-player live-player'])
Z([3,'livePlayer'])
Z([3,'5'])
Z([3,'3'])
Z([[7],[3,'liveFlow']])
Z([3,'player-action'])
Z([[7],[3,'loading']])
Z([[2,'!'],[[7],[3,'isFs']]])
Z([[7],[3,'isFs']])
Z([3,'video-cover'])
Z(z[9])
})(__WXML_GLOBAL__.ops_cached.$gwx_XC_69_1);return __WXML_GLOBAL__.ops_cached.$gwx_XC_69_1
}
__WXML_GLOBAL__.ops_set.$gwx_XC_69=z;
__WXML_GLOBAL__.ops_init.$gwx_XC_69=true;
var x=['./components/video-player-live/index.wxml'];d_[x[0]]={}
var m0=function(e,s,r,gg){
var z=gz$gwx_XC_69_1()
var xWW=_n('view')
_rz(z,xWW,'class',0,e,s,gg)
var oXW=_v()
_(xWW,oXW)
if(_oz(z,1,e,s,gg)){oXW.wxVkey=1
var fYW=_mz(z,'live-player',['autoplay',2,'binderror',1,'bindstatechange',2,'class',3,'id',4,'maxCache',5,'minCache',6,'src',7],[],e,s,gg)
var cZW=_n('cover-view')
_rz(z,cZW,'class',10,e,s,gg)
var h1W=_v()
_(cZW,h1W)
if(_oz(z,11,e,s,gg)){h1W.wxVkey=1
}
var o2W=_v()
_(cZW,o2W)
if(_oz(z,12,e,s,gg)){o2W.wxVkey=1
}
var c3W=_v()
_(cZW,c3W)
if(_oz(z,13,e,s,gg)){c3W.wxVkey=1
}
h1W.wxXCkey=1
o2W.wxXCkey=1
c3W.wxXCkey=1
_(fYW,cZW)
_(oXW,fYW)
}
else{oXW.wxVkey=2
var o4W=_n('view')
_rz(z,o4W,'class',14,e,s,gg)
var a6W=_n('slot')
_(o4W,a6W)
var l5W=_v()
_(o4W,l5W)
if(_oz(z,15,e,s,gg)){l5W.wxVkey=1
}
l5W.wxXCkey=1
_(oXW,o4W)
}
oXW.wxXCkey=1
_(r,xWW)
return r
}
e_[x[0]]={f:m0,j:[],i:[],ti:[],ic:[]}
if(path&&e_[path]){
return function(env,dd,global){$gwxc=0;var root={"tag":"wx-page"};root.children=[]
;g="$gwx_XC_69";var main=e_[path].f
if (typeof global==="undefined")global={};global.f=$gdc(f_[path],"",1);
try{
main(env,{},root,global);
_tsd(root)
}catch(err){
console.log(err)
}
;g="";
return root;
}
}
}
}(__g.a,__g.b,__g.c,__g.d,__g.e,__g.f,__g.g,__g.h,__g.i,__g.j,__g.k,__g.l,__g.m,__g.n,__g.o,__g.p,__g.q,__g.r,__g.s,__g.t,__g.u,__g.v,__g.w,__g.x,__g.y,__g.z,__g.A,__g.B,__g.C,__g.D,__g.E,__g.F,__g.G,__g.H,__g.I,__g.J,__g.K,__g.L,__g.M,__g.N,__g.O,__g.P,__g.Q,__g.R,__g.S,__g.T,__g.U,__g.V,__g.W,__g.X,__g.Y,__g.Z,__g.aa);if(__vd_version_info__.delayedGwx||false)$gwx_XC_69();	if (__vd_version_info__.delayedGwx) __wxAppCode__['components/video-player-live/index.wxml'] = [$gwx_XC_69, './components/video-player-live/index.wxml'];else __wxAppCode__['components/video-player-live/index.wxml'] = $gwx_XC_69( './components/video-player-live/index.wxml' );
	;__wxRoute = "components/video-player-live/index";__wxRouteBegin = true;__wxAppCurrentFile__="components/video-player-live/index.js";define("components/video-player-live/index.js",function(require,module,exports,window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){
"use strict";var t=getApp();Component({properties:{liveFlow:{type:String},poster:{type:String},lock:{type:Boolean,value:!1},startTimes:{type:Number,default:0,optionalTypes:[String]},showProgress:{type:Boolean,value:!0}},data:{timerInfo:{currentTime:0,duration:0,isPlay:!1,loading:!0}},lifetimes:{created:function(){this.vStatus={player:!1},this.vTimerInfo={currentTime:0},this.pointIndex=0,this.watchData=[],this.submittingData=[],this.currentPoiInfo={},this.vDataTimer=null,this.startSeek=0},attached:function(){this.data.liveFlow&&(this.vStatus={player:!1},this.vTimerInfo={currentTime:this.getStartTime()},this.pointIndex=0,this.watchData=[],this.submittingData=[],this.currentPoiInfo={},this.vDataTimer=null,this.startSeek=0,this.debug("initTimerInfo",this.vTimerInfo),this.setData({videoUrl:this.data.liveFlow}))},detached:function(){this.stopWatchDataEvent(),this.debug("warn","视频组件卸载",this.data.live_url)}},pageLifetimes:{hide:function(){this.debug("warn","页面隐藏事件"),this.triggerStop()},show:function(){this.data.loading||this.vStatus.played||this.triggerPlay()}},methods:{getStartTime:function(){var t=Date.now(),e=Math.floor(t/1e3-this.data.startTimes);return this.debug("warn","直播开始时间(s)",e),Math.max(e,0)},liveStateChange:function(e){var i,a=e.detail.code;switch(a){case 2001:i="已经连接服务器";break;case 2002:i="已经连接服务器, 开始拉流";break;case 2003:i="网络接收到首个视频数据包(IDR)";break;case 2004:i="视频播放开始",this.setData({loading:!1}),this.triggerPlay();break;case 2005:i="视频播放进度";break;case 2006:i="视频播放结束";break;case 2007:i="视频播放Loading",this.setData({loading:!0});break;case 2008:i="解码器启动";break;case 2009:i="视频分辨率改变";break;case-2301:i="网络断连，且经多次重连抢救无效，更多重试请自行重启播放",t.toast("网络断连，请稍后重试"),this.setData({videoPlayed:!1,lock:!1}),this.triggerStop();break;case-2302:i="获取加速拉流地址失败";break;case 2101:i="当前视频帧解码失败";break;case 2102:i="当前音频帧解码失败";break;case 2103:i="网络断连, 已启动自动重连",this.setData({loading:!0});break;case 2104:i="网络来包不稳：可能是下行带宽不足，或由于主播端出流不均匀";break;case 2105:i="当前视频播放出现卡顿",this.setData({loading:!1});break;case 2106:i="硬解启动失败，采用软解";break;case 2107:i="当前视频帧不连续，可能丢帧";break;case 2108:i="当前流硬解第一个I帧失败，SDK自动切软解";break;case 3001:i="RTMP - DNS解析失败";break;case 3002:i="RTMP服务器连接失败";break;case 3003:i="RTMP服务器握手失败";break;case 3005:i="RTMP 读 / 写失败",this.setData({loading:!0});break;default:i=a}this.debug("info","直播状态变化",i),this.setData({code:a,statusText:i})},liveError:function(t){this.debug("error",t),this.setData({videoPlayed:!1,lock:!1}),this.triggerStop()},enterFullScreen:function(){var t=this;this.videoPlayer.requestFullScreen({direction:90,success:function(){t.setData({isFs:!0})}})},exitFullScreen:function(){var t=this;this.videoPlayer.exitFullScreen({success:function(){t.setData({isFs:!1})}})},tapVideo:function(){var t=this;this.triggerEvent("clickplay",(function(e){e?t.data.lock||(t.debug("允许播放视频"),t.setData({videoPlayed:!0,lock:!0}),t.videoPlayer=wx.createLivePlayerContext("livePlayer",t),t.debug("获取videoContext",t.videoPlayer)):t.debug("不允许播放视频")}))},triggerPlay:function(){this.debug("直播开始",this.vTimerInfo.currentTime),!this.vDataTimer&&this.startWatchDataEvent(),this.vStatus.played&&this.addPointEnd(this.vTimerInfo.currentTime),this.vStatus.paused=!1,this.vStatus.played=!0,this.addPointStart(this.vTimerInfo.currentTime||0),this.liveTimeClock()},triggerStop:function(){this.debug("直播中止",this.vTimerInfo.currentTime),this.vStatus.played=!1,this.vStatus.paused=!0,this.liveTimer&&clearInterval(this.liveTimer),this.addPointEnd(this.vTimerInfo.currentTime),this.triggerEvent("liveStop")},liveTimeClock:function(){var t=this;this.liveTimer&&clearInterval(this.liveTimer),this.liveTimer=setInterval((function(){t.vTimerInfo.currentTime+=1}),1e3)},stopWatchDataEvent:function(){this.debug("warn","关闭数据上报定时器"),clearInterval(this.vDataTimer),this.vStatus.played&&(this.addPointEnd(this.vTimerInfo.currentTime),this.addPointStart(this.vTimerInfo.currentTime)),this.uploadWatchData()},startWatchDataEvent:function(){var t=this;this.debug("warn","启动数据上报定时器"),clearInterval(this.vDataTimer),this.vDataTimer=setInterval((function(){t.vStatus.played&&(t.addPointEnd(t.vTimerInfo.currentTime),t.addPointStart(t.vTimerInfo.currentTime)),t.uploadWatchData()}),6e4)},uploadWatchData:function(){var t=this;this.submittingData=this.submittingData.concat(this.watchData),this.watchData=[],this.pointIndex=0,this.submittingData.length?(this.submittingData.forEach((function(t){t.veTime=Math.ceil(t.veTime),t.vsTime=Math.ceil(t.vsTime)})),this.debug("提交打点数据","进行中",JSON.stringify(this.submittingData)),this.triggerEvent("uploadData",{data:this.submittingData,callback:function(e,i){e?(t.debug("提交打点数据","成功"),t.submittingData=[]):t.debug("error","提交打点数据失败",i)}})):this.debug("无打点数据需要提交")},addPointStart:function(t){this.debug("打点 -- 开始点 -- ".concat(this.pointIndex+1),t),this.currentPoiInfo={vsTime:t,veTime:""}},addPointEnd:function(t){this.debug("打点 -- 结束点 -- ".concat(this.pointIndex+1),t),0!=t?t-this.currentPoiInfo.vsTime<=1?this.debug("warn","打点间隔太短，不记录点位"):(this.currentPoiInfo.veTime=t,this.watchData.push(this.currentPoiInfo),this.pointIndex++,this.debug("warn","当前打点列表",this.watchData)):this.debug("warn","打点结束时帧数为0，不记录点位")},debug:function(){var t,e,i,a;switch(arguments[0]){case"warn":(t=console).warn.apply(t,["VIDEO TEST"].concat(Array.prototype.slice.call(arguments)));break;case"info":(e=console).info.apply(e,["VIDEO TEST"].concat(Array.prototype.slice.call(arguments)));break;case"error":(i=console).error.apply(i,["VIDEO TEST"].concat(Array.prototype.slice.call(arguments)));break;default:(a=console).log.apply(a,["VIDEO TEST"].concat(Array.prototype.slice.call(arguments)))}}}});
},{isPage:false,isComponent:true,currentFile:'components/video-player-live/index.js'});require("components/video-player-live/index.js");