$gwx_XC_192=function(_,_v,_n,_p,_s,_wp,_wl,$gwn,$gwl,$gwh,wh,$gstack,$gwrt,gra,grb,TestTest,wfor,_ca,_da,_r,_rz,_o,_oz,_1,_1z,_2,_2z,_m,_mz,nv_getDate,nv_getRegExp,nv_console,nv_parseInt,nv_parseFloat,nv_isNaN,nv_isFinite,nv_decodeURI,nv_decodeURIComponent,nv_encodeURI,nv_encodeURIComponent,$gdc,nv_JSON,_af,_gv,_ai,_grp,_gd,_gapi,$ixc,_ic,_w,_ev,_tsd){return function(path,global){
if(typeof global==='undefined'){if (typeof __GWX_GLOBAL__==='undefined')global={};else global=__GWX_GLOBAL__;}if(typeof __WXML_GLOBAL__ === 'undefined') {__WXML_GLOBAL__={};
}__WXML_GLOBAL__.modules = __WXML_GLOBAL__.modules || {};
var e_={}
if(typeof(global.entrys)==='undefined')global.entrys={};e_=global.entrys;
var d_={}
if(typeof(global.defines)==='undefined')global.defines={};d_=global.defines;
var f_={}
if(typeof(global.modules)==='undefined')global.modules={};f_=global.modules || {};
var p_={}
__WXML_GLOBAL__.ops_cached = __WXML_GLOBAL__.ops_cached || {}
__WXML_GLOBAL__.ops_set = __WXML_GLOBAL__.ops_set || {};
__WXML_GLOBAL__.ops_init = __WXML_GLOBAL__.ops_init || {};
var z=__WXML_GLOBAL__.ops_set.$gwx_XC_192 || [];
function gz$gwx_XC_192_1(){
if( __WXML_GLOBAL__.ops_cached.$gwx_XC_192_1)return __WXML_GLOBAL__.ops_cached.$gwx_XC_192_1
__WXML_GLOBAL__.ops_cached.$gwx_XC_192_1=[];
(function(z){var a=11;function Z(ops){z.push(ops)}
Z([3,'generalEventBubbleCatcher'])
Z([3,'container'])
Z([3,'dis-flex'])
Z([[2,'||'],[[2,'>'],[[6],[[7],[3,'reselectClinicInfo']],[3,'change_clinic_seconds']],[1,0]],[[6],[[6],[[7],[3,'reselectClinicInfo']],[3,'expand_clinic_list']],[3,'length']]])
Z([3,'clinic-selector-container'])
Z([[2,'||'],[[2,'>'],[[6],[[7],[3,'reselectClinicInfo']],[3,'change_clinic_seconds']],[1,0]],[[6],[[7],[3,'reselectClinicInfo']],[3,'shouldClinicSelectorShow']]])
Z([[2,'&&'],[[2,'&&'],[[2,'<='],[[6],[[7],[3,'reselectClinicInfo']],[3,'change_clinic_seconds']],[1,0]],[[6],[[6],[[7],[3,'reselectClinicInfo']],[3,'expand_clinic_list']],[3,'length']]],[[2,'!'],[[6],[[7],[3,'reselectClinicInfo']],[3,'shouldClinicSelectorShow']]]])
Z([[6],[[6],[[7],[3,'problem_detail']],[3,'hint_info']],[3,'text']])
Z([[2,'||'],[[2,'||'],[[2,'==='],[[6],[[7],[3,'currentEntranceType']],[3,'value']],[[6],[[6],[[7],[3,'entranceTypes']],[3,'seo']],[3,'value']]],[[2,'==='],[[6],[[7],[3,'currentEntranceType']],[3,'value']],[[6],[[6],[[7],[3,'entranceTypes']],[3,'seo_similar_problem']],[3,'value']]]],[[2,'==='],[[7],[3,'pageType']],[1,'native_search']]])
Z([3,'top-height seo'])
Z([3,'width: 100%;'])
Z([[2,'&&'],[[6],[[7],[3,'summary_info']],[3,'title']],[[2,'!'],[[7],[3,'shouldHideProDetail']]]])
Z([[2,'&&'],[[7],[3,'doctor_info']],[[6],[[7],[3,'doctor_info']],[3,'id']]])
Z([3,'onSeoTitleExpand'])
Z([[7],[3,'doctor_info']])
Z([[7],[3,'has_followed']])
Z([[7],[3,'isSeoTitleDoctorMiniCard']])
Z([[7],[3,'problem_id']])
Z([[7],[3,'visitPageName']])
Z([[2,'&&'],[[7],[3,'summary_info']],[[2,'!'],[[7],[3,'shouldHideProDetail']]]])
Z([a,[3,'pro-detail '],[[2,'?:'],[[7],[3,'shouldProDetailHide']],[1,''],[1,'extra-padding']],[3,' '],[[2,'?:'],[[7],[3,'isCurrentProDetailHide']],[1,''],[1,'expand']]])
Z([a,[3,'desc '],z[20][4]])
Z([[6],[[7],[3,'summary_info']],[3,'desc']])
Z([3,'onMpHtmlLinkTap'])
Z([3,'suggestHtmlLoaded'])
Z([3,'suggest-content-main'])
Z([3,'display: inline'])
Z(z[22])
Z([1,false])
Z(z[25])
Z([[2,'!'],[[6],[[7],[3,'summary_info']],[3,'desc']]])
Z([a,[3,'suggest-content '],z[20][4],z[20][3],[[2,'?:'],[[7],[3,'isCurrentProDetailHide']],[1,'hide'],[1,'']]])
Z([[6],[[7],[3,'summary_info']],[3,'summary']])
Z(z[23])
Z(z[25])
Z(z[26])
Z(z[32])
Z(z[28])
Z([[2,'!'],[[6],[[7],[3,'summary_info']],[3,'summary']]])
Z([[7],[3,'shouldProDetailHide']])
Z(z[16])
Z([3,'top-height'])
Z(z[10])
Z(z[12])
Z([3,'onOriginalTitleDoctorShowLess'])
Z([3,'onOriginalTitleDoctorShowMore'])
Z(z[14])
Z([[7],[3,'currentEntranceType']])
Z(z[15])
Z([[7],[3,'isMiniCardOriginalTitleDoctor']])
Z([[7],[3,'self']])
Z(z[17])
Z(z[18])
Z([[7],[3,'shouldMultipleAskIndicatorShow']])
Z(z[49])
Z([[2,'&&'],[[6],[[7],[3,'topNewMessageInfo']],[3,'shouldShow']],[[7],[3,'self']]])
Z([3,'onScroll'])
Z([3,'handleScrollToLower'])
Z([3,'im-content'])
Z([1,true])
Z([3,'scroll-view'])
Z([3,'#fff'])
Z([3,'white'])
Z([[7],[3,'targetScrollAnchor']])
Z([[2,'&&'],[[6],[[7],[3,'problem_detail']],[3,'is_advanced_graph']],[[2,'!'],[[6],[[7],[3,'doctor_info']],[3,'id']]]])
Z([[2,'!'],[[7],[3,'isPrivacyQa']]])
Z([[7],[3,'isPrivacyQa']])
Z([3,'i'])
Z([[7],[3,'disclaimerList']])
Z([3,'text'])
Z(z[23])
Z([[6],[[7],[3,'item']],[3,'text']])
Z(z[28])
Z(z[65])
Z([a,[3,'message-main-container '],[[2,'?:'],[[2,'&&'],[[7],[3,'shouldLimitQaContentHeight']],[[7],[3,'hasRecommendSection']]],[1,'limit-height'],[1,'']]])
Z(z[67])
Z([3,'content'])
Z([[7],[3,'contents']])
Z([3,'uniqueId'])
Z([a,[3,'single-message-main-holder '],[[2,'?:'],[[2,'==='],[[2,'+'],[[2,'+'],[[2,'+'],[1,'single'],[[6],[[7],[3,'content']],[3,'id']]],[1,'-']],[[6],[[7],[3,'content']],[3,'sub_content_idx']]],[[7],[3,'currentFlickerMessageId']]],[1,'flickering'],[1,'']]])
Z([[2,'+'],[[2,'+'],[[2,'+'],[1,'single'],[[6],[[7],[3,'content']],[3,'id']]],[1,'-']],[[6],[[7],[3,'content']],[3,'time']]])
Z([[2,'&&'],[[2,'=='],[[6],[[7],[3,'content']],[3,'type']],[1,'d']],[[2,'!='],[[6],[[6],[[6],[[7],[3,'content']],[3,'content']],[1,0]],[3,'type']],[1,'reward_tip']]])
Z([[6],[[7],[3,'content']],[3,'content']])
Z(z[78])
Z([3,'qa-list qa-list__doctor'])
Z([a,[3,'qaid'],[[2,'+'],[[7],[3,'i']],[1,1]]])
Z([3,'qa-list__left'])
Z(z[64])
Z([3,'onClickDoctorAvatar'])
Z([a,[3,'../doc_mainpage/index?doc_id\x3d'],[[6],[[7],[3,'doctor_info']],[3,'id']]])
Z([[6],[[7],[3,'problem_detail']],[3,'is_advanced_graph']])
Z([3,'qa-list__right'])
Z([a,[3,'qa-list__content '],[[2,'?:'],[[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'video']],[1,'video-no-background'],[1,'']],z[20][3],[[2,'?:'],[[2,'==='],[[6],[[7],[3,'item']],[3,'type']],[1,'card']],[1,'prescription-card'],[1,'']],[3,' doctor-content']])
Z([[2,'&&'],[[7],[3,'isShowMsgOperationDialog']],[[2,'==='],[[7],[3,'longPressedMessageId']],[[6],[[7],[3,'item']],[3,'random_id']]]])
Z([3,'copy'])
Z([3,'replyMessage'])
Z([3,'savePhoto'])
Z([3,'translate'])
Z(z[59])
Z([[6],[[7],[3,'bottom_info_list']],[3,'edit']])
Z([[7],[3,'content']])
Z([3,'left'])
Z([[6],[[7],[3,'messageOperationMap']],[[6],[[7],[3,'item']],[3,'type']]])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'text']])
Z([[6],[[7],[3,'item']],[3,'jump_url']])
Z([3,'openMsgOperationDialog'])
Z([3,'jumpH5'])
Z(z[100])
Z([[7],[3,'item']])
Z(z[104])
Z([[7],[3,'isActivityPartner']])
Z(z[71])
Z(z[28])
Z(z[23])
Z(z[71])
Z(z[28])
Z(z[105])
Z(z[100])
Z(z[108])
Z(z[110])
Z(z[71])
Z(z[28])
Z(z[23])
Z(z[71])
Z(z[28])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'audio']])
Z(z[105])
Z([3,'tapOnAudioContainer'])
Z([3,'qa-list__audio'])
Z([a,[3,'audioid'],[[7],[3,'i']]])
Z(z[129][2])
Z(z[100])
Z(z[108])
Z([[6],[[7],[3,'item']],[3,'file']])
Z(z[108])
Z([[6],[[7],[3,'content']],[3,'id']])
Z([3,'playAudioInOrder'])
Z([3,'setMessageRead'])
Z([3,'handleAudioStart'])
Z([[2,'+'],[1,'audio'],[[6],[[7],[3,'content']],[3,'id']]])
Z([[6],[[6],[[7],[3,'audioInfoMap']],[[6],[[7],[3,'content']],[3,'id']]],[3,'isUnread']])
Z(z[17])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'image']])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'survey_table']])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'video']])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'topic']])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'card']])
Z(z[106])
Z([3,'qa-list-wrap survey-card'])
Z([[6],[[7],[3,'item']],[3,'service_url']])
Z([[2,'!=='],[[6],[[7],[3,'item']],[3,'service_state_icon']],[1,'']])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'add_profile_card']])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'doctor_summary']])
Z([3,'jumpSummary'])
Z([3,'summary-link'])
Z([[6],[[6],[[7],[3,'item']],[3,'card_info']],[3,'url']])
Z([[6],[[6],[[7],[3,'item']],[3,'card_info']],[3,'extra_text']])
Z([[2,'==='],[[6],[[7],[3,'item']],[3,'type']],[1,'audio']])
Z([3,'extra-content'])
Z([[2,'&&'],[[2,'&&'],[[6],[[6],[[7],[3,'audioInfoMap']],[[6],[[7],[3,'content']],[3,'id']]],[3,'isUnread']],[[7],[3,'self']]],[[7],[3,'isNewVersionAudio']]])
Z(z[140])
Z([3,'scrollToReply'])
Z([3,'doctor'])
Z(z[108])
Z([[7],[3,'userIdInfo']])
Z([[6],[[6],[[7],[3,'audioInfoMap']],[[6],[[7],[3,'content']],[3,'id']]],[3,'shouldTranslateShow']])
Z([3,'showTranslateMenu'])
Z([3,'audio-translate-container'])
Z(z[135])
Z([[2,'==='],[[7],[3,'currentShowingTranslateMenuId']],[[6],[[7],[3,'content']],[3,'id']]])
Z(z[82])
Z([3,'index'])
Z([[2,'=='],[[6],[[7],[3,'content']],[3,'type']],[1,'p']])
Z([[2,'&&'],[[2,'=='],[[7],[3,'i']],[1,0]],[[7],[3,'first_enter_page']]])
Z([3,'qa-list-user'])
Z([a,z[85][1],z[85][2]])
Z(z[93])
Z(z[94])
Z([3,'downloadFile'])
Z(z[95])
Z(z[96])
Z(z[97])
Z([3,'draw'])
Z(z[99])
Z(z[100])
Z([3,'right'])
Z(z[102])
Z([a,[3,'qa-list-inner-section ovflow-visi '],[[2,'?:'],[[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'video']],[1,'video-no-background'],[1,'']],z[20][3],[[2,'&&'],[[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'add_profile_card']],[1,'white-background']],z[20][3],[[2,'?:'],[[2,'==='],[[6],[[7],[3,'item']],[3,'type']],[1,'file']],[1,'pdf'],[1,'']]])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'text']])
Z(z[104])
Z(z[105])
Z(z[106])
Z(z[100])
Z(z[108])
Z(z[110])
Z(z[71])
Z(z[28])
Z(z[23])
Z(z[71])
Z(z[28])
Z(z[105])
Z(z[100])
Z(z[108])
Z(z[110])
Z(z[71])
Z(z[28])
Z(z[23])
Z(z[71])
Z(z[28])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'image']])
Z(z[125])
Z(z[105])
Z(z[127])
Z(z[128])
Z([a,z[129][1],z[129][2]])
Z(z[129][2])
Z(z[100])
Z(z[108])
Z(z[133])
Z(z[108])
Z(z[135])
Z(z[138])
Z(z[139])
Z(z[17])
Z(z[144])
Z(z[105])
Z([3,'p-video-c ovflow-visi'])
Z(z[100])
Z(z[108])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'status']],[1,'fail']])
Z(z[151])
Z([[2,'&&'],[[2,'==='],[[6],[[7],[3,'item']],[3,'type']],[1,'file']],[[2,'==='],[[6],[[7],[3,'item']],[3,'file_type']],[1,'pdf']]])
Z([[2,'==='],[[6],[[7],[3,'item']],[3,'type']],[1,'dicom']])
Z(z[161])
Z([3,'patient'])
Z(z[108])
Z(z[164])
Z(z[165])
Z(z[166])
Z([3,'audio-translate-container patient'])
Z(z[135])
Z(z[169])
Z(z[82])
Z(z[171])
Z([[2,'=='],[[6],[[7],[3,'content']],[3,'type']],[1,'s']])
Z([[2,'==='],[[6],[[7],[3,'item']],[3,'type']],[1,'feedback']])
Z([3,'handleClickFeedback'])
Z(z[89][2])
Z(z[108])
Z(z[17])
Z([[2,'==='],[[6],[[7],[3,'item']],[3,'type']],[1,'process_notice_user']])
Z([3,'onMpHtmActionTap'])
Z(z[71])
Z(z[28])
Z(z[129][2])
Z([[6],[[6],[[7],[3,'item']],[3,'request_info']],[3,'click_info']])
Z([[6],[[6],[[7],[3,'item']],[3,'request_info']],[3,'dialog']])
Z([[7],[3,'mphtmlTagStyle']])
Z([[2,'==='],[[6],[[7],[3,'item']],[3,'type']],[1,'notice']])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'link_notice_user']])
Z(z[89][2])
Z(z[108])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'notice_user']])
Z([3,'notice-user-wrap'])
Z(z[23])
Z([[6],[[7],[3,'noticeUserList']],[[7],[3,'i']]])
Z(z[28])
Z([[6],[[7],[3,'item']],[3,'action_info']])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'reward_tip']])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'text']])
Z([[2,'=='],[[6],[[7],[3,'item']],[3,'type']],[1,'ad']])
Z([3,'ad_Jump'])
Z([3,'ad-warp'])
Z([[6],[[6],[[7],[3,'item']],[3,'data']],[3,'ad_id']])
Z([[6],[[6],[[7],[3,'item']],[3,'data']],[3,'ad_title']])
Z([[6],[[6],[[6],[[6],[[7],[3,'item']],[3,'data']],[3,'redirect']],[3,'param']],[3,'type']])
Z([[6],[[6],[[6],[[7],[3,'item']],[3,'data']],[3,'redirect']],[3,'type']])
Z([[6],[[6],[[6],[[6],[[7],[3,'item']],[3,'data']],[3,'redirect']],[3,'param']],[3,'url']])
Z([[6],[[6],[[6],[[6],[[7],[3,'item']],[3,'data']],[3,'redirect']],[3,'param']],[3,'path']])
Z([[6],[[6],[[7],[3,'item']],[3,'data']],[3,'text']])
Z(z[28])
Z([[2,'==='],[[6],[[7],[3,'item']],[3,'type']],[1,'patient_assess']])
Z([[6],[[7],[3,'item']],[3,'assess_info']])
Z([[7],[3,'footer_ad']])
Z(z[171])
Z([[2,'>'],[[6],[[7],[3,'footer_ad']],[3,'length']],[1,0]])
Z(z[271])
Z([[6],[[7],[3,'item']],[3,'ad_id']])
Z([[6],[[7],[3,'item']],[3,'ad_title']])
Z(z[59])
Z([[6],[[6],[[6],[[7],[3,'item']],[3,'redirect']],[3,'param']],[3,'type']])
Z([[6],[[6],[[7],[3,'item']],[3,'redirect']],[3,'type']])
Z([[6],[[6],[[6],[[7],[3,'item']],[3,'redirect']],[3,'param']],[3,'url']])
Z([[6],[[6],[[6],[[7],[3,'item']],[3,'redirect']],[3,'param']],[3,'path']])
Z([[6],[[7],[3,'item']],[3,'image']])
Z(z[71])
Z(z[71])
Z(z[28])
Z([[2,'&&'],[[2,'&&'],[[2,'&&'],[[2,'&&'],[[7],[3,'footer']],[[6],[[7],[3,'footer']],[3,'length']]],[[7],[3,'is_problem_user']]],[[7],[3,'problem_id']]],[[6],[[7],[3,'contents']],[3,'length']]])
Z(z[65])
Z([[2,'&&'],[[7],[3,'shouldLimitQaContentHeight']],[[7],[3,'hasRecommendSection']]])
Z([[2,'||'],[[2,'||'],[[2,'==='],[[6],[[7],[3,'currentEntranceType']],[3,'value']],[[6],[[6],[[7],[3,'entranceTypes']],[3,'seo']],[3,'value']]],[[2,'==='],[[6],[[7],[3,'currentEntranceType']],[3,'value']],[[6],[[6],[[7],[3,'entranceTypes']],[3,'seo_similar_problem']],[3,'value']]]],[[2,'==='],[[7],[3,'pageType']],[1,'native_search']]])
Z([3,'updateRecommendSectionStatus'])
Z(z[17])
Z(z[18])
Z([[2,'&&'],[[2,'&&'],[[7],[3,'newUserWelfare']],[[6],[[7],[3,'newUserWelfare']],[3,'image']]],[[7],[3,'bottomGroupHeight']]])
Z([3,'bottom-bottom'])
Z(z[10])
Z([[2,'&&'],[[2,'&&'],[[6],[[7],[3,'tapToBottomInfo']],[3,'shouldTapToBottomContainerShow']],[[7],[3,'self']]],[[2,'!'],[[6],[[7],[3,'bottomNewMessageInfo']],[3,'shouldShow']]]])
Z([[2,'&&'],[[2,'&&'],[[6],[[7],[3,'bottomNewMessageInfo']],[3,'shouldShow']],[[7],[3,'self']]],[[2,'!=='],[[6],[[7],[3,'problem_detail']],[3,'status']],[1,'c']]])
Z([[7],[3,'shouldBottomRecommendDoctorShow']])
Z([[2,'&&'],[[7],[3,'guide']],[[6],[[7],[3,'guide']],[3,'length']]])
Z([3,'requestMedicine'])
Z([3,'goAssess'])
Z(z[89][2])
Z([[7],[3,'guide']])
Z(z[99])
Z([[6],[[7],[3,'replyArea']],[3,'shouldShow']])
Z([[6],[[7],[3,'problem_detail']],[3,'id']])
Z([[6],[[7],[3,'problem_detail']],[3,'status']])
Z(z[18])
Z([[2,'&&'],[[2,'&&'],[[7],[3,'is_problem_user']],[[2,'!'],[[7],[3,'isRefundTrans']]]],[[2,'!'],[[7],[3,'isRefund']]]])
Z([3,'footer bottom-height'])
Z([[2,'||'],[[6],[[7],[3,'bottom_info_list']],[3,'assess']],[[6],[[7],[3,'bottom_info_list']],[3,'reward']]])
Z(z[323])
Z([[6],[[7],[3,'bottom_info_list']],[3,'assess']])
Z([3,'tips__btn clearfix'])
Z([[7],[3,'reward']])
Z([[6],[[7],[3,'bottom_info_list']],[3,'reward']])
Z([3,'doPointAssess'])
Z([3,'QaBottom'])
Z([3,'心选服务-关闭后评价'])
Z([3,'navigate'])
Z([a,[3,'../assess_send/index?problem_id\x3d'],z[17],[3,'\x26is_advanced_graph\x3d'],z[90]])
Z(z[325])
Z(z[90])
Z([[2,'||'],[[2,'||'],[[6],[[7],[3,'bottom_info_list']],[3,'phone_closed']],[[6],[[7],[3,'bottom_info_list']],[3,'doctor_info']]],[[6],[[7],[3,'bottom_info_list']],[3,'re_checkup']]])
Z([3,'tips_title clearfix'])
Z([[2,'||'],[[6],[[7],[3,'bottom_info_list']],[3,'phone_closed']],[[6],[[7],[3,'bottom_info_list']],[3,'re_checkup']]])
Z([[6],[[7],[3,'bottom_info_list']],[3,'doctor_info']])
Z([[6],[[7],[3,'bottom_info_list']],[3,'re_checkup']])
Z(z[99])
Z(z[317])
Z([3,'func__top'])
Z([[6],[[7],[3,'problem_detail']],[3,'has_answer']])
Z([[6],[[7],[3,'page_info']],[3,'show_doctor_purchase']])
Z([[2,'&&'],[[2,'&&'],[[2,'&&'],[[2,'>'],[[6],[[7],[3,'problem_detail']],[3,'price']],[1,0]],[[2,'=='],[[6],[[7],[3,'problem_detail']],[3,'pay_status']],[1,'p']]],[[2,'!'],[[6],[[7],[3,'problem_detail']],[3,'has_answer']]]],[[7],[3,'problem_id']]])
Z([[6],[[7],[3,'bottom_info_list']],[3,'refunded']])
Z(z[305])
Z([[7],[3,'newUserWelfare']])
Z([[7],[3,'bottomGroupHeight']])
Z([3,'QA详情页'])
Z([[6],[[7],[3,'bottom_info_list']],[3,'ask_doctor']])
Z([3,'startAiChat'])
Z([3,'showAiDialog'])
Z([3,'new'])
Z(z[17])
Z([[7],[3,'buttonGroupRenderData']])
Z([[7],[3,'show_popup']])
Z([3,'qa-popup-box'])
Z([[2,'==='],[[6],[[6],[[7],[3,'qa_toast']],[3,'redirect']],[3,'type']],[1,'mini_customer_service']])
Z([[2,'!'],[[7],[3,'isLogin']]])
Z([3,'loginActions'])
Z([3,'loginSuccess'])
Z([3,'loginFail'])
Z([[2,'&&'],[[7],[3,'isLogin']],[[7],[3,'user_id']]])
Z([[2,'==='],[[6],[[6],[[7],[3,'qa_toast']],[3,'redirect']],[3,'type']],[1,'url']])
Z([[2,'||'],[[6],[[7],[3,'problem_detail']],[3,'medicine_sale_conversation_id']],[[7],[3,'show_medicine_sale']]])
Z([[2,'&&'],[[6],[[7],[3,'problem_detail']],[3,'is_advanced_graph']],[[6],[[7],[3,'problem_detail']],[3,'show_assess_entrance']]])
Z([[7],[3,'shouldMultipleAskDialogShow']])
Z([3,'handleCloseDialog'])
Z([[7],[3,'multipleAskInfo']])
Z(z[17])
Z([[2,'?:'],[[6],[[7],[3,'problem_detail']],[3,'is_to_doc']],[1,''],[1,'paid_clinic']])
Z([[7],[3,'toClinicServices']])
Z([3,'leaveGeneralPageContainer'])
Z([[7],[3,'shouldGeneralPageContainerShow']])
Z([[6],[[7],[3,'feedbackInfo']],[3,'shouldFeedbackShow']])
Z(z[375])
Z([[6],[[7],[3,'feedbackInfo']],[3,'defaultValue']])
Z(z[89][2])
Z([[6],[[7],[3,'feedbackInfo']],[3,'fromType']])
Z([[6],[[7],[3,'feedbackInfo']],[3,'problemId']])
Z([[6],[[7],[3,'feedbackInfo']],[3,'serviceType']])
Z([[2,'&&'],[[6],[[7],[3,'feedbackInfo']],[3,'shouldFeedbackShow']],[[7],[3,'shouldGeneralPageContainerShow']]])
Z([[6],[[7],[3,'reselectClinicInfo']],[3,'shouldAppendClinicShow']])
Z([3,'cancelAppendClinic'])
Z([3,'confirmAppendClinic'])
Z([[6],[[7],[3,'reselectClinicInfo']],[3,'expand_clinic_list']])
Z([3,'confirmClinic'])
Z([3,'toggleClinicSelector'])
Z([[6],[[7],[3,'reselectClinicInfo']],[3,'shouldClinicSelectorShow']])
Z([[2,'!'],[[7],[3,'shouldTapToTopIndicatorHide']]])
Z([[7],[3,'shouldAiChatShow']])
})(__WXML_GLOBAL__.ops_cached.$gwx_XC_192_1);return __WXML_GLOBAL__.ops_cached.$gwx_XC_192_1
}
__WXML_GLOBAL__.ops_set.$gwx_XC_192=z;
__WXML_GLOBAL__.ops_init.$gwx_XC_192=true;
var x=['./pages/qa_im/index.wxml'];d_[x[0]]={}
var m0=function(e,s,r,gg){
var z=gz$gwx_XC_192_1()
var xCNB=_mz(z,'view',['bindtap',0,'class',1],[],e,s,gg)
var oDNB=_n('view')
_rz(z,oDNB,'class',2,e,s,gg)
var fENB=_v()
_(oDNB,fENB)
if(_oz(z,3,e,s,gg)){fENB.wxVkey=1
var oHNB=_n('view')
_rz(z,oHNB,'class',4,e,s,gg)
var cINB=_v()
_(oHNB,cINB)
if(_oz(z,5,e,s,gg)){cINB.wxVkey=1
}
var oJNB=_v()
_(oHNB,oJNB)
if(_oz(z,6,e,s,gg)){oJNB.wxVkey=1
}
cINB.wxXCkey=1
oJNB.wxXCkey=1
_(fENB,oHNB)
}
else if(_oz(z,7,e,s,gg)){fENB.wxVkey=2
}
var cFNB=_v()
_(oDNB,cFNB)
if(_oz(z,8,e,s,gg)){cFNB.wxVkey=1
var lKNB=_mz(z,'view',['class',9,'style',1],[],e,s,gg)
var aLNB=_v()
_(lKNB,aLNB)
if(_oz(z,11,e,s,gg)){aLNB.wxVkey=1
}
var tMNB=_v()
_(lKNB,tMNB)
if(_oz(z,12,e,s,gg)){tMNB.wxVkey=1
var oPNB=_mz(z,'seo-title-doctor',['bindexpand',13,'doctorInfo',1,'hasFollowed',2,'isMiniCard',3,'problemId',4,'visitPageName',5],[],e,s,gg)
_(tMNB,oPNB)
}
var eNNB=_v()
_(lKNB,eNNB)
if(_oz(z,19,e,s,gg)){eNNB.wxVkey=1
var xQNB=_n('view')
_rz(z,xQNB,'class',20,e,s,gg)
var fSNB=_n('view')
_rz(z,fSNB,'class',21,e,s,gg)
var cTNB=_v()
_(fSNB,cTNB)
if(_oz(z,22,e,s,gg)){cTNB.wxVkey=1
var oVNB=_mz(z,'mp-html',['bind:linktap',23,'bind:load',1,'class',2,'containerStyle',3,'content',4,'copyLink',5,'id',6],[],e,s,gg)
_(cTNB,oVNB)
}
var hUNB=_v()
_(fSNB,hUNB)
if(_oz(z,30,e,s,gg)){hUNB.wxVkey=1
}
cTNB.wxXCkey=1
cTNB.wxXCkey=3
hUNB.wxXCkey=1
_(xQNB,fSNB)
var cWNB=_n('view')
_rz(z,cWNB,'class',31,e,s,gg)
var oXNB=_v()
_(cWNB,oXNB)
if(_oz(z,32,e,s,gg)){oXNB.wxVkey=1
var aZNB=_mz(z,'mp-html',['bind:linktap',33,'class',1,'containerStyle',2,'content',3,'copyLink',4],[],e,s,gg)
_(oXNB,aZNB)
}
var lYNB=_v()
_(cWNB,lYNB)
if(_oz(z,38,e,s,gg)){lYNB.wxVkey=1
}
oXNB.wxXCkey=1
oXNB.wxXCkey=3
lYNB.wxXCkey=1
_(xQNB,cWNB)
var oRNB=_v()
_(xQNB,oRNB)
if(_oz(z,39,e,s,gg)){oRNB.wxVkey=1
}
oRNB.wxXCkey=1
_(eNNB,xQNB)
}
var bONB=_v()
_(lKNB,bONB)
if(_oz(z,40,e,s,gg)){bONB.wxVkey=1
}
aLNB.wxXCkey=1
tMNB.wxXCkey=1
tMNB.wxXCkey=3
eNNB.wxXCkey=1
eNNB.wxXCkey=3
bONB.wxXCkey=1
_(cFNB,lKNB)
}
else{cFNB.wxVkey=2
var t1NB=_mz(z,'view',['class',41,'style',1],[],e,s,gg)
var e2NB=_v()
_(t1NB,e2NB)
if(_oz(z,43,e,s,gg)){e2NB.wxVkey=1
var o6NB=_mz(z,'title-doctor',['bind:show-less',44,'bind:show-more',1,'doctorInfo',2,'entranceType',3,'hasFollowed',4,'isMiniCard',5,'isSelf',6,'problemId',7,'visitPageName',8],[],e,s,gg)
_(e2NB,o6NB)
}
var b3NB=_v()
_(t1NB,b3NB)
if(_oz(z,53,e,s,gg)){b3NB.wxVkey=1
}
var o4NB=_v()
_(t1NB,o4NB)
if(_oz(z,54,e,s,gg)){o4NB.wxVkey=1
}
var x5NB=_v()
_(t1NB,x5NB)
if(_oz(z,55,e,s,gg)){x5NB.wxVkey=1
}
e2NB.wxXCkey=1
e2NB.wxXCkey=3
b3NB.wxXCkey=1
o4NB.wxXCkey=1
x5NB.wxXCkey=1
_(cFNB,t1NB)
}
var f7NB=_mz(z,'scroll-view',['enableBackToTop',-1,'scrollAnchoring',-1,'scrollWithAnimation',-1,'scrollY',-1,'bindscroll',56,'bindscrolltolower',1,'class',2,'enhanced',3,'id',4,'refresherBackground',5,'refresherDefaultStyle',6,'scrollIntoView',7],[],e,s,gg)
var c8NB=_v()
_(f7NB,c8NB)
if(_oz(z,64,e,s,gg)){c8NB.wxVkey=1
}
var h9NB=_v()
_(f7NB,h9NB)
if(_oz(z,65,e,s,gg)){h9NB.wxVkey=1
}
var o0NB=_v()
_(f7NB,o0NB)
if(_oz(z,66,e,s,gg)){o0NB.wxVkey=1
}
var aDOB=_v()
_(f7NB,aDOB)
var tEOB=function(bGOB,eFOB,oHOB,gg){
var oJOB=_mz(z,'mp-html',['bind:linktap',70,'content',1,'copyLink',2],[],bGOB,eFOB,gg)
_(oHOB,oJOB)
return oHOB
}
aDOB.wxXCkey=4
_2z(z,68,tEOB,e,s,gg,aDOB,'item','i','text')
var cAOB=_v()
_(f7NB,cAOB)
if(_oz(z,73,e,s,gg)){cAOB.wxVkey=1
}
var fKOB=_n('view')
_rz(z,fKOB,'class',74,e,s,gg)
var cOOB=_v()
_(fKOB,cOOB)
var oPOB=function(aROB,lQOB,tSOB,gg){
var bUOB=_mz(z,'view',['class',79,'id',1],[],aROB,lQOB,gg)
var oVOB=_v()
_(bUOB,oVOB)
if(_oz(z,81,aROB,lQOB,gg)){oVOB.wxVkey=1
var xWOB=_v()
_(oVOB,xWOB)
var oXOB=function(cZOB,fYOB,h1OB,gg){
var c3OB=_mz(z,'view',['class',84,'id',1],[],cZOB,fYOB,gg)
var l5OB=_n('view')
_rz(z,l5OB,'class',86,cZOB,fYOB,gg)
var a6OB=_v()
_(l5OB,a6OB)
if(_oz(z,87,cZOB,fYOB,gg)){a6OB.wxVkey=1
}
else{a6OB.wxVkey=2
var t7OB=_mz(z,'view',['bindtap',88,'url',1],[],cZOB,fYOB,gg)
var e8OB=_v()
_(t7OB,e8OB)
if(_oz(z,90,cZOB,fYOB,gg)){e8OB.wxVkey=1
}
e8OB.wxXCkey=1
_(a6OB,t7OB)
}
a6OB.wxXCkey=1
_(c3OB,l5OB)
var b9OB=_n('view')
_rz(z,b9OB,'class',91,cZOB,fYOB,gg)
var xAPB=_n('view')
_rz(z,xAPB,'class',92,cZOB,fYOB,gg)
var oBPB=_v()
_(xAPB,oBPB)
if(_oz(z,93,cZOB,fYOB,gg)){oBPB.wxVkey=1
var eLPB=_mz(z,'message-operation',['bind:copy',94,'bind:reply',1,'bind:savePhoto',2,'bind:translate',3,'isDoc',4,'isInEdit',5,'messageContent',6,'messageDialogLocation',7,'messageDialogTypeMap',8],[],cZOB,fYOB,gg)
_(oBPB,eLPB)
}
var fCPB=_v()
_(xAPB,fCPB)
if(_oz(z,103,cZOB,fYOB,gg)){fCPB.wxVkey=1
var bMPB=_v()
_(fCPB,bMPB)
if(_oz(z,104,cZOB,fYOB,gg)){bMPB.wxVkey=1
var oNPB=_mz(z,'view',['bindlongpress',105,'bindtap',1,'data-content',2,'data-item',3,'data-url',4],[],cZOB,fYOB,gg)
var xOPB=_v()
_(oNPB,xOPB)
if(_oz(z,110,cZOB,fYOB,gg)){xOPB.wxVkey=1
var oPPB=_mz(z,'mp-html',['content',111,'copyLink',1],[],cZOB,fYOB,gg)
_(xOPB,oPPB)
}
else{xOPB.wxVkey=2
var fQPB=_mz(z,'mp-html',['bind:linktap',113,'content',1,'copyLink',2],[],cZOB,fYOB,gg)
_(xOPB,fQPB)
}
xOPB.wxXCkey=1
xOPB.wxXCkey=3
xOPB.wxXCkey=3
_(bMPB,oNPB)
}
else{bMPB.wxVkey=2
var cRPB=_mz(z,'view',['bindlongpress',116,'data-content',1,'data-item',2],[],cZOB,fYOB,gg)
var hSPB=_v()
_(cRPB,hSPB)
if(_oz(z,119,cZOB,fYOB,gg)){hSPB.wxVkey=1
var oTPB=_mz(z,'mp-html',['content',120,'copyLink',1],[],cZOB,fYOB,gg)
_(hSPB,oTPB)
}
else{hSPB.wxVkey=2
var cUPB=_mz(z,'mp-html',['bind:linktap',122,'content',1,'copyLink',2],[],cZOB,fYOB,gg)
_(hSPB,cUPB)
}
hSPB.wxXCkey=1
hSPB.wxXCkey=3
hSPB.wxXCkey=3
_(bMPB,cRPB)
}
bMPB.wxXCkey=1
bMPB.wxXCkey=3
bMPB.wxXCkey=3
}
var cDPB=_v()
_(xAPB,cDPB)
if(_oz(z,125,cZOB,fYOB,gg)){cDPB.wxVkey=1
var oVPB=_mz(z,'view',['bindlongpress',126,'capture-catch:tap',1,'class',2,'data-audioid',3,'data-audioindex',4,'data-content',5,'data-item',6,'data-src',7],[],cZOB,fYOB,gg)
var lWPB=_mz(z,'audio-message',['audioData',134,'audioId',1,'bindend',2,'bindread',3,'bindstart',4,'class',5,'isUnread',6,'problemId',7],[],cZOB,fYOB,gg)
_(oVPB,lWPB)
_(cDPB,oVPB)
}
var hEPB=_v()
_(xAPB,hEPB)
if(_oz(z,142,cZOB,fYOB,gg)){hEPB.wxVkey=1
}
var oFPB=_v()
_(xAPB,oFPB)
if(_oz(z,143,cZOB,fYOB,gg)){oFPB.wxVkey=1
}
var cGPB=_v()
_(xAPB,cGPB)
if(_oz(z,144,cZOB,fYOB,gg)){cGPB.wxVkey=1
}
var oHPB=_v()
_(xAPB,oHPB)
if(_oz(z,145,cZOB,fYOB,gg)){oHPB.wxVkey=1
}
var lIPB=_v()
_(xAPB,lIPB)
if(_oz(z,146,cZOB,fYOB,gg)){lIPB.wxVkey=1
var aXPB=_mz(z,'view',['bindtap',147,'class',1,'data-url',2],[],cZOB,fYOB,gg)
var tYPB=_v()
_(aXPB,tYPB)
if(_oz(z,150,cZOB,fYOB,gg)){tYPB.wxVkey=1
}
tYPB.wxXCkey=1
_(lIPB,aXPB)
}
var aJPB=_v()
_(xAPB,aJPB)
if(_oz(z,151,cZOB,fYOB,gg)){aJPB.wxVkey=1
}
var tKPB=_v()
_(xAPB,tKPB)
if(_oz(z,152,cZOB,fYOB,gg)){tKPB.wxVkey=1
var eZPB=_mz(z,'view',['bindtap',153,'class',1,'data-url',2],[],cZOB,fYOB,gg)
var b1PB=_v()
_(eZPB,b1PB)
if(_oz(z,156,cZOB,fYOB,gg)){b1PB.wxVkey=1
}
b1PB.wxXCkey=1
_(tKPB,eZPB)
}
oBPB.wxXCkey=1
oBPB.wxXCkey=3
fCPB.wxXCkey=1
fCPB.wxXCkey=3
cDPB.wxXCkey=1
cDPB.wxXCkey=3
hEPB.wxXCkey=1
oFPB.wxXCkey=1
cGPB.wxXCkey=1
oHPB.wxXCkey=1
lIPB.wxXCkey=1
aJPB.wxXCkey=1
tKPB.wxXCkey=1
_(b9OB,xAPB)
var o0OB=_v()
_(b9OB,o0OB)
if(_oz(z,157,cZOB,fYOB,gg)){o0OB.wxVkey=1
var o2PB=_n('view')
_rz(z,o2PB,'class',158,cZOB,fYOB,gg)
var x3PB=_v()
_(o2PB,x3PB)
if(_oz(z,159,cZOB,fYOB,gg)){x3PB.wxVkey=1
}
var o4PB=_v()
_(o2PB,o4PB)
if(_oz(z,160,cZOB,fYOB,gg)){o4PB.wxVkey=1
}
x3PB.wxXCkey=1
o4PB.wxXCkey=1
_(o0OB,o2PB)
}
o0OB.wxXCkey=1
_(c3OB,b9OB)
var f5PB=_mz(z,'replied-message',['bind:scroll-to-reply',161,'doctorOrPatient',1,'messageData',2,'userIdInfo',3],[],cZOB,fYOB,gg)
_(c3OB,f5PB)
var o4OB=_v()
_(c3OB,o4OB)
if(_oz(z,165,cZOB,fYOB,gg)){o4OB.wxVkey=1
var c6PB=_mz(z,'view',['bind:longpress',166,'class',1,'data-menu-id',2],[],cZOB,fYOB,gg)
var h7PB=_v()
_(c6PB,h7PB)
if(_oz(z,169,cZOB,fYOB,gg)){h7PB.wxVkey=1
}
h7PB.wxXCkey=1
_(o4OB,c6PB)
}
o4OB.wxXCkey=1
_(h1OB,c3OB)
return h1OB
}
xWOB.wxXCkey=4
_2z(z,82,oXOB,aROB,lQOB,gg,xWOB,'item','index','uniqueId')
}
var o8PB=_v()
_(bUOB,o8PB)
var c9PB=function(lAQB,o0PB,aBQB,gg){
var eDQB=_v()
_(aBQB,eDQB)
if(_oz(z,172,lAQB,o0PB,gg)){eDQB.wxVkey=1
var bEQB=_v()
_(eDQB,bEQB)
if(_oz(z,173,lAQB,o0PB,gg)){bEQB.wxVkey=1
}
var oFQB=_mz(z,'view',['class',174,'id',1],[],lAQB,o0PB,gg)
var xGQB=_v()
_(oFQB,xGQB)
if(_oz(z,176,lAQB,o0PB,gg)){xGQB.wxVkey=1
var fIQB=_mz(z,'message-operation',['bind:copy',177,'bind:downloadFile',1,'bind:reply',2,'bind:savePhoto',3,'bind:translate',4,'bind:withdraw',5,'isInEdit',6,'messageContent',7,'messageDialogLocation',8,'messageDialogTypeMap',9],[],lAQB,o0PB,gg)
_(xGQB,fIQB)
}
var cJQB=_n('view')
_rz(z,cJQB,'class',187,lAQB,o0PB,gg)
var hKQB=_v()
_(cJQB,hKQB)
if(_oz(z,188,lAQB,o0PB,gg)){hKQB.wxVkey=1
var eRQB=_v()
_(hKQB,eRQB)
if(_oz(z,189,lAQB,o0PB,gg)){eRQB.wxVkey=1
var bSQB=_mz(z,'view',['bindlongpress',190,'bindtap',1,'data-content',2,'data-item',3],[],lAQB,o0PB,gg)
var oTQB=_v()
_(bSQB,oTQB)
if(_oz(z,194,lAQB,o0PB,gg)){oTQB.wxVkey=1
var xUQB=_mz(z,'mp-html',['content',195,'copyLink',1],[],lAQB,o0PB,gg)
_(oTQB,xUQB)
}
else{oTQB.wxVkey=2
var oVQB=_mz(z,'mp-html',['bind:linktap',197,'content',1,'copyLink',2],[],lAQB,o0PB,gg)
_(oTQB,oVQB)
}
oTQB.wxXCkey=1
oTQB.wxXCkey=3
oTQB.wxXCkey=3
_(eRQB,bSQB)
}
else{eRQB.wxVkey=2
var fWQB=_mz(z,'view',['bindlongpress',200,'data-content',1,'data-item',2],[],lAQB,o0PB,gg)
var cXQB=_v()
_(fWQB,cXQB)
if(_oz(z,203,lAQB,o0PB,gg)){cXQB.wxVkey=1
var hYQB=_mz(z,'mp-html',['content',204,'copyLink',1],[],lAQB,o0PB,gg)
_(cXQB,hYQB)
}
else{cXQB.wxVkey=2
var oZQB=_mz(z,'mp-html',['bind:linktap',206,'content',1,'copyLink',2],[],lAQB,o0PB,gg)
_(cXQB,oZQB)
}
cXQB.wxXCkey=1
cXQB.wxXCkey=3
cXQB.wxXCkey=3
_(eRQB,fWQB)
}
eRQB.wxXCkey=1
eRQB.wxXCkey=3
eRQB.wxXCkey=3
}
var oLQB=_v()
_(cJQB,oLQB)
if(_oz(z,209,lAQB,o0PB,gg)){oLQB.wxVkey=1
}
var cMQB=_v()
_(cJQB,cMQB)
if(_oz(z,210,lAQB,o0PB,gg)){cMQB.wxVkey=1
var c1QB=_mz(z,'view',['bindlongpress',211,'capture-catch:tap',1,'class',2,'data-audioid',3,'data-audioindex',4,'data-content',5,'data-item',6,'data-src',7],[],lAQB,o0PB,gg)
var o2QB=_mz(z,'audio-message',['audioData',219,'audioId',1,'bindstart',2,'class',3,'problemId',4],[],lAQB,o0PB,gg)
_(c1QB,o2QB)
_(cMQB,c1QB)
}
var oNQB=_v()
_(cJQB,oNQB)
if(_oz(z,224,lAQB,o0PB,gg)){oNQB.wxVkey=1
var l3QB=_mz(z,'view',['bindlongpress',225,'class',1,'data-content',2,'data-item',3],[],lAQB,o0PB,gg)
var a4QB=_v()
_(l3QB,a4QB)
if(_oz(z,229,lAQB,o0PB,gg)){a4QB.wxVkey=1
}
a4QB.wxXCkey=1
_(oNQB,l3QB)
}
var lOQB=_v()
_(cJQB,lOQB)
if(_oz(z,230,lAQB,o0PB,gg)){lOQB.wxVkey=1
}
var aPQB=_v()
_(cJQB,aPQB)
if(_oz(z,231,lAQB,o0PB,gg)){aPQB.wxVkey=1
}
var tQQB=_v()
_(cJQB,tQQB)
if(_oz(z,232,lAQB,o0PB,gg)){tQQB.wxVkey=1
}
hKQB.wxXCkey=1
hKQB.wxXCkey=3
oLQB.wxXCkey=1
cMQB.wxXCkey=1
cMQB.wxXCkey=3
oNQB.wxXCkey=1
lOQB.wxXCkey=1
aPQB.wxXCkey=1
tQQB.wxXCkey=1
_(oFQB,cJQB)
var t5QB=_mz(z,'replied-message',['bind:scroll-to-reply',233,'doctorOrPatient',1,'messageData',2,'userIdInfo',3],[],lAQB,o0PB,gg)
_(oFQB,t5QB)
var oHQB=_v()
_(oFQB,oHQB)
if(_oz(z,237,lAQB,o0PB,gg)){oHQB.wxVkey=1
var e6QB=_mz(z,'view',['bind:longpress',238,'class',1,'data-menu-id',2],[],lAQB,o0PB,gg)
var b7QB=_v()
_(e6QB,b7QB)
if(_oz(z,241,lAQB,o0PB,gg)){b7QB.wxVkey=1
}
b7QB.wxXCkey=1
_(oHQB,e6QB)
}
xGQB.wxXCkey=1
xGQB.wxXCkey=3
oHQB.wxXCkey=1
_(eDQB,oFQB)
bEQB.wxXCkey=1
}
eDQB.wxXCkey=1
eDQB.wxXCkey=3
return aBQB
}
o8PB.wxXCkey=4
_2z(z,170,c9PB,aROB,lQOB,gg,o8PB,'item','index','index')
var o8QB=_v()
_(bUOB,o8QB)
var x9QB=function(fARB,o0QB,cBRB,gg){
var oDRB=_v()
_(cBRB,oDRB)
if(_oz(z,244,fARB,o0QB,gg)){oDRB.wxVkey=1
var cERB=_v()
_(oDRB,cERB)
if(_oz(z,245,fARB,o0QB,gg)){cERB.wxVkey=1
var oNRB=_mz(z,'feedback-card',['bind:feedback',246,'doctorId',1,'feedbackInfo',2,'problemId',3],[],fARB,o0QB,gg)
_(cERB,oNRB)
}
var oFRB=_v()
_(oDRB,oFRB)
if(_oz(z,250,fARB,o0QB,gg)){oFRB.wxVkey=1
var fORB=_mz(z,'mp-html',['bind:linktap',251,'content',1,'copyLink',2,'data-action-index',3,'data-clickinfo',4,'data-dialog',5,'tagStyle',6],[],fARB,o0QB,gg)
_(oFRB,fORB)
}
var lGRB=_v()
_(oDRB,lGRB)
if(_oz(z,258,fARB,o0QB,gg)){lGRB.wxVkey=1
}
var aHRB=_v()
_(oDRB,aHRB)
if(_oz(z,259,fARB,o0QB,gg)){aHRB.wxVkey=1
var cPRB=_mz(z,'link-notice-user',['doctorId',260,'itemData',1],[],fARB,o0QB,gg)
_(aHRB,cPRB)
}
var tIRB=_v()
_(oDRB,tIRB)
if(_oz(z,262,fARB,o0QB,gg)){tIRB.wxVkey=1
var hQRB=_n('view')
_rz(z,hQRB,'class',263,fARB,o0QB,gg)
var cSRB=_mz(z,'mp-html',['bind:linktap',264,'content',1,'copyLink',2],[],fARB,o0QB,gg)
_(hQRB,cSRB)
var oRRB=_v()
_(hQRB,oRRB)
if(_oz(z,267,fARB,o0QB,gg)){oRRB.wxVkey=1
}
oRRB.wxXCkey=1
_(tIRB,hQRB)
}
var eJRB=_v()
_(oDRB,eJRB)
if(_oz(z,268,fARB,o0QB,gg)){eJRB.wxVkey=1
}
var bKRB=_v()
_(oDRB,bKRB)
if(_oz(z,269,fARB,o0QB,gg)){bKRB.wxVkey=1
}
var oLRB=_v()
_(oDRB,oLRB)
if(_oz(z,270,fARB,o0QB,gg)){oLRB.wxVkey=1
var oTRB=_mz(z,'view',['bindtap',271,'class',1,'data-ad-id',2,'data-ad-title',3,'data-oneType',4,'data-twoType',5,'data-url',6,'data-weixin',7],[],fARB,o0QB,gg)
var lURB=_mz(z,'mp-html',['content',279,'copyLink',1],[],fARB,o0QB,gg)
_(oTRB,lURB)
_(oLRB,oTRB)
}
var xMRB=_v()
_(oDRB,xMRB)
if(_oz(z,281,fARB,o0QB,gg)){xMRB.wxVkey=1
var aVRB=_n('assess')
_rz(z,aVRB,'assessData',282,fARB,o0QB,gg)
_(xMRB,aVRB)
}
cERB.wxXCkey=1
cERB.wxXCkey=3
oFRB.wxXCkey=1
oFRB.wxXCkey=3
lGRB.wxXCkey=1
aHRB.wxXCkey=1
aHRB.wxXCkey=3
tIRB.wxXCkey=1
tIRB.wxXCkey=3
eJRB.wxXCkey=1
bKRB.wxXCkey=1
oLRB.wxXCkey=1
oLRB.wxXCkey=3
xMRB.wxXCkey=1
xMRB.wxXCkey=3
}
oDRB.wxXCkey=1
oDRB.wxXCkey=3
return cBRB
}
o8QB.wxXCkey=4
_2z(z,242,x9QB,aROB,lQOB,gg,o8QB,'item','index','index')
oVOB.wxXCkey=1
oVOB.wxXCkey=3
_(tSOB,bUOB)
return tSOB
}
cOOB.wxXCkey=4
_2z(z,77,oPOB,e,s,gg,cOOB,'content','i','uniqueId')
var tWRB=_v()
_(fKOB,tWRB)
var eXRB=function(oZRB,bYRB,x1RB,gg){
var f3RB=_v()
_(x1RB,f3RB)
if(_oz(z,285,oZRB,bYRB,gg)){f3RB.wxVkey=1
var c4RB=_mz(z,'view',['bindtap',286,'data-ad-id',1,'data-ad-title',2,'data-button',3,'data-oneType',4,'data-twoType',5,'data-url',6,'data-weixin',7],[],oZRB,bYRB,gg)
var h5RB=_v()
_(c4RB,h5RB)
if(_oz(z,294,oZRB,bYRB,gg)){h5RB.wxVkey=1
}
else if(_oz(z,295,oZRB,bYRB,gg)){h5RB.wxVkey=2
var o6RB=_mz(z,'mp-html',['content',296,'copyLink',1],[],oZRB,bYRB,gg)
_(h5RB,o6RB)
}
h5RB.wxXCkey=1
h5RB.wxXCkey=3
_(f3RB,c4RB)
}
f3RB.wxXCkey=1
f3RB.wxXCkey=3
return x1RB
}
tWRB.wxXCkey=4
_2z(z,283,eXRB,e,s,gg,tWRB,'item','index','index')
var cLOB=_v()
_(fKOB,cLOB)
if(_oz(z,298,e,s,gg)){cLOB.wxVkey=1
}
var hMOB=_v()
_(fKOB,hMOB)
if(_oz(z,299,e,s,gg)){hMOB.wxVkey=1
}
var oNOB=_v()
_(fKOB,oNOB)
if(_oz(z,300,e,s,gg)){oNOB.wxVkey=1
}
cLOB.wxXCkey=1
hMOB.wxXCkey=1
oNOB.wxXCkey=1
_(f7NB,fKOB)
var oBOB=_v()
_(f7NB,oBOB)
if(_oz(z,301,e,s,gg)){oBOB.wxVkey=1
var c7RB=_mz(z,'recommend-section',['bind:update',302,'problemId',1,'visitPageName',2],[],e,s,gg)
_(oBOB,c7RB)
}
var lCOB=_v()
_(f7NB,lCOB)
if(_oz(z,305,e,s,gg)){lCOB.wxVkey=1
}
c8NB.wxXCkey=1
h9NB.wxXCkey=1
o0NB.wxXCkey=1
cAOB.wxXCkey=1
oBOB.wxXCkey=1
oBOB.wxXCkey=3
lCOB.wxXCkey=1
_(oDNB,f7NB)
var o8RB=_mz(z,'view',['class',306,'style',1],[],e,s,gg)
var l9RB=_v()
_(o8RB,l9RB)
if(_oz(z,308,e,s,gg)){l9RB.wxVkey=1
}
var a0RB=_v()
_(o8RB,a0RB)
if(_oz(z,309,e,s,gg)){a0RB.wxVkey=1
}
var tASB=_v()
_(o8RB,tASB)
if(_oz(z,310,e,s,gg)){tASB.wxVkey=1
}
var eBSB=_v()
_(o8RB,eBSB)
if(_oz(z,311,e,s,gg)){eBSB.wxVkey=1
var fGSB=_mz(z,'additional-action-block',['bind:apply-medicine',312,'bind:goAssess',1,'doctorId',2,'guide',3,'isInEdit',4,'isRepling',5,'problemId',6,'status',7,'visitPageName',8],[],e,s,gg)
_(eBSB,fGSB)
}
var bCSB=_v()
_(o8RB,bCSB)
if(_oz(z,321,e,s,gg)){bCSB.wxVkey=1
var cHSB=_n('view')
_rz(z,cHSB,'class',322,e,s,gg)
var hISB=_v()
_(cHSB,hISB)
if(_oz(z,323,e,s,gg)){hISB.wxVkey=1
var oLSB=_v()
_(hISB,oLSB)
if(_oz(z,324,e,s,gg)){oLSB.wxVkey=1
var lMSB=_v()
_(oLSB,lMSB)
if(_oz(z,325,e,s,gg)){lMSB.wxVkey=1
}
var aNSB=_n('view')
_rz(z,aNSB,'class',326,e,s,gg)
var tOSB=_v()
_(aNSB,tOSB)
if(_oz(z,327,e,s,gg)){tOSB.wxVkey=1
}
var ePSB=_v()
_(aNSB,ePSB)
if(_oz(z,328,e,s,gg)){ePSB.wxVkey=1
}
var bQSB=_mz(z,'view',['catchtap',329,'data-from-type',1,'data-position',2,'openType',3,'url',4],[],e,s,gg)
var oRSB=_v()
_(bQSB,oRSB)
if(_oz(z,334,e,s,gg)){oRSB.wxVkey=1
var xSSB=_v()
_(oRSB,xSSB)
if(_oz(z,335,e,s,gg)){xSSB.wxVkey=1
}
xSSB.wxXCkey=1
}
oRSB.wxXCkey=1
_(aNSB,bQSB)
tOSB.wxXCkey=1
ePSB.wxXCkey=1
_(oLSB,aNSB)
lMSB.wxXCkey=1
}
oLSB.wxXCkey=1
}
var oJSB=_v()
_(cHSB,oJSB)
if(_oz(z,336,e,s,gg)){oJSB.wxVkey=1
var fUSB=_n('view')
_rz(z,fUSB,'class',337,e,s,gg)
var cVSB=_v()
_(fUSB,cVSB)
if(_oz(z,338,e,s,gg)){cVSB.wxVkey=1
}
var hWSB=_v()
_(fUSB,hWSB)
if(_oz(z,339,e,s,gg)){hWSB.wxVkey=1
}
cVSB.wxXCkey=1
hWSB.wxXCkey=1
_(oJSB,fUSB)
var oTSB=_v()
_(oJSB,oTSB)
if(_oz(z,340,e,s,gg)){oTSB.wxVkey=1
}
oTSB.wxXCkey=1
}
var cKSB=_v()
_(cHSB,cKSB)
if(_oz(z,341,e,s,gg)){cKSB.wxVkey=1
var oXSB=_v()
_(cKSB,oXSB)
if(_oz(z,342,e,s,gg)){oXSB.wxVkey=1
}
var cYSB=_n('view')
_rz(z,cYSB,'class',343,e,s,gg)
var oZSB=_v()
_(cYSB,oZSB)
if(_oz(z,344,e,s,gg)){oZSB.wxVkey=1
}
var l1SB=_v()
_(cYSB,l1SB)
if(_oz(z,345,e,s,gg)){l1SB.wxVkey=1
}
var a2SB=_v()
_(cYSB,a2SB)
if(_oz(z,346,e,s,gg)){a2SB.wxVkey=1
}
oZSB.wxXCkey=1
l1SB.wxXCkey=1
a2SB.wxXCkey=1
_(cKSB,cYSB)
oXSB.wxXCkey=1
}
hISB.wxXCkey=1
oJSB.wxXCkey=1
cKSB.wxXCkey=1
_(bCSB,cHSB)
}
var oDSB=_v()
_(o8RB,oDSB)
if(_oz(z,347,e,s,gg)){oDSB.wxVkey=1
}
var xESB=_v()
_(o8RB,xESB)
if(_oz(z,348,e,s,gg)){xESB.wxVkey=1
var t3SB=_mz(z,'new-user-welfare-bar',['adDetail',349,'bottomGroupHeight',1,'pageReadableName',2],[],e,s,gg)
_(xESB,t3SB)
}
var oFSB=_v()
_(o8RB,oFSB)
if(_oz(z,352,e,s,gg)){oFSB.wxVkey=1
var e4SB=_mz(z,'qa-button-group',['bind:go-new-ai-dialog',353,'bind:show-ai-dialog',1,'mark:type',2,'problemId',3,'renderData',4],[],e,s,gg)
_(oFSB,e4SB)
}
l9RB.wxXCkey=1
a0RB.wxXCkey=1
tASB.wxXCkey=1
eBSB.wxXCkey=1
eBSB.wxXCkey=3
bCSB.wxXCkey=1
oDSB.wxXCkey=1
xESB.wxXCkey=1
xESB.wxXCkey=3
oFSB.wxXCkey=1
oFSB.wxXCkey=3
_(oDNB,o8RB)
var hGNB=_v()
_(oDNB,hGNB)
if(_oz(z,358,e,s,gg)){hGNB.wxVkey=1
var b5SB=_n('view')
_rz(z,b5SB,'class',359,e,s,gg)
var o6SB=_v()
_(b5SB,o6SB)
if(_oz(z,360,e,s,gg)){o6SB.wxVkey=1
var o8SB=_v()
_(o6SB,o8SB)
if(_oz(z,361,e,s,gg)){o8SB.wxVkey=1
var c0SB=_mz(z,'cy-userinfo',['bindisloginevent',362,'bindloginevent',1,'bindloginfail',2],[],e,s,gg)
_(o8SB,c0SB)
}
var f9SB=_v()
_(o6SB,f9SB)
if(_oz(z,365,e,s,gg)){f9SB.wxVkey=1
}
o8SB.wxXCkey=1
o8SB.wxXCkey=3
f9SB.wxXCkey=1
}
var x7SB=_v()
_(b5SB,x7SB)
if(_oz(z,366,e,s,gg)){x7SB.wxVkey=1
}
o6SB.wxXCkey=1
o6SB.wxXCkey=3
x7SB.wxXCkey=1
_(hGNB,b5SB)
}
fENB.wxXCkey=1
cFNB.wxXCkey=1
cFNB.wxXCkey=3
cFNB.wxXCkey=3
hGNB.wxXCkey=1
hGNB.wxXCkey=3
_(xCNB,oDNB)
_(r,xCNB)
var a8MB=_v()
_(r,a8MB)
if(_oz(z,367,e,s,gg)){a8MB.wxVkey=1
}
var t9MB=_v()
_(r,t9MB)
if(_oz(z,368,e,s,gg)){t9MB.wxVkey=1
}
var e0MB=_v()
_(r,e0MB)
if(_oz(z,369,e,s,gg)){e0MB.wxVkey=1
var hATB=_mz(z,'multiple-ask',['bind:close-dialog',370,'info',1,'problemId',2,'scene',3,'services',4],[],e,s,gg)
_(e0MB,hATB)
}
var oBTB=_mz(z,'page-container',['bind:beforeleave',375,'show',1],[],e,s,gg)
var cCTB=_v()
_(oBTB,cCTB)
if(_oz(z,377,e,s,gg)){cCTB.wxVkey=1
var lETB=_mz(z,'feedback-detail',['bind:leave',378,'defaultValue',1,'doctorId',2,'fromType',3,'problemId',4,'serviceType',5,'shouldFeedbackShow',6],[],e,s,gg)
_(cCTB,lETB)
}
var oDTB=_v()
_(oBTB,oDTB)
if(_oz(z,385,e,s,gg)){oDTB.wxVkey=1
var aFTB=_mz(z,'append-clinic',['bind:cancel',386,'bind:confirm',1,'clinicList',2],[],e,s,gg)
_(oDTB,aFTB)
}
cCTB.wxXCkey=1
cCTB.wxXCkey=3
oDTB.wxXCkey=1
oDTB.wxXCkey=3
_(r,oBTB)
var tGTB=_mz(z,'clinic-selector',['bind:confirm-clinic',389,'bind:toggle-component',1,'shouldClinicSelectorShow',2],[],e,s,gg)
_(r,tGTB)
var bANB=_v()
_(r,bANB)
if(_oz(z,392,e,s,gg)){bANB.wxVkey=1
}
var oBNB=_v()
_(r,oBNB)
if(_oz(z,393,e,s,gg)){oBNB.wxVkey=1
}
a8MB.wxXCkey=1
t9MB.wxXCkey=1
e0MB.wxXCkey=1
e0MB.wxXCkey=3
bANB.wxXCkey=1
oBNB.wxXCkey=1
return r
}
e_[x[0]]={f:m0,j:[],i:[],ti:[],ic:[]}
if(path&&e_[path]){
return function(env,dd,global){$gwxc=0;var root={"tag":"wx-page"};root.children=[]
;g="$gwx_XC_192";var main=e_[path].f
if (typeof global==="undefined")global={};global.f=$gdc(f_[path],"",1);
try{
main(env,{},root,global);
_tsd(root)
}catch(err){
console.log(err)
}
;g="";
return root;
}
}
}
}(__g.a,__g.b,__g.c,__g.d,__g.e,__g.f,__g.g,__g.h,__g.i,__g.j,__g.k,__g.l,__g.m,__g.n,__g.o,__g.p,__g.q,__g.r,__g.s,__g.t,__g.u,__g.v,__g.w,__g.x,__g.y,__g.z,__g.A,__g.B,__g.C,__g.D,__g.E,__g.F,__g.G,__g.H,__g.I,__g.J,__g.K,__g.L,__g.M,__g.N,__g.O,__g.P,__g.Q,__g.R,__g.S,__g.T,__g.U,__g.V,__g.W,__g.X,__g.Y,__g.Z,__g.aa);if(__vd_version_info__.delayedGwx||false)$gwx_XC_192();	if (__vd_version_info__.delayedGwx) __wxAppCode__['pages/qa_im/index.wxml'] = [$gwx_XC_192, './pages/qa_im/index.wxml'];else __wxAppCode__['pages/qa_im/index.wxml'] = $gwx_XC_192( './pages/qa_im/index.wxml' );
	;__wxRoute = "pages/qa_im/index";__wxRouteBegin = true;__wxAppCurrentFile__="pages/qa_im/index.js";define("pages/qa_im/index.js",function(require,module,exports,window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){
"use strict";var e=require("../../@babel/runtime/helpers/interopRequireDefault");require("../../@babel/runtime/helpers/Arrayincludes");var t,a=require("../../@babel/runtime/helpers/defineProperty"),o=require("../../@babel/runtime/helpers/toConsumableArray"),i=e(require("../../@babel/runtime/regenerator")),n=require("../../@babel/runtime/helpers/asyncToGenerator"),s=require("../../@babel/runtime/helpers/objectSpread2"),r=require("../../982D50C4829A079CFE4B38C322EC7B70.js"),c=require("../../1D735BD7829A079C7B1533D0C5CC7B70.js"),l=require("../../43A2F676829A079C25C49E711B4C7B70.js"),d=require("../../28984410829A079C4EFE2C17502C7B70.js"),u=e(require("../../095CB6D2829A079C6F3ADED52E0C7B70.js")),p=require("../../28984410829A079C4EFE2C17502C7B70.js"),_=e(require("../../7B9C8496829A079C1DFAEC91795C7B70.js")),h=e(require("../../6A719353829A079C0C17FB54BF7D7B70.js")),f=e(require("../../3B123513829A079C5D745D1477BC7B70.js")),m=getApp(),g=require("../../BC983DD1829A079CDAFE55D6E84D7B70.js").baseUrl,w=require("../../92BC1755829A079CF4DA7F52C55D7B70.js"),b=w.param,v=w.Timer,x=w.getQueryStr,T=require("../../840A1D64829A079CE26C7563276C7B70.js").doPoint,y=require("../../ACF33105829A079CCA9559029C0D7B70.js"),D=g+"/cooperation/wap/get_problem_detail/",S=g+"/cooperation/wap/problem_detail_page/",C=g+"/cooperation/wap/create_problem_content/",k=g+"/cooperation/wap/delete_problem/",I=g+"/files/upload_token/",A=g+"/cooperation/wap/refund_paid_problem/",P=require("../../56F44BB4829A079C309223B3039D7B70.js").WEBSOCKET_URL,M=g+"/api/v5/doctor/",R=g+"/api/third_party/get_username/",N=g+"/cooperation/wap/problem/content/withdraw/",O=g+"/cooperation/wap/ask_many/problem/doctors/",q="".concat(g,"/api/v7/new_user/to_doc/"),Q="".concat(g,"/api/content/audio/to_text/"),B="".concat(g,"/qa_operation/quick_ask/user_expand_clinic/"),F="".concat(g,"/cooperation/wap/get_hide_problem_base_info/"),E="".concat(g,"/cooperation/third_ai/conversation/new/"),H=g+"/events/new_user_welfare/entrance_info/?from_wx_mini=1",j=require("../../D6CAF1F1829A079CB0AC99F6BFEC7B70.js"),L=require("../../94310D64829A079CF2576563CCAC7B70.js"),U=L.uploadVideo,V=L.saveImageToPhotosAlbum,G=L.saveVideoToPhotosAlbum,W=L.uploadFile,z=L.getToken,J=[];Page({data:{currentAiChatUrl:"",shouldAiChatShow:!1,aiNavigateType:"",mphtmlTagStyle:{a:"color: red"},isPrivacyQa:!1,noticeUserList:[],longPressedMessageId:null,isShowMsgOperationDialog:!1,nowTime:"",isLogin:!1,avatarUrl:"",user_id:"",show_popup:!1,qa_toast:{},sending_finish_video:"",ready_video_list:[],clearContents:[],video_show:!1,video_time:0,video_size:0,from_expert_call:!1,has_followed:!1,doctor_info:null,lastQAId:0,loading_hidden:!0,toast_hidden:!0,error_msg:"",problem_id:"",contents:[],interval:1e4,hasInputed:!1,icon_selected:-1,func_hidden:!0,newQuestionText:"",audio_hidden:!0,audioTip_hidden:!0,audio_text:"按住说话",audioTipText:"手指上划，取消发送",bg:"#11bd4b",audioTipBg:"#11bd4b",record_time:0,audio_timer:null,ifSendVoice:!0,currentAudioIndex:0,playOrNot:!1,audioId:"",audioIndex:-1,audioObj:null,paddingBottom:100,platform:"",footerBottom:null,is_problem_user:"",display:"hide",btn_text:"我要问医生",img_display:"show",free_display:"hide",has_img_ans:"hide",no_img_ans:"hide",jump_url:"",tag:"imgask",isRefundTrans:!1,isRefund:!1,bottom_info_list:{price:"",graph:!1,edit:!1,refunded:!1,assess:!1,reward:!1,re_checkup:!1,ask_doctor:!1,doctor_info:!1,phone_closed:!1},footer:"",contentHeight:485,scrollPosition:"qaid1",adjusLayerHidden:!0,multiArray:[],multiIndex:[0,0],showClinicAdjustment:!1,timerCount:8,clinicName:"",clinicNo:"",clinicSecondNo:"",disclaimerList:[],isActivityPartner:!1,footer_ad:[],imageWidth:299,options:{},hasPrivacyModal:!1,onShowTrigger:!1,guide:[],alert_info:[],shouldBottomRecommendDoctorShow:!1,pageType:"",shouldProDetailHide:!0,isCurrentProDetailHide:!0,shouldLimitMessageMainContainerHeight:!1,isFirstTimeRenderContent:!0,hasRecommendDoctor:!1,hasRecommendTopic:!1,shouldLimitQaContentHeight:!1,winHeightForRpx:"",bottomAnchor:"bottom-anchor",buttonGroupRenderData:{},onloadOptions:{},entranceTypes:p.ENTRANCE_TYPES,currentEntranceType:"",multiple_ask:{type:"multiple_ask",text:" fake一键咨询多位医生，解答更全面",images:["url1","url2"],extra_desc:"xxx人已购买fake",button_text:"按钮文案fake"},shouldMultipleAskIndicatorShow:!1,shouldMultipleAskDialogShow:!1,multipleAskInfo:{},toClinicServices:[],self:!1,lastScrollTop:0,isSeoTitleDoctorMiniCard:!1,shouldHideProDetail:!1,targetScrollAnchor:"",isMiniCardOriginalTitleDoctor:!1,scrollBreakPoint:!1,trackIndicator:!0,dayFristVisit:!1,replyArea:{type:"",shouldShow:!1,content:"",id:"",subContentIdx:""},pageContainer:{shouldShow:!1,type:"text",textContent:"",audioContent:{audioContext:{}}},userIdInfo:{},isInputFocus:!1,messageOperationMap:{text:["copy","withdraw","reply"],dicom:["withdraw","reply"],video:["withdraw","reply","savePhoto"],image:["withdraw","reply","savePhoto"],audio:["withdraw","reply","translate"],file:["withdraw","reply"],add_profile_card:[]},currentShowingTranslateMenuId:"",shouldHideTranslateDialog:!0,audioInfoMap:{},isNewVersionAudio:!1,feedbackInfo:{serviceType:"",problemId:"",shouldFeedbackShow:!1,defaultValue:""},shouldGeneralPageContainerShow:!1,hasReachedBottomBufferArea:!1,msgReadInfo:{},tapToBottomInfo:{shouldTapToBottomContainerShow:!1,scrollBufferPx:20},topNewMessageInfo:{shouldShow:!1,count:0,firstPosition:""},bottomNewMessageInfo:{shouldShow:!1,count:0,firstPosition:""},readStatusPosition:{last_position:"",first_position:""},isAjaxQaPending:!1,shouldListenToScrollElementInView:!1,reselectClinicInfo:{isFirstInitiating:!0,change_clinic_seconds:0,expand_clinic_list:[],shouldClinicSelectorShow:!1,shouldAppendClinicShow:!1,reselectClinicListObj:{},countDownId:"",indicatingText:"",currentClinicNo:""},shouldTapToTopIndicatorHide:!1,newUserWelfare:{},bottomGroupHeight:0,isSeoPage:!1,visitPageName:"",fromVisitPage:"",qiYuConfig:"",hasRecommendSection:!1,seoOptions:{scene:1e4,path:"",query:{},nativeSeoSceneList:[1005,1006,1026,1042,1053,1054,1077,1106,1129,1145,1183,1260,1252]}},allPullIds:{},onUnload:function(){m.globalData.isTelInquiry&&wx.reLaunch({url:"/pages/all_service/index"}),this.clearAllPolling()},toggleProDetail:function(){this.setData({isCurrentProDetailHide:!this.data.isCurrentProDetailHide})},loginActions:function(){var e=m.getUserProfileGlobal();e.isSuccess&&this.setData({avatarUrl:e.avatarUrl}),this.getUserId()},loginSuccess:function(){this.getUserId(),this.setData({isLogin:!0})},loginFail:function(){this.setData({isLogin:!1})},updateRecommendSectionStatus:function(e){this.setData({hasRecommendSection:e.detail.hasRecommendSection})},getUserId:function(){var e=this;m.globalData.sessionid&&wx.request({url:R,header:{Cookie:m.globalData.sessionid},success:function(t){e.setData({user_id:t.data.user_id})},fail:function(){e.setData({user_id:"user_id_fail"})}})},startQiYu:function(){var e=this;(0,r.getQiYu)().then((function(t){e.setData({qiYuConfig:t})}))},serviceAppClick:function(){m.sensors.track("AdClick",{app:this.data.options&&"app"===this.data.options.from?"0":"weixin_mini",ad_position:"ADQA页弹窗点击",ad_title:this.data.qa_toast.ad_title||""})},onLoad:function(e){var t=this,a=wx.getLaunchOptionsSync(),o=a.scene,i=a.path,n=a.query;this.setData({"seoOptions.scene":o,"seoOptions.path":i,"seoOptions.query":n}),wx.getSystemInfoSync({success:function(e){t.setData({platform:e.platform})}}),this.startQiYu(),this.setData({shouldTapToTopIndicatorHide:!!wx.getStorageSync("QA_SHOULD_TAP_TO_TOP_INDICATOR_HIDE")}),wx.setStorageSync("QA_SHOULD_TAP_TO_TOP_INDICATOR_HIDE",!0),this.allPullIds={},this.data.shouldHideTranslateDialog=Boolean(wx.getStorageSync("shouldHideTranslateDialog"));var s=(0,u.default)(e);this.setData({currentEntranceType:s,fromVisitPage:(null==s?void 0:s.desc)||e.from_visit_page}),this.data.onloadOptions=e,this.data.seoOptions.nativeSeoSceneList.indexOf(this.data.seoOptions.scene)>-1&&this.data.seoOptions.query.problem_id===e.problem_id&&((0,h.default)({id:"seo_weixin_native_search",hasPassed:!0,extraInfo:{problem_id:e.problem_id}}),this.setData({pageType:"native_search"})),e.page_type&&this.setData({pageType:e.page_type}),1===Number(e.output)&&"weixin"===e.partner&&(0,h.default)({id:"seo_chunyu_seo",hasPassed:!0,extraInfo:{problem_id:e.problem_id}});var r=this,c=wx.getStorageSync("sessionUserId");c&&this.setData({isLogin:!0,user_id:c.data}),r.setData({imageWidth:.8*wx.getSystemInfoSync().windowWidth,options:e});var l=!!e.from_expert_call_id;wx.getSystemInfo({success:function(e){r.setData({platform:e.platform,model:e.model,windowHeight:e.windowHeight?e.windowHeight:e.screenHeight,windowWidth:e.windowWidth?e.windowWidth:e.screenWidth})}});var d=m.globalData.sessionid;r.setData({from_expert_call:l,problem_id:e&&e.problem_id?e.problem_id:m.globalData.problem_id,"feedbackInfo.problemId":e&&e.problem_id?e.problem_id:m.globalData.problem_id,"feedbackInfo.serviceType":"graph",doctor_info:m.globalData.doctor_info,sessionid:d,isActivityPartner:!!m.globalData.activityPartner}),r.init(e)},onShow:function(){this.data.onShowTrigger&&this.ajaxQA({noScroll:!0}),this.setData({onShowTrigger:!0});var e=this;m.globalData.appIsLogin.then((function(){e.setData({dayFristVisit:!1})}),(function(){var t,a=function(){var e=new Date,t=("0"+String(e.getDate())).slice(-2);return("0"+String(e.getMonth()+1)).slice(-2)+"/"+t+"/"+e.getFullYear()},o=wx.getStorageSync("OPENED_MINI_APP_IN_HISTORY_FOR_COUPON");o?a()===o?t=!0:a()!==o&&(t=!1):(wx.setStorageSync("OPENED_MINI_APP_IN_HISTORY_FOR_COUPON",a()),t=!0),e.setData({dayFristVisit:t})})),"seo_page"===this.getFromPage()?(this.getNewUserWelfare(),this.setData({isSeoPage:!0})):this.setData({isSeoPage:!1})},goNavigator:function(e){m.sensors.track("AdClick",{app:this.data.options&&"app"===this.data.options.from?"0":"weixin_mini",ad_position:"ADQA页弹窗点击",ad_title:this.data.qa_toast.ad_title||""});var t=e.currentTarget.dataset.onetype,a=e.currentTarget.dataset.weixin,o=e.currentTarget.dataset.url;o?"weixin_mini"===t?wx.navigateTo({url:a}):wx.redirectTo({url:"/pages/h5_webview/index?url=".concat(encodeURIComponent(o))}):this.setData({show_popup:!1,qa_toast:{}})},closePopup:function(){m.sensors.track("AdClick",{app:this.data.options&&"app"===this.data.options.from?"0":"weixin_mini",ad_position:"ADQA页弹窗关闭",ad_title:this.data.qa_toast.ad_title||""}),this.setData({show_popup:!1,qa_toast:{}})},init:function(e){var t=this,a=this,o=m.globalData.sessionid,i=m.globalData.partner,n=a.data.problem_id;wx.request({url:S,header:{Cookie:o},data:{from_wx_mini:1,partner:i,problem_id:n||e.problem_id,is_json:1,device_id:wx.getStorageSync("open_id")||wx.getStorageSync("device_id")},success:function(o){if(400!==o.statusCode){var r=o.data,c=r.problem_detail;if(c){var l=c?c.hint_info:void 0,d=c.pay_status,u=!1,p="",g=r.footer;u=!(!l||l.is_referred||"r"!=d),p=!(!l||!l.is_referred),a.setData({partner:i,doctor_info:r.doctor_info,is_problem_user:r.is_problem_user,page_info:r.page_info,problem_detail:r.problem_detail,isRefund:u,isRefundTrans:p,footer:g}),a.setPageTitle(),"r"==r.problem_detail.pay_status&&a.setData({func_hidden:!0}),e.isFirstFetch=!0;a.ajaxQA(s(s({},e),{},{isInitiating:!0,manual:1}),function(){(0,f.default)({fromName:this.data.fromVisitPage||"",name:this.data.visitPageName||"",extraInfo:{}})}.bind(a)),m.globalData.appIsLogin.then((function(){r.is_problem_user&&"c"!=r.problem_detail.status&&(a.initWebSocket(),a.initWebsocketEvenHandlert())})),a.getNewUserToDoc()}else wx.showToast({title:"获取数据失败"})}else{if("from_seo"!==t.data.currentEntranceType.value&&"seo_similar_problem"!==t.data.currentEntranceType.value)return m.sensors.track("PageView",{app:"weixin_mini",page_readable_name:"QA详情页",problem_id_str:a.data.problem_id}),void wx.showModal({title:"提示",content:"因用户隐私无法显示",confirmText:"我知道了",confirmColor:"#39d167",showCancel:!1,success:function(e){wx.navigateBack()}});if((0,_.default)({url:F,data:{problem_id:n,from_scene:"seo_page"},success:function(e){var o,i;0===e.data.error_code&&(t.setData({isPrivacyQa:!0,doctor_info:e.data.doctor_info,has_followed:e.data.doctor_info.has_followed}),t.setBottomButtonInfo(e.data),m.sensors.track("PageView",{app:"weixin_mini",page_readable_name:"QA详情页",problem_id_str:a.data.problem_id,from_type:a.data.currentEntranceType.value,first_department:String(a.data.doctor_info.first_clinic_name),second_department:String(a.data.doctor_info.second_clinic_name),is_show:"ai_chat"===(null===(o=a.data.buttonGroupRenderData.extra_type_info)||void 0===o||null===(i=o.cy_redirect)||void 0===i?void 0:i.target_type)}))}}),(0,h.default)({id:"v2"===a.data.pageType||"native_search"===a.data.pageType?"qa_privacy_issue_seo":"qa_privacy_issue",hasPassed:!1,errorMsg:"问题ID：".concat(n),extraInfo:{problem_id:n}}),a.data.hasPrivacyModal)return;a.setData({hasPrivacyModal:!0})}},fail:function(e){a.setData({error_msg:e?e.error_msg:"接口请求出错",toast_hidden:!1})}})},suggestHtmlLoaded:function(){this.checkShouldCollapseProDetail()},setPageTitle:function(){"v2"===this.data.pageType||"native_search"===this.data.pageType?wx.setNavigationBarTitle({title:"春雨医生"}):this.data.doctor_info&&this.data.doctor_info.name?wx.setNavigationBarTitle({title:"".concat(this.data.doctor_info.name,"医生")}):wx.setNavigationBarTitle({title:"问题详情"})},getNewUserWelfare:function(){var e=this;return n(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.data.isLogin){t.next=3;break}return t.next=3,(0,l.manualLogin)();case 3:(0,_.default)({url:H,data:{from_wx_mini:1,device_id:wx.getStorageSync("open_id")||wx.getStorageSync("device_id"),scene:"seo_qa"},success:function(t){200===t.statusCode&&t.data&&e.setData({newUserWelfare:t.data})}});case 4:case"end":return t.stop()}}),t)})))()},webSocketHeader:function(){var e=this.data.platform,t=void 0===e?"":e,a={"content-type":"application/json",cookie:m.globalData.sessionid};return"devtools"!==t&&delete a.origin,a},initWebSocket:function(){var e=this;m.globalData.socketOpen||wx.connectSocket({url:P,header:e.webSocketHeader(),method:"GET",success:function(){m.globalData.socketOpen=!0},fail:function(){console.error(m.globalData.socketOpen,"socketOpenfail")}}),wx.onSocketOpen((function(e){m.globalData.socketOpen=!0})),wx.onSocketError((function(e){console.log("socket error",e)})),wx.onSocketClose((function(t){m.globalData.reConnectCount>50||setTimeout((function(){m.globalData.reConnectCount+=1,wx.connectSocket({url:P,header:e.webSocketHeader(),method:"GET"})}),5e3)}))},initWebsocketEvenHandlert:function(){var e=this;wx.onSocketMessage((function(t){if(console.log(t),"qa_new_content"===(t=JSON.parse(t.data)).msg_type||"qa_withdraw_content"===t.msg_type){try{j.setFilterMsg("socket_listening_temp_log"),j.info({msg:t})}catch(e){j.setFilterMsg("socket_listening_temp_log_error"),j.info({error:e})}e.checkIsLastMessageInScrollView().then((function(t){e.ajaxQA({noScroll:!t,isFromAppendContent:!0,hasReachedBottom:t})}))}"special_service_transfer_assistant"===t.msg_type&&e.setData({show_medicine_sale:!0})}))},onShareAppMessage:function(){var e="春雨医生问答分享";this.data.contents[0]&&this.data.contents[0].content[0]&&(e="春雨医生问答分享：".concat(this.data.contents[0].content[0].text));return e=e.replace(/(<([^>]+)>)/gi,""),{path:"/pages/qa_im/index?problem_id=".concat(this.data.problem_id,"&from=share&entrance_type=from_mini_share"),title:e,imageUrl:"https://staff.chunyu.mobi/@/media/images/2018/10/11/6a93/5ddfa63cb25e_w422_h338_.png"}},linkToRecDocList:function(){var e=this.data.problem_id;wx.navigateTo({url:"../rec_doc_list/index?from_type=1&problem_id="+e})},setPlayOrNot:function(){this.setData({playOrNot:!1})},uploadVoice:function(e){var t=this;t.data.ifSendVoice&&wx.request({url:I,method:"GET",data:{from_wx_mini:1},header:{Cookie:m.globalData.sessionid},success:function(a){var o=a.data.token;t.uploadFile(e,o)},fail:function(){}})},uploadFile:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"audio",i=this;console.error("upload 123123"),"video"==a&&(this.data.ready_video_list=this.data.ready_video_list.filter((function(e){e.content.file_url})),this.data.ready_video_list.push({type:"p",problem_id:i.data.problem_id,content:[{file_url:e,size:i.data.video_size,duration:i.data.video_time,type:"video",status:!1===t?"fail":"sending"}]}),this.setData({contents:[].concat(o(i.data.clearContents),o(i.data.ready_video_list))})),0!=t&&wx.uploadFile({url:"https://upload.qbox.me/",filePath:e,name:"file",formData:{token:t},success:function(t){if((t=JSON.parse(t.data)).success){var o={partner:i.data.partner,problem_id:i.data.problem_id,content:JSON.stringify([{file:t.img_url,type:a}])};"video"==a&&(o={partner:i.data.partner,problem_id:i.data.problem_id,content:JSON.stringify([{type:"video",tempPath:e,cover_image:"".concat(t.img_url,"?vframe/jpg/offset/1"),duration:i.data.video_time,file:t.img_url,size:"".concat(i.data.video_size,"MB")}])}),i.sendQuestion(o)}},fail:function(){console.error("发送失败")}})},startRecordVoice:function(e){var t=this,a=0,o=e.touches[0].clientX,i=e.touches[0].clientY,n=setInterval((function(){(a+=1)<=60?t.setData({record_time:a}):(wx.stopRecord(),t.setData({ifSendVoice:!0,record_time:0}),clearInterval(n))}),1e3);t.setData({bg:"#1da95b",audioTip_hidden:!1,audio_text:"松开结束",audio_timer:n,sxpoint:o,sypoint:i}),wx.startRecord({success:function(e){var o=e.tempFilePath;a<=4?wx.showToast({title:"语音太短，请您多说几句"}):t.uploadVoice(o)},fail:function(){wx.showToast({title:"录音失败"})}})},stopRecordVoice:function(e){var t=this.data.audio_timer,a=this.data.sxpoint,o=this.data.sypoint,i=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY,s=Math.abs(i-a),r=Math.abs(n-o);s>60||r>60?this.setData({ifSendVoice:!1}):this.setData({ifSendVoice:!0}),this.setData({bg:"#11bd4b",audioTipBg:"#11bd4b",audioTip_hidden:!0,audio_text:"按住说话",audioTipText:"手指上划，取消发送",record_time:0}),clearInterval(t),wx.stopRecord()},cancelRecordVoice:function(e){var t=this.data.sxpoint,a=this.data.sypoint,o=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY,n=Math.abs(o-t),s=Math.abs(i-a);n>60||s>60?this.setData({bg:"#e35353",audioTipBg:"#e35353",audioTipText:"手指松开，取消发送"}):this.setData({bg:"#11bd4b",audioTipBg:"#11bd4b",audioTipText:"手指上划，取消发送"})},hideToast:function(){this.setData({toast_hidden:!0})},toggleFuncArea:function(){var e=this.data.func_hidden,t=this.data.icon_selected,a=parseInt(this.data.paddingBottom),o={func_hidden:!e,audio_hidden:!0,paddingBottom:100==a||530==a?340:100,icon_selected:1==t?-1:1};"ios"==this.data.platform&&(o.footerBottom=0),this.setData(o)},generalEventBubbleCatcher:function(e){this.data.func_hidden||this.toggleFuncArea(),this.resetFloatingDialog()},resetFloatingDialog:function(){this.setData({isShowMsgOperationDialog:!1,currentShowingTranslateMenuId:""})},toggleAudioFunc:function(){var e=this.data.audio_hidden,t=this.data.icon_selected,a=parseInt(this.data.paddingBottom),o={audio_hidden:!e,func_hidden:!0,paddingBottom:100==a||340==a?530:100,icon_selected:0==t?-1:0};"ios"==this.data.platform&&(o.footerBottom=0),this.setData(o)},getFromPage:function(){return 1===Number(this.data.onloadOptions.output)&&"weixin"===this.data.onloadOptions.partner?"seo_page":this.data.onloadOptions.from},ajaxQA:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;if(!this.data.isAjaxQaPending){var o=this,i=t.noScroll||!1,n=t.isFromAppendContent||!1,r=t.manual||0,l=t.isInitiating||!1,d=t.hasReachedBottom||!1,u=this.getFromPage(),p="LAST_POSITION_QA_".concat(this.data.problem_id),_=o.data.sessionid,f=o.data.partner,g=o.data.problem_id,w=s({from_wx_mini:1,partner:f,problem_id:g,add_profile_card:1,from:u,is_new_version:1,app:"weixin_mini",version:c.productionVersion,last_position:wx.getStorageSync(p)||"",manual:r},("seo_page"===u||"similar_problem"===u)&&{from_scene:"seo_page"});m.globalData.activityPartner&&delete w.from_wx_mini;var b=wx.getStorageSync("open_id")||"",v=wx.getStorageSync("device_id")||"",x=b||v;this.data.isAjaxQaPending=!0,wx.request({url:D+"?device_id="+x,method:"GET",header:{Cookie:_},data:w,success:function(s){var c,u,_;if(e.data.isAjaxQaPending=!1,400!==s.status&&(0,h.default)({id:"qa_message_stream",hasPassed:0===s.data.error,errorMsg:"问题ID：".concat(g),extraInfo:{problem_id:g}}),0===s.data.error){if(s=s.data,e.data.reselectClinicInfo.shouldAppendClinicShow||e.setReselectClinic(s),e.setData({shouldListenToScrollElementInView:!!s.msg_read_info.not_read_count,footer:s.footer}),o.setData({userIdInfo:s.user_id_2_info,msgReadInfo:s.msg_read_info,isRefund:"r"===s.problem_detail.pay_status}),s.bottom&&s.bottom.length&&"ask_doctor"===s.bottom[0].type&&o.setData({buttonGroupRenderData:s.bottom[0]},(function(){o.getElementRec(".bottom-bottom").then((function(e){o.setData({bottomGroupHeight:e.height})})).catch((function(){}))})),t&&s.contents&&s.contents[0]&&s.contents[0].problem_id){var f,w,b,v,x={app:t&&"app"==t.from?"app":"weixin_mini",page_readable_name:"QA 详情页",problem_id:s.contents[0].problem_id};if(0===Object.keys(s.doctor_info).length)m.sensors.track("PageView",{app:x.app,page_readable_name:x.page_readable_name,problem_id:x.problem_id,first_department:"",second_department:"",is_show:"ai_chat"===(null===(f=e.data.buttonGroupRenderData.extra_type_info)||void 0===f||null===(w=f.cy_redirect)||void 0===w?void 0:w.target_type)});else m.sensors.track("PageView",{app:x.app,page_readable_name:x.page_readable_name,problem_id:x.problem_id,first_department:String(s.doctor_info.first_clinic_name),second_department:String(s.doctor_info.second_clinic_name)||String(s.doctor_info.first_clinic_name),is_show:"ai_chat"===(null===(b=e.data.buttonGroupRenderData.extra_type_info)||void 0===b||null===(v=b.cy_redirect)||void 0===v?void 0:v.target_type)})}if(null!==(c=s.pos_2_ads_info)&&void 0!==c&&c.footer&&o.setData({footer_ad:s.pos_2_ads_info.footer}),null!==(u=s.pos_2_ads_info)&&void 0!==u&&null!==(_=u.qa_toast)&&void 0!==_&&_.length)o.setData({show_popup:!0,qa_toast:s.pos_2_ads_info.qa_toast[0]});else{if(!0===o.data.show_popup)return;o.setData({show_popup:!1,qa_toast:{}})}var T=[];s.contents.forEach((function(e,t){e.random_id=Math.random().toString(36).substr(2,15),e.uniqueId=0===e.id?"".concat(e.created_time_ms):"".concat(e.id,"-").concat(e.sub_content_idx),e.content.forEach((function(t){t.random_id=Math.random().toString(36).substr(2,15),t.uniqueId=0===e.id?"".concat(e.created_time_ms,"_").concat(t):"".concat(e.id,"-").concat(e.sub_content_idx,"_sub")})),"s"==e.type&&"notice_user"==e.content[0].type&&e.content[0].text&&(T[t]=e.content[0].text,o.setData({noticeUserList:T}))})),o.setBottomButtonInfo(s),o.setData({guide:s.guide});var y=s.summary_info||{},D=s.problem_detail;o.setData({summary_info:y||!1,problem_detail:D}),o.updateContent(s);var S=(s.header||[]).filter((function(e){return"disclaimer"===e.type&&e.text}));if(o.setData({alert_info:s.alert_info,self:s.self,header:s.header,visitPageName:s.self?"个人QA详情页":"他人QA详情页"}),o.data.qaStorageKey="AUDIO_".concat(o.data.problem_id,"_").concat(o.data.self?"is_self":"not_self"),o.data.trackIndicator){var C,k;console.log(s);var I={problem_id_str:o.data.problem_id,app:"weixin_mini",page_readable_name:"QA详情页",status:s.problem_detail.click_status,service_type:s.problem_detail.is_to_doc?"定向图文":"众包图文",from_type:o.data.currentEntranceType.value,first_department:String(s.doctor_info.first_clinic_name),second_department:String(s.doctor_info.second_clinic_name)||String(s.doctor_info.first_clinic_name),is_show:"ai_chat"===(null===(C=o.data.buttonGroupRenderData.extra_type_info)||void 0===C||null===(k=C.cy_redirect)||void 0===k?void 0:k.target_type)};console.log(I),m.sensors.track("PageView",I),o.data.trackIndicator=!1}o.processRecommendDoctorAlertNew(),o.processMultipleAskDialog(s),o.processMultipleAskIndicatorBar(),o.setData({disclaimerList:S}),(1===r||!wx.getStorageSync(p)||"0,0"===wx.getStorageSync(p)&&o.data.self)&&wx.setStorageSync("LAST_POSITION_QA_".concat(o.data.problem_id),s.msg_read_info.last_position),n&&(d?e.setData({"bottomNewMessageInfo.shouldShow":!1,"bottomNewMessageInfo.count":0,"bottomNewMessageInfo.firstPosition":s.msg_read_info.first_position}):(m.sensors.track("CyC_QATagShow",{app:"weixin_mini",page_readable_name:"QA详情页",tagtype:"底部新消息提示"}),e.setData({"bottomNewMessageInfo.shouldShow":s.msg_read_info.not_read_count>0,"bottomNewMessageInfo.count":s.msg_read_info.not_read_count,"bottomNewMessageInfo.firstPosition":s.msg_read_info.first_position}))),!i&&o.data.self&&(o.scrollToBottom(),setTimeout((function(){if(l){var t=s.msg_read_info.first_position;if(t){var a="#single".concat(t.replace(",","-"));console.log(a),e.checkElementInScrollView(a).then((function(a){a?e.setData({"topNewMessageInfo.shouldShow":!1,"topNewMessageInfo.count":0,"topNewMessageInfo.firstPosition":t}):(m.sensors.track("CyC_QATagShow",{app:"weixin_mini",page_readable_name:"QA详情页",tagtype:"顶部新消息提示"}),e.setData({"topNewMessageInfo.shouldShow":s.msg_read_info.not_read_count>0,"topNewMessageInfo.count":s.msg_read_info.not_read_count,"topNewMessageInfo.firstPosition":s.msg_read_info.first_position}))})).catch((function(e){console.log(e)}))}}}),1e3)),o.generateAudioMapNew(),a&&"function"==typeof a&&a()}},fail:function(){e.data.isAjaxQaPending=!1}})}},setBottomButtonInfo:function(e){var t=this;console.log(e),e.bottom&&e.bottom.length&&"ask_doctor"===e.bottom[0].type&&this.setData({buttonGroupRenderData:e.bottom[0]},(function(){t.getElementRec(".bottom-bottom").then((function(e){t.setData({bottomGroupHeight:e.height})})).catch((function(){}))})),e.doctor_info&&e.doctor_info.price&&this.setData({"bottom_info_list.price":e.doctor_info.price,"bottom_info_list.graph":!0});var o=e.bottom[0]?e.bottom[0].type:"none",i=["edit","refunded","assess","reward","re_checkup","ask_doctor","doctor_info","phone_closed"],n=i.filter((function(e){return o===e}));n.length?i.forEach((function(e){console.log(e);var o="bottom_info_list."+e;if(n[0]===e){var i=a({},o,!0);t.setData(i)}else{var s=a({},o,!1);t.setData(s)}})):this.setData({"bottom_info_list.doctor_info":!0})},setReselectClinic:function(e){var t=this,a=e.header.filter((function(e){return"clinic"===e.type}))[0];a?(0===a.change_clinic_seconds&&this.setData({"reselectClinicInfo.change_clinic_seconds":0}),this.data.reselectClinicInfo.isFirstInitiating&&(this.setData({"reselectClinicInfo.change_clinic_seconds":a.change_clinic_seconds,"reselectClinicInfo.isFirstInitiating":!1}),this.data.reselectClinicInfo.countDownId=setInterval((function(){t.data.reselectClinicInfo.change_clinic_seconds>0&&t.setData({"reselectClinicInfo.change_clinic_seconds":t.data.reselectClinicInfo.change_clinic_seconds-1})}),1e3)),this.setData({"reselectClinicInfo.expand_clinic_list":a.expand_clinic_list,"reselectClinicInfo.indicatingText":a.text,"reselectClinicInfo.currentClinicNo":e.problem_detail.second_class_clinic_no||e.problem_detail.clinic_no||""}),a.expand_clinic_list.length>0&&m.sensors.track("CyC_QATagShow",{app:"weixin_mini",page_readable_name:"QA详情页",tagtype:"追加科室",problem_id_str:this.data.problem_id})):this.setData({"reselectClinicInfo.expand_clinic_list":[],"reselectClinicInfo.change_clinic_seconds":0})},processRecommendDoctorAlertNew:function(){var e=this,t=this.data.alert_info,a=wx.getStorageSync(this.data.problem_id);t.length&&"waiting_multiple_ask"===t[0].type?(wx.setStorageSync(this.data.problem_id,!0),this.generateMultipleAskDialog("waiting_multiple_ask"),m.sensors.track("PageView",{app:"weixin_mini",page_readable_name:"焦急等待弹窗"})):t.length&&"recommend_doctor"===t[0].type&&!a?(m.sensors.track("ActivityPOPView",{pop_title:" 首问重选医生"}),wx.showModal({title:t[0].title,content:t[0].content,cancelText:"继续等待",confirmText:"查看推荐",success:function(t){m.sensors.track("PageView",{app:"weixin_mini",page_readable_name:"焦急等待弹窗"}),t.confirm&&(wx.setStorageSync(e.data.problem_id,!0),e.setData({shouldBottomRecommendDoctorShow:!0}),m.sensors.track("AppClick",{app:"weixin_mini",click_position:"查看为我推荐的医生",page_readable_name:"焦急等待弹窗"}),wx.navigateTo({url:"/pages/re_select_doc/index?problem_id=".concat(e.data.problem_id,"&from_type=waiting_recommend")})),t.cancel&&(wx.setStorageSync(e.data.problem_id,!0),m.sensors.track("AppClick",{app:"weixin_mini",click_position:"继续等待",page_readable_name:"焦急等待弹窗"}),e.setData({shouldBottomRecommendDoctorShow:!0}))}})):0===t.length?(m.sensors.track("ActivityPOPView",{pop_title:" 重选过程首问医生回复"}),this.setData({shouldBottomRecommendDoctorShow:!1})):t.length&&"recommend_doctor"===t[0].type&&a&&this.setData({shouldBottomRecommendDoctorShow:!0})},processMultipleAskDialog:function(e){e.trigger_recommend&&this.generateMultipleAskDialog(e.trigger_recommend_type)},processMultipleAskIndicatorBar:function(){var e=this;this.data.header.forEach((function(t){"multiple_ask"===t.type&&e.setData({multiple_ask:t,shouldMultipleAskIndicatorShow:!0})}))},generateMultipleAskDialog:function(e){var t=this;wx.request({url:O,header:{Cookie:m.globalData.sessionid},data:{problem_id:this.data.problem_id,recommend_type:e,partner:"chunyu_wap_mini"},success:function(a){if(0===a.data.error_code){var o=a.data,i=o.doctors,n=o.problem_info,s=o.title,r=o.desc,c=o.recommend_id,l=o.service_list,d=o.to_clinic_services;d&&d.forEach((function(e){e.is_selected=Boolean(e.default_select)})),t.setData({multipleAskInfo:{doctors:i,problem_info:n,title:s,desc:r,type:e,recommend_id:c,service_list:l},toClinicServices:d,shouldMultipleAskDialogShow:!0})}}})},scrollToBottom:function(){console.log("scrolling"),this.setData({targetScrollAnchor:"bottom-anchor"})},updateContent:function(e){var t=this,a=this,i=e.contents.map((function(e){if(e.content[0].text&&"process_notice_user"!==e.content[0].type){var t=/<a\b[^>]+\bhref="([^"]*)"[^>]*>[\s\S]*?<\/a>/;t.test(e.content[0].text)&&(e.content[0].jump_url=t.exec(e.content[0].text)[1]),"link_notice_user"===e.content[0].type||e.content[0].text.includes("wx-mini-bridge")||(e.content[0].text=e.content[0].text.replace(/<.*?>/gi,""))}return e}));if(e.contents.length){e.contents.forEach((function(e){e.content.forEach((function(t){if("audio"==t.type)t.original_duration=t.duration,t.duration=Math.floor(t.duration/1e3),"d"===e.type&&(t.isUnread=!0);else if("video"==t.type){try{a.data.ready_video_list=a.data.ready_video_list.filter((function(e){return e.content[0].file_url!=t.tempPath}))}catch(e){console.log(e)}try{t.duration=t.duration.toString().padStart(4,"0:0")}catch(e){j.error("padStart error",{currentDuration:t.duration})}}}))})),a.data.clearContents=i;var n={contents:[].concat(o(i),o(a.data.ready_video_list))};e.doctor_info&&(n.doctor_info=e.doctor_info),e.problem_detail&&(n.problem_detail=e.problem_detail),a.setData(n)}else 1===e.error&&a.setData({error_msg:e.error_msg});this.setPageTitle(),this.data.isFirstTimeRenderContent&&(this.data.isFirstTimeRenderContent=!1,this.getElementRec(".message-main-container").then((function(e){e.height>d.QA_CONTENTS_MAX_HEIGHT?(console.log("contents reach max height"),t.setData({shouldLimitMessageMainContainerHeight:!0}),t.checkShouldLimitQaContentHeight()):console.log("contents not reach max height")})))},getElementRec:function(e){return new Promise((function(t,a){var o=wx.createSelectorQuery();o.select(e).boundingClientRect(),o.exec((function(e){return e[0]?t(e[0]):a("boundingClientRect fail")}))}))},getElementViewport:function(e){wx.createSelectorQuery().selectViewport(e).scrollOffset((function(e){console.log(e)})).exec()},checkShouldCollapseProDetail:function(){var e=this;this.getElementRec(".pro-detail").then((function(t){t.height<90&&e.setData({shouldProDetailHide:!1,isCurrentProDetailHide:!1})})).catch((function(e){console.log(e)}))},hasDoctorReplay:function(e){if(e&&e.contents)for(var t=e.contents,a=0,o=t.length;a<o;a++)if("d"===t[a].type)return!0;return!1},questionInput:function(e){var t=e.detail.value;this.setData({newQuestionText:t,hasInputed:""!=t})},playVideo:function(e){var t=encodeURIComponent(e.currentTarget.dataset.video);wx.navigateTo({url:"../video_play/index?video_src=".concat(t)})},getTokenSend:function(e){var t=e.tempFilePath,a=e.size,o=e.duration,i=this;i.data.video_size=/\./.test(a)?a:(a/1024/1024).toFixed(2),i.data.video_time=Math.round(o),wx.request({url:I,method:"GET",data:{from_wx_mini:1},header:{Cookie:m.globalData.sessionid},success:function(e){var a=e.data.token;i.uploadFile(t,a,"video")},fail:function(){wx.showToast({title:"网络断开",icon:"none",duration:5e3}),i.uploadFile(t,!1,"video"),console.error("get token error")}})},videoResend:function(e){var t=e.currentTarget.dataset,a=t.tempPath,o=t.size,i=t.time;this.getTokenSend({tempFilePath:a,size:o,duration:i})},sel_video:function(){var e=this;wx.chooseVideo({sourceType:["camera"],maxDuration:30,camera:["front","back"],compressed:!1,success:function(t){console.error({res:t});var a=t.tempFilePath;e.getTokenSend({tempFilePath:a,size:t.size,duration:t.duration})}})},selImageOrVideo:function(){var e=this;U({count:9,mediaType:["image","video"],maxDuration:30}).then((function(t){var a,o=[];t.forEach((function(e,t){"image"===e.fileType?o.push({file:e.fileUrl,type:"image"}):"video"===e.fileType&&o.push({type:"video",tempPath:e.tempFilePath,cover_image:"".concat(e.fileUrl,"?vframe/jpg/offset/1"),duration:Math.round(e.duration),file:e.fileUrl,size:"".concat((e.size/1024/1024).toFixed(2),"MB")})})),a={partner:e.data.partner,problem_id:e.data.problem_id,content:JSON.stringify(o)},e.sendQuestion(a)})).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errMsg;"format error"===t&&wx.showToast({title:"视频格式不正确，请上传mp4、mov格式的视频！",icon:"none",duration:2e3}),"duration error"===t&&wx.showToast({title:"请上传30秒以内的视频！",icon:"none",duration:2e3})}))},previewImg:function(e){var t=e.currentTarget.dataset.src,a=[];a.push(t),wx.previewImage({current:t,urls:a})},deleteQA:function(){var e={from_wx_mini:1,partner:m.globalData.partner,problem_id:this.data.problem_id};wx.showModal({title:"删除该问诊记录？",content:"删除将无法恢复",success:function(t){t.confirm&&wx.request({url:k,data:b(e),method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",Cookie:m.globalData.sessionid},success:function(){wx.showToast({title:"删除成功!",success:function(){wx.switchTab({url:"../index/index"})}})},fail:function(){}})}})},refundPrice:function(){var e=this;m.sensors.track("AppClick",{app:"weixin_mini",click_position:"退款",page_readable_name:"QA详情页",service_type:this.data.problem_detail.is_to_doc?"定向图文":"众包图文"}),this.data.problem_detail.is_to_doc?wx.navigateTo({url:"/pages/re_select_doc/index?problem_id=".concat(this.data.problem_id,"&from_type=user_reselect")}):wx.showModal({title:"退款",content:"当前医生资源紧张，退款后需要重新排队，是否确认退款？",cancelText:"我再等等",confirmText:"坚持退款",success:function(t){if(t.confirm){m.sensors.track("AppClick",{app:"weixin_mini",click_position:"继续退款",page_readable_name:"QA退款拦截弹窗"});var a=e.data.problem_id,o=e.data.partner||m.globalData.partner,i={problem_id:a,partner:o,from_wx_mini:1,is_json:1};wx.request({url:A,header:{"Content-Type":"application/x-www-form-urlencoded",Cookie:m.globalData.sessionid},method:"POST",data:b(i),success:function(){wx.navigateTo({url:"/module_a/pages/re_buy_page/re_buy_page?problem_id=".concat(a,"&partner=").concat(o,"&scene=paid_clinic")})},fail:function(){wx.showToast({title:"申请退款失败",icon:"loading"})}})}else m.sensors.track("AppClick",{app:"weixin_mini",click_position:"我再等等",page_readable_name:"QA退款拦截弹窗"})}})},requestMedicine:function(){var e={app:"weixin_mini",from_wx_mini:1,partner:this.data.partner,problem_id:this.data.problem_id,content:JSON.stringify([{type:"apply_prescription"}])};m.sensors.track("AppClick",{app:"weixin_mini",click_position:"申请开药",click_position_value:"申请开药"}),this.setData({footerBottom:0}),this.sendQuestion(e)},sendText:function(){if(this.data.newQuestionText.length){var e=[{text:this.data.newQuestionText,type:"text"}];this.data.replyArea.shouldShow&&(e[0].reference=Object.assign({},{sub_content_idx:this.data.replyArea.subContentIdx,id:this.data.replyArea.id})),console.log(e);var t={from_wx_mini:1,partner:this.data.partner,problem_id:this.data.problem_id,content:JSON.stringify(e)};this.setData({footerBottom:0}),this.sendQuestion(t)}},sendQuestion:function(e){var t=this;wx.request({url:C,method:"POST",data:b(e),header:{"Content-Type":"application/x-www-form-urlencoded",Cookie:m.globalData.sessionid},success:function(e){t.setData({newQuestionText:""}),t.clearReplyInfo(),0===e.data.error&&t.ajaxQA()}})},resetFooter:function(){var e={icon_selected:-1,paddingBottom:100,func_hidden:!0,audio_hidden:!0};"ios"==this.data.platform&&(e.footerBottom=0),this.setData(e)},jumpSendHeart:function(){getApp().sensors.track("AppClick",{app:"weixin_mini",click_position:"底部送心意",page_readable_name:"QA详情页"});var e=this.data.doctor_info;wx.navigateTo({url:"../send_heart/index?id="+e.id+"&name="+e.name+"&img="+e.image})},jumpAd:function(e){var t=e.currentTarget.dataset.url,a=e.currentTarget.dataset.btnType;if(t){t.startsWith("/pages/")?wx.navigateTo({url:t,fail:function(e){e.errMsg.match(/can not navigateTo a tabbar page/)&&wx.switchTab({url:t})}}):wx.navigateTo({url:"/pages/h5_webview/index?url="+t});var o=this.data.problem_detail;T("ActivityClick",{activity_name:"小程序广告位点击",problem_id_str:o.id,platform_source:m.globalData.partner,souce_type:"QA详情页",first_department:o.clinic_name,second_department:o.second_class_clinic_no,btn_type:a})}},jumpH5:function(e){var t=e.currentTarget.dataset.url;t&&(t=encodeURIComponent(t),wx.navigateTo({url:"../h5_webview/index?url="+t}))},ad_Jump:function(e){var t=e.currentTarget.dataset.onetype,a=e.currentTarget.dataset.weixin,o=e.currentTarget.dataset.url,i=e.currentTarget.dataset.button,n=e.currentTarget.dataset.adTitle,s=e.currentTarget.dataset.adId;"true"==i?(m.sensors.track("AdClick",{app:this.data.options&&"app"===this.data.options.from?"0":"weixin_mini",ad_position:"ADQA命中问题底部banner点击",ad_title:n,ad_id:s}),"weixin_mini"===t?wx.navigateTo({url:a}):wx.redirectTo({url:"/pages/h5_webview/index?url=".concat(encodeURIComponent(o))})):(m.sensors.track("AdClick",{app:this.data.options&&"app"===this.data.options.from?"0":"weixin_mini",ad_position:"ADQA命中问题文字链广告点击",ad_title:n,ad_id:s}),"weixin_mini"===t?wx.navigateTo({url:a}):wx.redirectTo({url:"/pages/h5_webview/index?url=".concat(encodeURIComponent(o))}))},jumpDocTopic:function(e){var t=e.currentTarget.dataset.id;wx.navigateTo({url:"/pages/doctor_topic_general_page/doctor_topic_general_page?id=".concat(t,"&topic_type=topic&from_visit_page=").concat(this.data.visitPageName)})},jumpHealthRecord:function(e){var t=e.currentTarget.dataset.url;t&&wx.navigateTo({url:"/pages/h5_webview/index?url=".concat(encodeURIComponent(t))})},jumpSummary:function(e){var t=encodeURIComponent(e.currentTarget.dataset.url);t&&wx.navigateTo({url:"../summary/index?url="+t})},selectImgAns:function(e){this.setData({jump_url:e.currentTarget.dataset.url,img_display:"show",free_display:"hide"})},selectFreeAns:function(e){this.setData({jump_url:e.currentTarget.dataset.url,img_display:"hide",free_display:"show"})},answerNew:function(){var e,t=this.data.doctor_info;-1==t.price?(this.setData({no_img_ans:"show",has_img_ans:"hide",display:"show",free_display:"show"}),e="../inquery/inquery?from_page=fast_qa","立即咨询"==this.data.btn_text?wx.navigateTo({url:e}):this.setData({btn_text:"立即咨询",display:"show"})):(this.setData({no_img_ans:"hide",has_img_ans:"show",display:"show"}),e=this.data.jump_url?this.data.jump_url:"../payment/index?name=".concat(t.name,"&price=").concat(t.price,"&hospital=").concat(t.hospital_name,"&id=").concat(t.id,"&title=").concat(t.title,"&mark=finddoc"),"立即咨询"==this.data.btn_text?wx.navigateTo({url:e}):this.setData({btn_text:"立即咨询",display:"show"}))},consoleAnswer:function(){this.setData({btn_text:"我要问医生",display:"hide",no_img_ans:"hide",has_img_ans:"hide"})},onChangeClinic:function(){this.timer.pause()},onConfirmClinic:function(){var e=this;e.timer.pause(),e.setData({showClinicAdjustment:!1}),e.sendClinicChangeRequest({action:"change_abort",success:function(){e.sendSystemClinicChangeRequest()}})},pickerClinicSelected:function(e){this.timer.pause(),this.setData({showClinicAdjustment:!1}),this.sendClinicChangeRequest({action:"change_confirm",fail:function(e){wx.showModal({content:e,showCancel:!1})}})},pickerClinicCancel:function(e){this.timer.pause(),this.setData({showClinicAdjustment:!1}),this.sendClinicChangeRequest({action:"change_abort"})},clinicColumnChange:function(e){if(0===e.detail.column){var t=e.detail.value;this.setData({multiArray:[J,J[t].children],multiIndex:[t,0]})}},getClinic:function(){var e=this,t=e.data.partner;y({url:"/cooperation/wap/clinic_no_list/?partner="+t,success:function(t){var a=t.data,o=e.data.clinicNo,i=e.data.clinicSecondNo;if(Array.isArray(a)){var n=(J=a.map((function(e){return{id:e.clinic_no,name:e.clinic_name,children:(e.second_class_clinics||[]).map((function(e){return{id:e.clinic_no,name:e.clinic_name}}))}}))).findIndex((function(e){return e.id===o})),s=J[n=-1===n?0:n].children,r=s.findIndex((function(e){return e.id===i}));r=-1===r?0:r,e.setData({multiArray:[J,s],multiIndex:[n,r]}),e.showChooseClinic()}}})},showChooseClinic:function(){var e=this;e.setData({showClinicAdjustment:!0}),e.timer=new v(e.data.timerCount,1e3,(function(){e.sendClinicChangeRequest({action:"change_abort",success:function(){e.sendSystemClinicChangeRequest()}}),e.setData({showClinicAdjustment:!1})}),(function(t){e.setData({timerCount:t})})),e.timer.start()},sendClinicChangeRequest:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.action,a=void 0===t?"change_start":t,o=e.success,i=void 0===o?function(){}:o,n=e.fail,s=void 0===n?function(){}:n,r=this.data.multiIndex,c=J[r[0]],l=c&&(c.children[r[1]].id||c.id);y({url:"/cooperation/wap/problem/".concat(this.data.problem_id,"/user_change_clinic/"),method:"POST",data:{partner:this.data.partner,action:a,to_clinic_no:l},success:function(e){var t=e.data||{};t.success?i():s(t.error_msg)},complete:function(){wx.setNavigationBarTitle({title:"问题详情"})}})},sendSystemClinicChangeRequest:function(){y({url:"/cooperation/wap/problem/".concat(this.data.problem_id,"/confirm_clinic/"),method:"POST",data:{partner:this.data.partner},complete:function(){wx.setNavigationBarTitle({title:"问题详情"})}})},doPointAsk:function(){T("AppClick",{click_position:"qa详情页-立即咨询",platform_source:"weixin_mini"})},doPointAssess:function(e){m.sensors.track("AppClick",{app:"weixin_mini",click_position:"图文评价",page_readable_name:"QA详情页",status:"已关闭",problem_id_str:this.data.problem_id}),this.setData({shouldGeneralPageContainerShow:!0,"feedbackInfo.shouldFeedbackShow":!0,"feedbackInfo.fromType":e.currentTarget.dataset.fromType||"QaBottom"})},doFollowDoctor:function(){var e=this,t=e.data.doctor_info.id,a=e.data.has_followed,o={from_wx_mini:1,partner:m.globalData.partner,follow:a?0:1};!a&&wx.navigateTo({url:"../doc_mainpage/index?doc_id=".concat(t,"&animation=").concat(a?"unfollow":"follow","&from_visit_page=").concat(this.data.visitPageName)});!a&&T("AppClick",{click_position:"qa详情页-关注医生",platform_source:"weixin_mini"}),wx.request({url:M+t+"/follow",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",Cookie:m.globalData.sessionid},data:b(o),success:function(){e.setData({has_followed:!a})},fail:function(){}})},openMsgOperationDialog:function(e){console.log(e),console.log("long pressed"),this.setData({longPressedMessageId:e.currentTarget.dataset.item.random_id,nowTime:Date.parse(new Date),isShowMsgOperationDialog:!0})},savePhoto:(t=n(i.default.mark((function e(t){var a,o,n,s,r,c,l;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=t.detail.messageInfo||{},o=a.content,s=(n=void 0===o?[]:o).length&&n[0]||{},r=s.type,c=s.file,"video"!==r){e.next=10;break}return e.next=8,G(c);case 8:e.next=13;break;case 10:if("image"!==r){e.next=13;break}return e.next=13,V(c);case 13:this.setData({isShowMsgOperationDialog:!1}),l={app:"weixin_mini",click_position:"保存至相册",page_readable_name:"QA详情页"},m.sensors.track("AppClick",l),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.log("savePhoto",e.t0);case 21:case"end":return e.stop()}}),e,this,[[0,18]])}))),function(e){return t.apply(this,arguments)}),copy:function(e){var t=(e.detail.messageInfo||{}).content,a=void 0===t?[]:t,o=a.length&&a[0].text;o=this.getSimpleText(o),console.log("copyText",o),wx.setClipboardData({data:o||"",success:function(e){wx.getClipboardData({success:function(e){console.log(e.data)}})}}),this.setData({isShowMsgOperationDialog:!1})},draw:function(e){var t=this,a=e.detail.messageInfo||{},o=a.content,i=void 0===o?[]:o,n=a.id,s=i.length&&i[0].action_info||{};if("forbidden"===s.status)return wx.showToast({title:s.toast,icon:"none",duration:1500}),void t.setData({isShowMsgOperationDialog:!1});Date.parse(new Date)-t.data.nowTime>12e4?wx.showToast({title:"超2分钟消息不能撤回",icon:"none",duration:1500}):wx.request({url:N,header:{"Content-Type":"application/json",Cookie:m.globalData.sessionid},data:{partner:m.globalData.partner,problem_id:t.data.problem_id,content_id:n,idx:s.idx},success:function(e){t.ajaxQA(),""!==e.data.error_msg&&wx.showToast({title:e?e.data.error_msg:"撤回失败",icon:"none",duration:1500})}})},reEdit:function(e){var t=e.currentTarget.dataset.item;t.action_info&&Date.parse(new Date)<t.action_info.expire_time_ms?(t.reference&&t.reference.id&&this.processReplyToInputArea(t.reference),this.setData({hasInputed:!0,newQuestionText:this.data.newQuestionText+=t.action_info.origin})):this.ajaxQA()},wxParseTagATap:function(e){var t=e.currentTarget.dataset.src;t&&(t=encodeURIComponent(t),wx.navigateTo({url:"../h5_webview/index?url="+t}))},onFollowSuccess:function(){this.setData({has_followed:!0})},showAllContent:function(){this.data.isSeoPage&&m.sensors.track("AppClick",{app:"weixin_mini",page_readable_name:"QA详情页",click_position:"展开更多记录",scene_type:"SEO输出"}),this.setData({shouldLimitQaContentHeight:!1})},updateStatus:function(e){console.log(e.detail),"doctor"===e.detail.type&&this.setData({hasRecommendDoctor:e.detail.status}),"topic"===e.detail.type&&this.setData({hasRecommendTopic:e.detail.status}),this.checkShouldLimitQaContentHeight()},checkShouldLimitQaContentHeight:function(){"v2"!==this.data.pageType&&"native_search"!==this.data.pageType||!this.data.shouldLimitMessageMainContainerHeight||(console.log(this.data.pageType),console.log(this.data.shouldLimitMessageMainContainerHeight),this.setData({shouldLimitQaContentHeight:!0}))},tapOnInput:function(){return!1},beforeChoosePdf:function(){var e=this;wx.showModal({content:"小程序中仅支持上传微信聊天内容中的文件",confirmText:"我知道了",success:function(t){t.confirm&&e.choosePdf()}})},choosePdf:function(){var e=this;wx.chooseMessageFile({count:1,type:"file",success:function(t){if(console.log(t),t.tempFiles.length){var a=t.tempFiles[0],o=a.name,i=(Number(a.size)/1e3).toFixed();/^.+\.([pP][dD][fF])$/.test(a.path)?i<5e4?(wx.showLoading({title:"上传中..."}),z().then((function(t){W(t,a.path).then((function(t){var a=t.fileUrl;e.sendPdf(a,o,i)})).catch((function(e){wx.showToast({title:"上传失败，请稍后重试",icon:"none"})}))}))):wx.showToast({title:"上传失败，文件大小不能超过50M",icon:"none"}):wx.showToast({title:"上传失败，只能上PDF格式文件",icon:"none"})}}})},sendPdf:function(e,t,a){var o=this;wx.request({url:C,method:"POST",data:b({from_wx_mini:1,partner:this.data.partner,problem_id:this.data.problem_id,content:JSON.stringify([{type:"file",file:e,file_type:"pdf",size:"".concat(a,"KB"),file_name:t}])}),header:{"Content-Type":"application/x-www-form-urlencoded",Cookie:m.globalData.sessionid},success:function(e){0===e.data.error?(wx.showToast({title:"上传成功"}),o.ajaxQA()):wx.showToast({title:"发送消息失败",icon:"none"})},fail:function(e){wx.showToast({title:"上传失败，请稍后重试",icon:"none"})}})},downloadFile:function(e){var t=e.detail.messageInfo.content[0];console.log(t),wx.downloadFile({url:t.file,success:function(e){wx.getFileSystemManager().saveFile({tempFilePath:e.tempFilePath,success:function(e){wx.showToast({title:"文件下载成功",icon:"none"})}})}})},previewPdf:function(e){var t=e.currentTarget.dataset.url;wx.downloadFile({url:t,success:function(e){wx.openDocument({filePath:e.tempFilePath,showMenu:!0,fileType:"pdf"})}})},onTapMultipleAskButton:function(){this.generateMultipleAskDialog("multiple_ask_guide")},onTapMultipleAskButtonFromBottomButton:function(){this.generateMultipleAskDialog("user_self_click")},handleCloseDialog:function(){this.setData({shouldMultipleAskDialogShow:!1})},onScroll:function(e){this.calculateTopHeightDisplay(e),this.calculateShouldTapToBottomShow(e),this.checkBottomNewMessageInScrollView(),this.checkTopNewMessageInScrollView()},checkTopNewMessageInScrollView:function(){var e=this;if(!(this.data.topNewMessageInfo.count<=0)&&this.data.topNewMessageInfo.firstPosition&&this.data.self&&this.data.topNewMessageInfo.shouldShow){var t="",a="",o="",i=this.data.topNewMessageInfo.firstPosition.replace(",","-"),n="#single".concat(i);this.getElementRec("#scroll-view").then((function(i){a=i.top,o=i.bottom,e.getElementRec(n).then((function(i){(t=i.top)>a-20&&t<o?(console.log("in"),e.ajaxQA({noScroll:!0,manual:1}),e.setData({"topNewMessageInfo.shouldShow":!1,"topNewMessageInfo.count":0})):console.log("out")}))}))}},calculateTopHeightDisplay:function(e){var t=this.data.currentEntranceType.value,a=this.data.entranceTypes;if(t===a.seo.value||t===a.seo_similar_problem.value||"native_search"===this.data.pageType){var o=this.data.lastScrollTop,i=e.detail.scrollTop;i>o&&i>20&&!this.data.scrollBreakPoint&&this.setData({isSeoTitleDoctorMiniCard:!0,shouldHideProDetail:!0}),this.data.lastScrollTop=i}else if([a.home_search.value,a.app_share.value,a.mini_share.value].indexOf(t)>-1){var n=this.data.lastScrollTop,s=e.detail.scrollTop;s>n&&s>20&&!this.data.scrollBreakPoint&&this.setData({isMiniCardOriginalTitleDoctor:!0})}},calculateShouldTapToBottomShow:function(e){var t=this;this.data.self&&this.getElementRec("#scroll-view").then((function(a){var o=t.data.lastScrollTop,i=e.detail.scrollTop,n=a.height;i>e.detail.scrollHeight-n-t.data.tapToBottomInfo.scrollBufferPx?t.setData({"tapToBottomInfo.shouldTapToBottomContainerShow":!1}):i<=o&&t.setData({"tapToBottomInfo.shouldTapToBottomContainerShow":!0}),t.data.lastScrollTop=i}))},onSeoTitleExpand:function(){this.setData({shouldHideProDetail:!1})},seoTitleDoctorShowMore:function(){var e=this;this.data.scrollBreakPoint=!0,this.setData({isSeoTitleDoctorMiniCard:!1,shouldHideProDetail:!1}),setTimeout((function(){e.data.scrollBreakPoint=!1}),200)},onOriginalTitleDoctorShowLess:function(){var e=this;this.data.scrollBreakPoint=!0,this.setData({isMiniCardOriginalTitleDoctor:!0}),setTimeout((function(){e.data.scrollBreakPoint=!1}),200)},originTitleDoctorShowMore:function(){this.setData({isMiniCardOriginalTitleDoctor:!1})},onClickDoctorAvatar:function(){m.sensors.track("AppClick",{app:"weixin_mini",click_position:"医生头像",page_readable_name:"QA详情页"}),wx.navigateTo({url:"/pages/doc_mainpage/index?doc_id=".concat(this.data.doctor_info.id,"&problem_id=").concat(this.data.problem_id,"&intention=").concat(this.data.doctor_info.cy_redirect.param.intention,"&from_visit_page=").concat(this.data.visitPageName)})},onTapBottomRecommendDoctor:function(){m.sensors.track("AppClick",{app:"weixin_mini",click_position:"绿条",page_readable_name:"焦急等待弹窗"})},getNewUserToDoc:function(){var e=this;wx.request({url:q,method:"GET",header:{"Content-Type":"application/json",Cookie:m.globalData.sessionid},data:{doctor_id:this.data.doctor_info.id},success:function(t){var a=t.data.data,o=a.is_login,i=a.is_doc_coupon_active,n=a.to_doc_user;e.setData({"buttonGroupRenderData.show_discont_badge":i&&(o&&n||!o&&e.data.dayFristVisit)})},fail:function(e){j.setFilterMsg("新用户三期"),j.error("请求地址:".concat(q," 原因:").concat(e.errMsg," 失败码:").concat(e.errno||"无"))}})},replyMessage:function(e){var t=this,a=e.detail.messageInfo;console.log(a);var o=this.data.userIdInfo[a.user_id].alias,i=function(a,i,n){t.setData({"replyArea.shouldShow":n,"replyArea.content":o+"："+i,"replyArea.type":a,"replyArea.id":e.detail.messageInfo.id,"replyArea.subContentIdx":e.detail.messageInfo.sub_content_idx,isInputFocus:!0,func_hidden:!0})};switch(a.content[0].type){case"text":i("text",a.content[0].text,!0);break;case"image":i("image","[图片]",!0);break;case"audio":i("audio","[语音]",!0);break;case"file":i("file","[文件] ".concat(a.content[0].file_name),!0);break;case"video":i("video","[视频]",!0);break;case"dicom":i("dicom","[文件] ".concat(a.content[0].file_name),!0);break;default:return}},clearReply:function(){this.setData({"replyArea.shouldShow":!1,"replyArea.content":""})},clearReplyInfo:function(){this.setData({"replyArea.shouldShow":!1,"replyArea.content":"","replyArea.type":"","replyArea.id":"","replyArea.subContentIdx":""})},scrollToReply:function(e){var t=this;this.setData({targetScrollAnchor:"single".concat(e.detail.replyId)},(function(){t.setData({currentFlickerMessageId:"single".concat(e.detail.replyId)},(function(){setTimeout((function(){t.setData({currentFlickerMessageId:""})}),1e3)}))}))},processReplyToInputArea:function(e){var t=this,a=this.data.userIdInfo[e.user_id].alias,o=function(o,i,n){t.setData({"replyArea.shouldShow":n,"replyArea.content":a+"："+i,"replyArea.type":o,"replyArea.id":e.id,"replyArea.subContentIdx":e.sub_content_idx,func_hidden:!0,isInputFocus:!0})};switch(e.content[0].type){case"text":o("text",e.content[0].text,!0);break;case"image":o("image","[图文]",!0);break;case"audio":o("audio","[语音]",!0);break;case"file":o("file","[文件] ".concat(e.content[0].file_name),!0);break;case"video":o("video","[视频]",!0);break;case"dicom":o("dicom","[文件] ".concat(e.content[0].file_name),!0);break;default:return}},onMpHtmlLinkTap:function(e){var t=e.detail.href;if(t)if(t.includes("service_history"))wx.navigateTo({url:"/pages/doctor_history_list/doctor_history_list?doctor_id=".concat(this.data.doctor_info.id,"&from_visit_page=").concat(this.data.visitPageName)});else if(t.includes("/wx-mini-bridge/")){this.data.isSeoPage&&m.sensors.track("AppClick",{app:"weixin_mini",click_position:"QA飘红",scene_type:"SEO输出",page_readable_name:"QA详情页"});var a=x("query",t);a&&wx.navigateTo({url:"/pages/home_search/index?query=".concat(a,"&from_visit_page=").concat(this.data.visitPageName,"&from_type=click_qa")})}else if(t.includes("problem_detail")){var o=JSON.parse(decodeURIComponent(t).slice(14));wx.navigateTo({url:"/pages/qa_im/index?problem_id=".concat(o.param.problem_id,"&from_visit_page=").concat(this.data.visitPageName)})}else wx.navigateTo({url:"/pages/h5_webview/index?url=".concat(encodeURIComponent(t))})},previewDicom:function(e){var t=e.currentTarget.dataset.dicomData,a="/pages/dicom_view/dicom_view?file_url=".concat(encodeURIComponent(t.file),"&verify_code=").concat(t.verify_code||"");wx.navigateTo({url:a})},uploadDicom:function(){m.sensors.track("AppClick",{app:"weixin_mini",click_position:"上传医学影像材料",page_readable_name:"QA详情页"});var e=g+"/v-m-general/dicom-upload?problem_id=".concat(this.data.problem_id,"&from_type=qa");wx.navigateTo({url:"/pages/h5_webview/index?url=".concat(encodeURIComponent(e))})},handleAudioStart:function(e){var t=this,a=e.detail.audioId;this.data.contents.filter((function(e){return"audio"===e.content[0].type})).forEach((function(e){e.id!==a&&t.selectComponent(".audio".concat(e.id)).forcePause()}))},playAudioInOrder:function(e){var t=e.detail.audioId,a=this.data.contents.filter((function(e){return"audio"===e.content[0].type&&"d"===e.type})),o=a.findIndex((function(e){return e.id===t}));console.log(o);for(var i=o+1;i<=a.length-1;i++)if(a[i]&&a[i].id){var n=a[i].id;if(this.data.audioInfoMap[n]&&this.data.audioInfoMap[n].isUnread){this.selectComponent(".audio".concat(n)).forceStart();break}}},syncLocalAudioDataToStorage:function(){wx.setStorageSync(this.data.qaStorageKey,this.data.audioInfoMap)},setMessageRead:function(e){var t=e.detail.audioId,o="audioInfoMap.".concat(t,".isUnread");this.setData(a({},o,!1)),this.syncLocalAudioDataToStorage()},translate:function(e){var t,o=this;console.log(e);var i=e.detail.messageInfo||e.currentTarget.dataset.messageInfo,n={app:"weixin_mini",click_position:(null===(t=e.detail)||void 0===t?void 0:t.fromMessageOperator)?"长按转文字":"外露转文字",click_position_value:String(i.content[0].duration),page_readable_name:"QA详情页"};if(console.log(n),m.sensors.track("AppClick",n),!i.shouldTranslateShow){var s=function(e){if(e.confirm){var t;"d"===i.type&&o.setMessageRead({detail:{audioId:i.id}});var n="audioInfoMap.".concat(i.id,".shouldTranslateShow"),s="audioInfoMap.".concat(i.id,".translateText");o.setData((a(t={},n,!0),a(t,s,"转换中"),t)),o.syncLocalAudioDataToStorage(),o.translateAudio(i)}};this.data.shouldHideTranslateDialog?s({confirm:!0}):wx.showModal({content:"语音转文字仅支持普通话，转换结果仅供参考",showCancel:!1,success:s}),wx.setStorageSync("shouldHideTranslateDialog",!0),this.data.shouldHideTranslateDialog=!0}},showTranslateMenu:function(e){var t=e.currentTarget.dataset.menuId;this.setData({currentShowingTranslateMenuId:t})},hideTranslateContent:function(e){m.sensors.track("AppClick",{app:"weixin_mini",click_position:"隐藏",page_readable_name:"QA详情页"});var t=e.currentTarget.dataset.audioId,o="audioInfoMap.".concat(t,".shouldTranslateShow");this.setData(a({},o,!1))},copyTranslateToClipboard:function(e){m.sensors.track("AppClick",{app:"weixin_mini",click_position:"复制-转文字",page_readable_name:"QA详情页"});var t=this.getSimpleText(e.currentTarget.dataset.content);wx.setClipboardData({data:t})},getSimpleText:function(e){return e=(e=(e=(e=(e=e.replace(/\s*/g,"")).replace(/<[^>]+>/g,"")).replace(/↵/g,"")).replace(/[\r\n]/g,"")).replace(/&nbsp;/g,""),e=this.convertIdeogramToNormalCharacter(e)},convertIdeogramToNormalCharacter:function(e){var t={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return e.replace(/&(lt|gt|nbsp|amp|quot);/gi,(function(e,a){return t[a]}))},_getMessageIndex:function(e){return this.data.contents.findIndex((function(t){return t.id===e}))},translateAudio:function(e){var t=e.content[0].file,a=e.content[0].original_duration,o={url:Q,method:"POST",data:{url:t,duration:a,cy_sign:e.content[0].cy_sign}};this._audioTranslatePoll(o,e.id)},_audioTranslatePoll:function(e,t){var o=this,i=0,n=setInterval((function(){if((i+=1)>20){clearInterval(n);var r="audioInfoMap.".concat(t,".translateText");o.setData(a({},r,"转文字失败"))}else(0,_.default)(s(s({},e),{},{success:function(e){if(console.log(e),200!==e.statusCode){clearInterval(n);var i="audioInfoMap.".concat(t,".translateText");o.setData(a({},i,e.data.error_msg)),o.syncLocalAudioDataToStorage()}else if(e.data.error_msg||"success"!==e.data.status)"failed"===e.data.status&&(clearInterval(n),wx.showToast({title:e.data.error_msg}));else{clearInterval(n);var s="audioInfoMap.".concat(t,".translateText");o.setData(a({},s,e.data.text||"转文字失败，语音无实质内容")),o.syncLocalAudioDataToStorage()}}}))}),2e3);this.allPullIds[n]=!0},clearAllPolling:function(){Object.keys(this.allPullIds).forEach((function(e){clearInterval(e)}))},tapOnAudioContainer:function(e){var t=this,a=e.currentTarget.dataset.content;this.data.contents.filter((function(e){return"audio"===e.content[0].type})).map((function(e){return e.id})).forEach((function(e){e===a.id?t.selectComponent(".audio".concat(a.id)).togglePlay():t.selectComponent(".audio".concat(e)).forcePause()}))},generateAudioMapNew:function(){var e=this;new Date(this.data.problem_detail.created_time)>p.audioCheckPointDate&&this.setData({isNewVersionAudio:!0});var t=this.data.contents.filter((function(e){return"audio"===e.content[0].type})),o=wx.getStorageSync(this.data.qaStorageKey)||{};for(var i in t.forEach((function(t){if(!e.data.audioInfoMap[t.id]){var o,i="audioInfoMap.".concat(t.id,".isUnread"),n="audioInfoMap.".concat(t.id,".shouldTranslateShow"),s="audioInfoMap.".concat(t.id,".translateText");e.setData((a(o={},i,!0),a(o,n,!1),a(o,s,""),o))}})),o){var n="audioInfoMap.".concat(i,".isUnread");this.setData(a({},n,o[i].isUnread))}},handleClickFeedback:function(e){this.setData({"feedbackInfo.defaultValue":e.detail.value,shouldGeneralPageContainerShow:!0,"feedbackInfo.shouldFeedbackShow":!0,"feedbackInfo.fromType":"Qa是否解决入口"})},leaveGeneralPageContainer:function(){var e=this;this.setData({shouldGeneralPageContainerShow:!1}),this.ajaxQA({noScroll:!0}),setTimeout((function(){e.setData({"feedbackInfo.shouldFeedbackShow":!1,"reselectClinicInfo.shouldAppendClinicShow":!1})}),500)},handleFeedbackDetailClose:function(){this.setData({"feedbackInfo.shouldFeedbackShow":!1})},toggleClinicSelector:function(e){this.setData({"reselectClinicInfo.shouldClinicSelectorShow":e.detail.shouldShow}),e.detail.shouldShow||this.syncReselectAction("change_abort")},openClinicSelector:function(){var e=this;m.sensors.track("AppClick",{app:"weixin_mini",click_position:"重选科室",page_readable_name:"QA详情页",problem_id_str:this.data.problem_id}),this.syncReselectAction("change_start").then((function(){e.setData({"reselectClinicInfo.shouldClinicSelectorShow":!0})})).catch((function(t){wx.showToast({title:t.data.error_msg||"已有医生接诊",icon:"none"}),e.ajaxQA({noScroll:!0})}))},confirmClinic:function(e){this.data.reselectClinicInfo.reselectClinicListObj=e.detail.clinicObj,this.syncReselectAction("change_confirm")},openAppendClinicSelector:function(){m.sensors.track("AppClick",{app:"weixin_mini",click_position:"追加科室",page_readable_name:"QA详情页",problem_id_str:this.data.problem_id}),this.setData({shouldGeneralPageContainerShow:!0,"reselectClinicInfo.shouldAppendClinicShow":!0})},checkBottomNewMessageInScrollView:function(){var e=this;if(this.data.bottomNewMessageInfo.firstPosition&&this.data.self&&"c"!==this.data.problem_detail.status&&this.data.shouldListenToScrollElementInView){var t="",a="",o="",i=this.data.bottomNewMessageInfo.firstPosition.replace(",","-"),n="#single".concat(i);console.log(n),this.getElementRec("#scroll-view").then((function(i){a=i.top,o=i.bottom,e.getElementRec(n).then((function(i){(t=i.top)>a-10&&t<o?(e.ajaxQA({noScroll:!0,isFromAppendContent:!1,manual:1}),e.setData({"bottomNewMessageInfo.shouldShow":!1,"bottomNewMessageInfo.count":0})):console.log("out")}))}))}},syncReselectAction:function(e){var t=this,a="".concat(g,"/cooperation/wap/problem/").concat(this.data.problem_id,"/user_change_clinic/");return new Promise((function(o,i){({change_start:function(){(0,_.default)({url:a,method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:{action:e,partner:"chunyu_wap_mini"},success:function(t){return console.log(e+" success"),t.data.success?o(t):(wx.showToast({title:t.data.error_msg,icon:"none"}),i())}})},change_abort:function(){(0,_.default)({url:a,method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:{action:e,partner:"chunyu_wap_mini"},success:function(t){return console.log(e+" success"),t.data.success?o():(wx.showToast({title:t.data.error_msg,icon:"none"}),i())}})},change_confirm:function(){(0,_.default)({url:a,method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:{action:e,partner:"chunyu_wap_mini",to_clinic_no:t.data.reselectClinicInfo.reselectClinicListObj.clinic_no},success:function(a){return console.log(a),console.log(e+" success"),a.data.success?(t.ajaxQA({noScroll:!0}),o()):(wx.showToast({title:a.data.error_msg,icon:"none"}),i())}})}})[e]()}))},confirmAppendClinic:function(e){var t=this,a=e.detail.clinicList;console.log(a.map((function(e){return String(e.clinic_no)}))),(0,_.default)({url:B,method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:{problem_id:this.data.problem_id,clinic_no:this.data.reselectClinicInfo.currentClinicNo,type:"confirm",clinic_no_list:JSON.stringify(a.map((function(e){return String(e.clinic_no)}))),partner:"chunyu_wap_mini"},success:function(e){console.log(e),0===e.data.error_code?(t.setData({"reselectClinicInfo.shouldAppendClinicShow":!1,shouldGeneralPageContainerShow:!1}),t.ajaxQA({noScroll:!0})):(wx.showToast({title:e.data.error_msg,icon:"none"}),t.setData({"reselectClinicInfo.shouldAppendClinicShow":!1,shouldGeneralPageContainerShow:!1}),t.ajaxQA({noScroll:!0}))}})},cancelAppendClinic:function(e){var t=this,a=e.detail.clinicList;m.sensors.track("AppClick",{app:"weixin_mini",click_position:"不追加",page_readable_name:"追加相近科室",click_position_value:JSON.stringify(a.map((function(e){return String(e.clinic_no)}))),clinic:this.data.reselectClinicInfo.currentClinicNo,problem_id_str:this.data.problem_id});wx.showModal({title:"确认不追加？",content:"选择不追加，医生接诊速度可能变慢，且后续无法再次追加，确认继续操作？",success:function(e){e.confirm?(0,_.default)({url:B,method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:{problem_id:t.data.problem_id,clinic_no:t.data.problem_detail.second_class_clinic_no||t.data.problem_detail.clinic_no||"",type:"abort",partner:"chunyu_wap_mini"},success:function(e){console.log(e),wx.showToast({title:e.data.error_msg,icon:"none"}),t.setData({"reselectClinicInfo.shouldAppendClinicShow":!1,shouldGeneralPageContainerShow:!1})}}):m.sensors.track("AppClick",{app:"weixin_mini",click_position:"取消",page_readable_name:"确定不追加弹窗",problem_id_str:t.data.problem_id})}})},onMpHtmActionTap:function(e){var t=this;console.log(e);var a=e.currentTarget.dataset.dialog,o=e.currentTarget.dataset.clickinfo;o.show&&m.sensors.track("AppClick",s({app:"weixin_mini"},o.show));var i=function(){var a=e.currentTarget.dataset.actionIndex,o=t.data.contents[a].content[0].request_info;(0,_.default)({url:"".concat(g,"/").concat(o.url),method:o.method,data:o.data,success:function(e){t.ajaxQA({noScroll:!0}),e.data.error_msg&&wx.showToast({title:e.data.error_msg,icon:"none"})}})};a?wx.showModal({title:a.title,content:a.content,success:function(e){e.confirm?i():o.cancel&&m.sensors.track("AppClick",s({app:"weixin_mini"},o.cancel))}}):i()},goAssess:function(){this.setData({shouldGeneralPageContainerShow:!0,"feedbackInfo.shouldFeedbackShow":!0,"feedbackInfo.fromType":"guide_tip"})},scrollTopNewMessage:function(){getApp().sensors.track("AppClick",{app:"weixin_mini",click_position:"顶部新消息提示",page_readable_name:"QA详情页"});var e=this.data.topNewMessageInfo.firstPosition.replace(",","-"),t="single".concat(e);this.setData({targetScrollAnchor:t})},scrollBottomNewMessage:function(){getApp().sensors.track("AppClick",{app:"weixin_mini",click_position:"底部新消息提示",page_readable_name:"QA详情页"});var e=this.data.bottomNewMessageInfo.firstPosition.replace(",","-"),t="single".concat(e);this.setData({targetScrollAnchor:t})},setSendHeartOkInfo:function(){var e={graph:{id:this.data.problem_id,type:"graph"}};wx.setStorageSync("SEND_HEART_INFO",e.graph)},closeTapToTopIndicator:function(){this.setData({shouldTapToTopIndicatorHide:!0}),wx.setStorageSync("QA_SHOULD_TAP_TO_TOP_INDICATOR_HIDE",!0)},oneTapToBottom:function(){var e=this;getApp().sensors.track("AppClick",{app:"weixin_mini",click_position:"一键置底",page_readable_name:"QA详情页"});var t=this.data.topNewMessageInfo.firstPosition;if(console.log(t),t){var a="#single".concat(t.replace(",","-"));this.getElementRec("#scroll-view").then((function(t){var o=t.bottom;e.getElementRec(a).then((function(t){t.top>=o?(e.ajaxQA({noScroll:!0,manual:1}),e.setData({"topNewMessageInfo.shouldShow":!1,"topNewMessageInfo.count":0,targetScrollAnchor:"bottom-anchor"})):e.setData({targetScrollAnchor:"bottom-anchor"})}))}))}else this.setData({targetScrollAnchor:"bottom-anchor"})},handleScrollToLower:function(){this.setData({"tapToBottomInfo.shouldTapToBottomContainerShow":!1})},checkIsLastMessageInScrollView:function(){var e=this;return new Promise((function(t,a){var o="",i="",n="",s="";console.log("#content-bottom"),e.getElementRec("#scroll-view").then((function(r){n=r.top,s=r.bottom,e.getElementRec("#content-bottom").then((function(e){o=e.top,i=e.bottom;var a=o>n&&i<s+10;return console.log(a),t(a)})).catch((function(){return a()}))})).catch((function(){return a()}))}))},checkElementInScrollView:function(e){var t=this;return new Promise((function(a,o){var i="",n="",s="",r="";t.getElementRec("#scroll-view").then((function(c){s=c.top,r=c.bottom,t.getElementRec(e).then((function(e){return i=e.top,n=e.bottom,a(i>s&&n<r+10)})).catch((function(e){return o()}))})).catch((function(e){return o()}))}))},hideAiChatDialog:function(){m.sensors.track("AppClick",{page_readable_name:"AI问诊提示弹窗",click_position:"取消"}),this.setData({shouldAiChatShow:!1})},stopBubble:function(){return!1},startAiChat:function(e){var t=this;"new"===e.mark.type?(m.sensors.track("AppClick",{page_readable_name:"AI问诊提示弹窗",click_position:"开启新对话"}),(0,_.default)({url:E,data:{source:"problem_detail",source_id:this.data.problem_id,partner:"chunyu_wap_mini"},success:function(e){0===e.data.error_code?(t.setData({shouldAiChatShow:!1}),wx.switchTab({url:"/pages/all_service/index"}),setTimeout((function(){wx.navigateTo({url:"/pages/h5_webview/index?url=".concat(encodeURIComponent(e.data.data.url))})}),1e3)):wx.showToast({icon:"none",title:e.data.error_msg})}})):(this.setData({shouldAiChatShow:!1}),m.sensors.track("AppClick",{page_readable_name:"AI问诊提示弹窗",click_position:"继续咨询"}),"service_list"===this.data.aiNavigateType?wx.switchTab({url:"/pages/all_service/index"}):wx.navigateTo({url:"/pages/h5_webview/index?url=".concat(encodeURIComponent(this.data.currentAiChatUrl))}))},showAiDialog:function(e){m.sensors.track("ActivityPOPView",{pop_title:"pop_title=您有正在进行中的AI问诊对话，是否开启新对话？"}),this.setData({shouldAiChatShow:!0,currentAiChatUrl:e.detail.url,aiNavigateType:e.detail.targetType})}});
},{isPage:true,isComponent:true,currentFile:'pages/qa_im/index.js'});require("pages/qa_im/index.js");