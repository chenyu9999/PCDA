$gwx_XC_68=function(_,_v,_n,_p,_s,_wp,_wl,$gwn,$gwl,$gwh,wh,$gstack,$gwrt,gra,grb,TestTest,wfor,_ca,_da,_r,_rz,_o,_oz,_1,_1z,_2,_2z,_m,_mz,nv_getDate,nv_getRegExp,nv_console,nv_parseInt,nv_parseFloat,nv_isNaN,nv_isFinite,nv_decodeURI,nv_decodeURIComponent,nv_encodeURI,nv_encodeURIComponent,$gdc,nv_JSON,_af,_gv,_ai,_grp,_gd,_gapi,$ixc,_ic,_w,_ev,_tsd){return function(path,global){
if(typeof global==='undefined'){if (typeof __GWX_GLOBAL__==='undefined')global={};else global=__GWX_GLOBAL__;}if(typeof __WXML_GLOBAL__ === 'undefined') {__WXML_GLOBAL__={};
}__WXML_GLOBAL__.modules = __WXML_GLOBAL__.modules || {};
var e_={}
if(typeof(global.entrys)==='undefined')global.entrys={};e_=global.entrys;
var d_={}
if(typeof(global.defines)==='undefined')global.defines={};d_=global.defines;
var f_={}
if(typeof(global.modules)==='undefined')global.modules={};f_=global.modules || {};
var p_={}
__WXML_GLOBAL__.ops_cached = __WXML_GLOBAL__.ops_cached || {}
__WXML_GLOBAL__.ops_set = __WXML_GLOBAL__.ops_set || {};
__WXML_GLOBAL__.ops_init = __WXML_GLOBAL__.ops_init || {};
var z=__WXML_GLOBAL__.ops_set.$gwx_XC_68 || [];
function gz$gwx_XC_68_1(){
if( __WXML_GLOBAL__.ops_cached.$gwx_XC_68_1)return __WXML_GLOBAL__.ops_cached.$gwx_XC_68_1
__WXML_GLOBAL__.ops_cached.$gwx_XC_68_1=[];
(function(z){var a=11;function Z(ops){z.push(ops)}
Z([[7],[3,'doctorList']])
Z([[6],[[7],[3,'item']],[3,'id']])
Z([[2,'>'],[[6],[[6],[[7],[3,'item']],[3,'doctor_tag']],[3,'length']],[1,0]])
Z([[7],[3,'showMsg']])
Z([3,'hideMsg'])
Z([3,'msg_container'])
Z([[6],[[7],[3,'userMsg']],[3,'cate']])
Z([3,'msg_box'])
Z([[6],[[7],[3,'userMsg']],[3,'title']])
Z([[6],[[7],[3,'userMsg']],[3,'msg']])
Z(z[1])
Z([3,'msg_p msg_p_left'])
Z([[6],[[7],[3,'item']],[3,'text_c']])
Z([[6],[[7],[3,'item']],[3,'text_f']])
Z([[7],[3,'showFastPhone']])
Z(z[4])
Z(z[5])
Z([3,'fast'])
Z([[7],[3,'showPhoneTip']])
})(__WXML_GLOBAL__.ops_cached.$gwx_XC_68_1);return __WXML_GLOBAL__.ops_cached.$gwx_XC_68_1
}
__WXML_GLOBAL__.ops_set.$gwx_XC_68=z;
__WXML_GLOBAL__.ops_init.$gwx_XC_68=true;
var x=['./pages/doc_card/index.wxml'];d_[x[0]]={}
var m0=function(e,s,r,gg){
var z=gz$gwx_XC_68_1()
var lQP=_v()
_(r,lQP)
var aRP=function(eTP,tSP,bUP,gg){
var xWP=_v()
_(bUP,xWP)
if(_oz(z,2,eTP,tSP,gg)){xWP.wxVkey=1
}
xWP.wxXCkey=1
return bUP
}
lQP.wxXCkey=2
_2z(z,0,aRP,e,s,gg,lQP,'item','index','{{item.id}}')
var cOP=_v()
_(r,cOP)
if(_oz(z,3,e,s,gg)){cOP.wxVkey=1
var oXP=_mz(z,'view',['catchtap',4,'class',1,'data-msg-cate',2],[],e,s,gg)
var fYP=_n('view')
_rz(z,fYP,'class',7,e,s,gg)
var cZP=_v()
_(fYP,cZP)
if(_oz(z,8,e,s,gg)){cZP.wxVkey=1
}
var h1P=_v()
_(fYP,h1P)
var o2P=function(o4P,c3P,l5P,gg){
var t7P=_n('view')
_rz(z,t7P,'class',11,o4P,c3P,gg)
var e8P=_v()
_(t7P,e8P)
if(_oz(z,12,o4P,c3P,gg)){e8P.wxVkey=1
}
var b9P=_v()
_(t7P,b9P)
if(_oz(z,13,o4P,c3P,gg)){b9P.wxVkey=1
}
e8P.wxXCkey=1
b9P.wxXCkey=1
_(l5P,t7P)
return l5P
}
h1P.wxXCkey=2
_2z(z,9,o2P,e,s,gg,h1P,'item','index','{{item.id}}')
cZP.wxXCkey=1
_(oXP,fYP)
_(cOP,oXP)
}
var oPP=_v()
_(r,oPP)
if(_oz(z,14,e,s,gg)){oPP.wxVkey=1
var o0P=_mz(z,'view',['catchtap',15,'class',1,'data-msg-cate',2],[],e,s,gg)
var xAQ=_v()
_(o0P,xAQ)
if(_oz(z,18,e,s,gg)){xAQ.wxVkey=1
}
xAQ.wxXCkey=1
_(oPP,o0P)
}
cOP.wxXCkey=1
oPP.wxXCkey=1
return r
}
e_[x[0]]={f:m0,j:[],i:[],ti:[],ic:[]}
if(path&&e_[path]){
return function(env,dd,global){$gwxc=0;var root={"tag":"wx-page"};root.children=[]
;g="$gwx_XC_68";var main=e_[path].f
if (typeof global==="undefined")global={};global.f=$gdc(f_[path],"",1);
try{
main(env,{},root,global);
_tsd(root)
}catch(err){
console.log(err)
}
;g="";
return root;
}
}
}
}(__g.a,__g.b,__g.c,__g.d,__g.e,__g.f,__g.g,__g.h,__g.i,__g.j,__g.k,__g.l,__g.m,__g.n,__g.o,__g.p,__g.q,__g.r,__g.s,__g.t,__g.u,__g.v,__g.w,__g.x,__g.y,__g.z,__g.A,__g.B,__g.C,__g.D,__g.E,__g.F,__g.G,__g.H,__g.I,__g.J,__g.K,__g.L,__g.M,__g.N,__g.O,__g.P,__g.Q,__g.R,__g.S,__g.T,__g.U,__g.V,__g.W,__g.X,__g.Y,__g.Z,__g.aa);if(__vd_version_info__.delayedGwx||false)$gwx_XC_68();	if (__vd_version_info__.delayedGwx) __wxAppCode__['pages/doc_card/index.wxml'] = [$gwx_XC_68, './pages/doc_card/index.wxml'];else __wxAppCode__['pages/doc_card/index.wxml'] = $gwx_XC_68( './pages/doc_card/index.wxml' );
	;__wxRoute = "pages/doc_card/index";__wxRouteBegin = true;__wxAppCurrentFile__="pages/doc_card/index.js";define("pages/doc_card/index.js",function(require,module,exports,window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){
"use strict";var t=getApp(),a=require("../../BC983DD1829A079CDAFE55D6E84D7B70.js"),e=require("../../92BC1755829A079CF4DA7F52C55D7B70.js").param,i=a.baseUrl+"/events/activity/doctor_card/info/",s=a.baseUrl+"/events/activity/doctor_card/collect/",o=a.baseUrl+"/events/activity/doctor_card/create_service/";Page({data:{isPositive:!0,activityInfo:{},doctorList:[],doctor_list:[],initLength:3,userMsg:{},showMsg:!1,activityId:"",orginUserId:0,shareImg:"",showFastPhone:!1,phoneNumber:"",showPhoneTip:!1,phoneTipMsg:"",targetUser:6},onLoad:function(t){this.options=t},init:function(t){var a=decodeURIComponent(t.scene),e=this.getQueryStr("activity_id",a||"");this.setData({activityId:t.activity_id||e,orginUserId:t.user_activity_id||0}),this.initData()},getQueryStr:function(t,a){var e=a.match(new RegExp(t+"=([^&]*)(&?)","i")),i=e&&e.length>1&&e[1]||"";return decodeURIComponent(i)},initData:function(){var a=this,e=a.data.activityId;wx.request({url:i,method:"GET",header:{"Content-Type":"application/json",Cookie:t.globalData.sessionid},data:{is_json:1,from_wx_mini:1,activity_id:e},success:function(t){if(t.data.success){var e=t.data.activity_info,i=t.data.doctor_list,s=t.data.share_info,o=[],n=a.data.initLength;i.length>0&&(o=i.length>n?i.slice(0,n):i),a.setData({doctorList:o,activityInfo:e,shareImgUrl:s.image}),wx.hideLoading(),a.setData({doctor_list:i})}else wx.hideLoading(),wx.showModal({title:"提示",content:t.data.error_msg,showCancel:!1,success:function(t){t.confirm&&wx.switchTab({url:"../index/index"})}})}})},collectionCard:function(){this.setData({userMsg:{msg:[{id:1,text_f:"仅需分享到一个群，即可马上成功收藏"}],btn:[{id:1,btn_type:"share",btn_text:"去分享",cate:"",subCate:"share"}]},showMsg:!0})},collectionReal:function(){var a=this,o={};o=a.data.orginUserId&&0!=a.data.orginUserId?{activity_id:a.data.activityId,user_activity_id:a.data.orginUserId}:{activity_id:a.data.activityId},wx.request({url:s,header:{"Content-Type":"application/x-www-form-urlencoded",Cookie:t.globalData.sessionid},method:"POST",data:e(o),success:function(e){e.data.success?wx.request({url:i,method:"GET",header:{"Content-Type":"application/json",Cookie:t.globalData.sessionid},data:{is_json:1,from_wx_mini:1,activity_id:a.data.activityId},success:function(t){var e=t.data.activity_info;a.setData({activityInfo:e});var i={title:"收藏成功！",msg:[{id:1,text_c:"地址：小程序>春雨医生>个人中心"},{id:2,text_c:"分享给"+a.data.targetUser+"个人即可开启免费拨打电话及发消息功能，永久有效。"}],btn:[{id:1,btn_type:"share",btn_text:"去分享",cate:"",subCate:"share"}]};a.setData({userMsg:i,showMsg:!0})}}):wx.showModal({title:"收藏失败！",content:e.data.error_msg,showCancel:!1})},fail:function(t){wx.showModal({title:"收藏失败！",content:t.data.error_msg,showCancel:!1})}})},hideMsg:function(t){"fast"==t.currentTarget.dataset.msgCate?this.setData({showFastPhone:!1,phoneNumber:"",showPhoneTip:!1,phoneTipMsg:""}):(this.setData({showMsg:!1}),"collec"==t.currentTarget.dataset.msgCate&&this.initData(),"over"==t.currentTarget.dataset.msgCate&&wx.navigateTo({url:"../doc_mainpage/index?doc_id="+this.data.doctorId}))},callDoc:function(t){if(this.setData({doctorId:t.currentTarget.dataset.docId}),this.data.activityInfo.user_activity_id){if("p"==this.data.activityInfo.status){var a=this.getMsg("4","");this.setData({userMsg:a,showMsg:!0})}else if("a"==this.data.activityInfo.status){var e=new Date;if(!t.currentTarget.dataset.isAccept||e.getHours()<9||e.getHours()>21){var i=this.getMsg("1",t.currentTarget.dataset.docName);this.setData({userMsg:i,showMsg:!0})}else this.setData({showFastPhone:!0})}else if("u"==this.data.activityInfo.status){var s=this.getMsg("3","");this.setData({userMsg:s,showMsg:!0})}}else wx.showToast({title:"收藏后才可开启该功能，请先收藏哦！\r\n>>去收藏",icon:"none",duration:2e3})},graphDoc:function(a){if(this.setData({doctorId:a.currentTarget.dataset.docId}),this.data.activityInfo.user_activity_id){if("p"==this.data.activityInfo.status){var i=this.getMsg("4","");this.setData({userMsg:i,showMsg:!0})}else if("a"==this.data.activityInfo.status)if(a.currentTarget.dataset.isAccept){var s={activity_id:this.data.activityId,doctor_id:this.data.doctorId,service_type:"graph"};wx.showModal({title:"提示",content:"你一共只有一次与本名片列表之中的医生免费沟通的机会,确定提交吗?",success:function(a){a.confirm&&wx.request({url:o,header:{"Content-Type":"application/x-www-form-urlencoded",Cookie:t.globalData.sessionid},data:e(s),method:"POST",success:function(t){!t.data.success&&t.data.error_msg?wx.showModal({content:t.data.error_msg,showCancel:!1}):wx.redirectTo({url:"../fast_qa/index?problem_id="+t.data.service_id})},fail:function(t){console.log(t)}})}})}else{var n=this.getMsg("2",a.currentTarget.dataset.docName);this.setData({userMsg:n,showMsg:!0})}else if("u"==this.data.activityInfo.status){var r=this.getMsg("3","");this.setData({userMsg:r,showMsg:!0})}}else wx.showToast({title:"收藏后才可开启该功能，请先收藏哦！\r\n>>去收藏",icon:"none",duration:2e3})},getMsg:function(t,a){if("1"==t)return{msg:[{id:1,text_c:a+"大夫暂无可接听电话的时间，请选择发消息沟通。"}],btn:[{id:1,btn_type:"common",btn_text:"我知道了",cate:"",subCate:"我知道了"}]};if("2"==t)return{msg:[{id:1,text_c:a+"大夫暂无文字沟通的时间，请选择电话沟通。"}],btn:[{id:1,btn_type:"common",btn_text:"我知道了",cate:"",subCate:""}]};if("3"==t){return{msg:[{id:1,text_c:"你的免费沟通机会已用完，请移步医生主页付费与医生沟通。"}],btn:[{id:1,btn_type:"common",btn_text:"去医生主页 >",cate:"",subCate:"over"}]}}if("4"==t)return{msg:[{id:1,text_f:"你尚未开启免费拨打电话及发消息功能！分享给"+this.data.targetUser+"个人即可开启，永久有效。"}],btn:[{id:1,btn_type:"share",btn_text:"去分享",cate:"",subCate:"share"}]};if("5"==t){return{title:"收藏失败！",msg:[{id:1,text_c:"收藏后可以和医生免费沟通，总有一天用得上哦，确定不收藏吗？去分享完成收藏"}],btn:[{id:1,btn_type:"cancel",btn_text:"忍痛离开",cate:"",subCate:""},{id:2,btn_type:"share",btn_text:"立即分享",cate:"",subCate:"share"}]}}},subFastPhone:function(){if(this.checkPhone()){var a={activity_id:this.data.activityId,doctor_id:this.data.doctorId,phone:this.data.phoneNumber,service_type:"fast_phone"};wx.showModal({title:"提示",content:"你一共只有一次与本名片列表之中的医生免费沟通的机会,确定提交吗?",success:function(i){i.confirm&&wx.request({url:o,header:{"Content-Type":"application/x-www-form-urlencoded",Cookie:t.globalData.sessionid},data:e(a),method:"POST",success:function(t){!t.data.success&&t.data.error_msg?wx.showModal({content:t.data.error_msg,showCancel:!1}):wx.redirectTo({url:"../pay_success/index"})},fail:function(t){console.log(t)}})}})}},updatePhone:function(t){var a=t.detail.value;this.setData({phoneNumber:a})},msgInput:function(){},checkPhone:function(){return/^1[3|4|5|7|8]\d{9}$/.test(this.data.phoneNumber)?(this.setData({showPhoneTip:!1,phoneTipMsg:""}),!0):(this.setData({showPhoneTip:!0,phoneTipMsg:"请输入正确的手机号码！"}),!1)},onReady:function(){},onShow:function(){var a=this,e=a.options;wx.showLoading({title:"加载中"}),t.globalData.appIsLogin.then((function(){a.init(e)}))},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){if(this.data.doctor_list.length>this.data.doctorList.length){var t=this.data.doctor_list.slice(this.data.initLength);this.data.doctorList=this.data.doctorList.concat(t),this.setData({doctorList:this.data.doctorList})}},onShareAppMessage:function(){var t=this;return{title:"有了这些医生名片，再也不用担心去大医院挂不上号了",path:t.data.activityInfo.user_activity_id?"pages/doc_card/index?activity_id="+t.data.activityId+"&user_activity_id="+t.data.activityInfo.user_activity_id:"pages/doc_card/index?activity_id="+t.data.activityId,desc:"春雨医生+",imageUrl:t.data.shareImgUrl,success:function(a){if("shareAppMessage:ok"==a.errMsg)if(t.data.activityInfo.user_activity_id){t.setData({userMsg:{title:"恭喜你，分享成功！",msg:[{id:1,text_c:"分享给更多的群（好友），可在最短时间内开通免费沟通功能哦！离成功越来越近啦。"}],btn:[{id:1,btn_type:"share",btn_text:"继续分享",cate:"",subCate:"share"}]},showMsg:!0})}else t.collectionReal();else if(!t.data.activityInfo.user_activity_id){var e=t.getMsg("5","");t.setData({userMsg:e,showMsg:!0})}},fail:function(a){if("shareAppMessage:fail"==a.errMsg)wx.showToast({title:"分享失败！"});else if(!t.data.activityInfo.user_activity_id){var e=t.getMsg("5","");t.setData({userMsg:e,showMsg:!0})}}}}});
},{isPage:true,isComponent:true,currentFile:'pages/doc_card/index.js'});require("pages/doc_card/index.js");