__wxCodeSpace__.batchAddCompiledTemplate(function(G,R,D,Q,gdc,X,Y,Z,RG={}){var P=RG.P||function(a){return typeof a==='function'?a:()=>{}};return {'pages/market/advertiseNew/ad-sdk':(()=>{var H={};var S;var I=(P)=>{if(!S)S=Object.assign({},H);return S[P]};H[""]=(R,C,D,U)=>{var L=R.c;var M=R.m;var O=R.r;var A={};var K=U===true;return {C:(C,T,E,B)=>{var a=!D.showTencentAd?1:0;B(a,(C,T,E,B)=>{if(a===1){var b=D.adType=="BANNER"?1:0;B(b,(C,T,E,B)=>{if(b===1){var c=D.loadFlag&&D.impType=="2"?1:0;B(c,(C,T,E,B)=>{if(c===1){E("ad-chaping",{},(N,C)=>{if(C||K||U.adType)O(N,"adType",D.adType);if(C||K||U.adData)O(N,"adData",D.adData);if(C||K||U.trackingid)O(N,"trackingid",D.trackingid);if(C||K||U.header)O(N,"header",D.header);if(C||K||U.showSign)O(N,"showSign",D.showSign);if(C||K||U.screenRatio)O(N,"screenRatio",D.screenRatio);if(C||K||U.whObj)O(N,"whObj",D.whObj)},(C)=>{})}else{var d=D.loadFlag?1:0;B(d,(C,T,E)=>{if(d===1){E("ad-background",{},(N,C)=>{if(C||K||U.borderRadius)O(N,"borderRadius",D.borderRadius);if(C||K||U.adType)O(N,"adType",D.adType);if(C||K||U.trackingid)O(N,"trackingid",D.trackingid);if(C||K||U.header)O(N,"header",D.header);if(C||K||U.adData)O(N,"adData",D.adData);if(C||K||U.showSign)O(N,"showSign",D.showSign);if(C||K||U.whObj)O(N,"whObj",D.whObj)},(C)=>{})}})}})}else{E("ad-slider",{},(N,C)=>{if(C||K||U.adData)O(N,"adData",D.adData);if(C||K||U.borderRadius)O(N,"borderRadius",D.borderRadius);if(C||K||U.adType)O(N,"adType",D.adType);if(C||K||U.trackingid)O(N,"trackingid",D.trackingid);if(C||K||U.header)O(N,"header",D.header);if(C||K||U.showSign)O(N,"showSign",D.showSign);if(C||K||U.whObj)O(N,"whObj",D.whObj);if(C||K||U.slideVideo)O(N,"slideVideo",D.slideVideo)},(C)=>{})}})}else{E("div",{},(N,C)=>{if(C||K||U.adStyle)R.y(N,D.adStyle)},(C,T,E,B)=>{var c=!D.showAdCustomSDK?1:0;B(c,(C,T,E)=>{if(c===1){E("ad",{},(N,C)=>{if(C||K||U.tencentAdCode)O(N,"unit-id",D.tencentAdCode)},(C)=>{})}else{E("ad-custom",{},(N,C)=>{if(C||K||U.adCustomSDKStyle)R.y(N,D.adCustomSDKStyle);if(C||K||U.tencentAdCode)O(N,"unit-id",D.tencentAdCode)},(C)=>{})}})})}})},B:A}};return Object.assign(function(R){return H[R]},{_:H})})(),}});;__wxRoute = "pages/market/advertiseNew/ad-sdk";__wxRouteBegin = true;__wxAppCurrentFile__="pages/market/advertiseNew/ad-sdk.js";define("pages/market/advertiseNew/ad-sdk.js",function(require,module,exports,window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){
"use strict";require("../../../@babel/runtime/helpers/Arrayincludes");var e=require("../../../@babel/runtime/helpers/objectSpread2"),t=require("../../../@babel/runtime/helpers/toConsumableArray"),a=require("../../../cwx/cwx.js"),i=require("./ad-utils.js"),n="mkt_newlanAndLong";Component({properties:{mediaCode:String,pageCode:String,impId:String,width:String,height:String,slideVideo:Object,showSign:Object,site:Object,extension:Array,corp:Object,lonAndLat:Object,borderRadius:String,sequence:Number,callbackExtension:Array},observers:{"impId,site":function(e,t){wx.j("Dgs"),this.setAdStatus()}},data:{impType:"1",screenRatio:100,adType:"BANNER",loadFlag:!1,adData:[],whObj:{},showTencentAd:!1,tencentAdCode:"",adStyle:"",trackingid:"",header:{},showAdCustomSDK:!1,adCustomSDKStyle:""},lifetimes:{attached:function(){},moved:function(){},detached:function(){}},pageLifetimes:{resize:function(){this.setAdStatus()}},methods:{getsingleId:function(){return wx.j("PCN"),(new Date).getTime()+Math.random().toString(32).substr(2)},getHeadinfo:function(){return wx.j("eWl"),{syscode:"30",lang:a.cwx.wxSystemInfo.language,cid:a.cwx.clientID,cver:a.__global.version,sid:a.__global.sid&&a.__global.sid+""||""}},getOsName:function(){wx.j("SEa");var e=a.cwx.wxSystemInfo.system;return e?/android/i.test(e)?"ANDROID":/ios/i.test(e)?"IOS":"APP":"APP"},getPRSetting:function(){return wx.j("PYo"),new Promise((function(e,t){wx.j("UhA");var i={personalRecommendSwitch:!1};a.cwx.getPRSetting?a.cwx.getPRSetting().then((function(t){wx.j("jQZ"),e(t)})).catch((function(t){wx.j("h9u"),e(i)})):e(i)}))},getRequestParams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.personalRecommendSwitch;wx.j("nHK");var s={isPersonalRecommend:i,head:this.getHeadinfo(),id:"MINI_APP".concat(this.getsingleId()),type:"MINI_APP",sdkVer:"3.0.0",apiVer:"1.0.0",device:{deviceType:"PHONE",os:this.getOsName(),osv:a.cwx.wxSystemInfo.system||a.__global.version,height:a.cwx.wxSystemInfo.screenHeight,width:a.cwx.wxSystemInfo.screenWidth,pxratio:a.cwx.wxSystemInfo.pixelRatio},user:{cid:a.cwx.clientID,vid:a.__global.vid,openid:a.cwx.cwx_mkt.openid},imps:[{impId:this.data.impId}],app:{ver:"1.0"},site:{url:getCurrentPages()&&getCurrentPages()[0]&&getCurrentPages()[0].route||""}};this.data.sequence&&(s.imps[0].sequence=this.data.sequence);var d=Object.assign({},{siteId:"",siteType:""},this.data.site),c=Object.assign({},{corpId:"",corpType:""},this.data.corp),r={isEnable:!1,lon:"",lat:"",cityID:"",cityName:""},o=Object.assign({},r,this.data.lonAndLat);if(a.cwx.getStorageSync(n))try{var u=a.cwx.getStorageSync(n);if("string"==typeof u){var g=JSON.parse(u);g.latitude&&(s.device.geo=g)}}catch(e){console.log(e)}if(a.cwx.locate.getCtripCity((function(e){wx.j("7rd"),e&&e.data&&e.data.CityLatitude&&e.data.CityEntities&&e.data.CityEntities[0]&&e.data.CityEntities[0].CityID&&a.cwx.setStorageSync(n,JSON.stringify({latitude:e.data.CityLatitude,longitude:e.data.CityLongitude,cityId:e.data.CityEntities[0].CityID,city:e.data.CityEntities[0].CityName}))}),"marketluckyactivity-lbs","gcj02",8e3,!o.isEnable),!o.isEnable&&o.lon&&o.lat){var l={latitude:o.lat,longitude:o.lon};o.cityName&&(l.cityName=o.cityName),o.country&&(l.country=o.country),o.region&&(l.region=o.region),o.cityID&&(l.cityId=o.cityID),o.countryId&&(l.countryId=o.countryId),o.regionId&&(l.regionId=o.regionId),o.destId&&(l.destId=o.destId),s.geo=l}(d.siteId||d.siteType)&&(s.user.data=s.user.data||[],d.siteId&&s.user.data.push({name:"siteId",value:d.siteId+""}),d.siteType&&s.user.data.push({name:"siteType",value:d.siteType+""})),(c.corpId||c.corpType)&&(s.user.data=s.user.data||[],c.corpId&&s.user.data.push({name:"corpid",value:c.corpId+""}),c.corpType&&s.user.data.push({name:"corptype",value:c.corpType+""})),a.cwx.mkt.getUnion((function(e){wx.j("Tyl"),s.user.data=s.user.data||[],e&&(e.allianceid&&s.user.data.push({name:"aid",value:e.allianceid+""}),e.sid&&s.user.data.push({name:"sid",value:e.sid+""}),e.ouid&&s.user.data.push({name:"ouid",value:e.ouid+""}),e.sourceid&&(s.app.sourceId=e.sourceid+""))}));var h=this.data.extension,y=[];return h&&Array.isArray(h)&&h.length>0&&(h.forEach((function(e,t){wx.j("1Zx"),e.name&&e.value?"customData"==e.name?(y.push(e),h.splice(t,1)):(e.name=e.name+"",e.value=e.value+""):h.splice(t,1)})),this.setData({callbackExtension:y}),s.exts=h),s.exts?s.exts=[].concat(t(s.exts),[{name:"supportWebp",value:"1"}]):s.exts=[{name:"supportWebp",value:"1"}],a.cwx.getStorageSync("auth")&&(s.head.auth=a.cwx.getStorageSync("auth")),this.setData({header:s.head}),s},getAdResultPromise:function(){var t=this;wx.j("scy");var i=this;return new Promise((function(n,s){wx.j("ehr"),t.getPRSetting().then((function(d){wx.j("I2s");var c=t.getRequestParams(e({},d)),r={data:JSON.stringify(c)};a.cwx.sendUbtByPage&&a.cwx.sendUbtByPage.ubtTrace&&a.cwx.sendUbtByPage.ubtTrace("marketadsdk_request_before",r),a.cwx.request({url:"/restapi/soa2/13916/tripAds.json",data:c,success:function(e){wx.j("hXB");var t=e.data.seats;if(n(t),i.setData({trackingid:e.data.trackingid}),t&&t.length>0){a.cwx.sendUbtByPage&&a.cwx.sendUbtByPage.ubtTrace&&a.cwx.sendUbtByPage.ubtTrace("marketadsdk_response_success",{data:JSON.stringify(t)}),i.triggerEvent("getAdData",t,{bubbles:!0,composed:!0});var s={adData:t,extension:i.data.callbackExtension};i.triggerEvent("getExtensionAdData",s,{bubbles:!0,composed:!0})}else{a.cwx.sendUbtByPage&&a.cwx.sendUbtByPage.ubtTrace&&a.cwx.sendUbtByPage.ubtTrace("marketadsdk_response_failed",{data:JSON.stringify(c)}),i.triggerEvent("getAdData",[],{bubbles:!0,composed:!0});var d={adData:[],extension:i.data.callbackExtension};i.triggerEvent("getExtensionAdData",d,{bubbles:!0,composed:!0})}},fail:function(e){wx.j("bQf"),s(e),a.cwx.sendUbtByPage&&a.cwx.sendUbtByPage.ubtTrace&&a.cwx.sendUbtByPage.ubtTrace("marketadsdk_response_error",{data:JSON.stringify(e)}),i.triggerEvent("getAdData",[],{bubbles:!0,composed:!0});var t={adData:[],extension:i.data.callbackExtension};i.triggerEvent("getExtensionAdData",t,{bubbles:!0,composed:!0})}})})).catch((function(e){wx.j("Xx5"),a.cwx.sendUbtByPage&&a.cwx.sendUbtByPage.ubtTrace&&a.cwx.sendUbtByPage.ubtTrace("marketadsdk_response_error",{data:JSON.stringify(e)})}))}))},getWxCustomSDKHight:function(e){if(wx.j("nCq"),e.includes("%")){var t=e.split("%"),a=Number(t[0])+4.3;return"".concat(a,"%")}return"".concat(e,"px")},setAdStatus:function(){var e=this;wx.j("Mls"),this.getAdResultPromise().then((function(t){wx.j("qKe");var n=t&&t.length>0&&t[0]&&t[0].ads||[],s=(0,i.isuseWechatAd)(n.length>0?n[0]:{}),d=s.isuse,c=s.unionCode,r=s.sdkType,o=s.sdkGroupType;if(d&&c&&1==n.length){var u={sdkType:r,unionCode:c,width:e.data.width,height:e.data.height,impId:e.data.impId},g=!1;3==o&&(g=!0),e.setData({showTencentAd:!0,showAdCustomSDK:g,tencentAdCode:c,adStyle:"background:#fff;width:".concat(u.width).concat(u.width.includes("%")?"":"px",";height:").concat(u.height).concat(u.height.includes("%")?"":"px",";display: block; justify-content: center;align-items: center;overflow:hidden;position:relative;"),adCustomSDKStyle:"background:#fff;width:".concat(u.width).concat(u.width.includes("%")?"":"px",";height:").concat(e.getWxCustomSDKHight(u.height),";overflow:hidden;position:relative;top:").concat(u.height.includes("%")?"-4.3%":0)}),a.cwx.sendUbtByPage&&a.cwx.sendUbtByPage.ubtTrace&&a.cwx.sendUbtByPage.ubtTrace("mkt_adsdk_alliancesdk_request",JSON.stringify(u))}else if(n&&n.length>0){var l=n.length>1?"MULTI-BANNER":"BANNER",h="MULTI-BANNER"==l?[]:{},y=n[0],w=y.impType;if("BANNER"==l){var p=(h=n[0]).creativeMaterial;p&&p.metricLogs.forEach((function(e){wx.j("iau"),"102839"!=e.key&&"102842"!=e.key||a.cwx.sendUbtByPage&&a.cwx.sendUbtByPage.ubtTrace&&a.cwx.sendUbtByPage.ubtTrace(e.key,e.value)})),(0,i.sendExposefn)(h,"show","first")}else"MULTI-BANNER"==l&&(h=n,(0,i.sendExposefn)(h[0],"show","first"));e.setData({impType:w,screenRatio:y.screenRatio||100,adType:l,adData:h,loadFlag:!0,whObj:{crWidth:e.data.width,crHeight:e.data.height,screenHeight:a.cwx.wxSystemInfo.windowHeight,screenWidth:a.cwx.wxSystemInfo.windowWidth},showTencentAd:!1,tencentAdCode:"",adStyle:""})}else{var x=t&&t.length>0&&t[0]&&t[0].exts||[];if(x.length>0){var b=(0,i.getArrayValue)(x,"sdkType");if(2==b){var m=(0,i.getArrayValue)(x,"unionCode"),f={sdkType:b,unionCode:m,width:e.data.width,height:e.data.height,impId:e.data.impId};e.setData({showTencentAd:!0,tencentAdCode:m,adStyle:"background:#fff;width:".concat(f.width).concat(f.width.includes("%")?"":"px",";height:").concat(f.height).concat(f.height.includes("%")?"":"px",";display: flex; justify-content: center;align-items: center;overflow:hidden;")}),a.cwx.sendUbtByPage&&a.cwx.sendUbtByPage.ubtTrace&&a.cwx.sendUbtByPage.ubtTrace("mkt_adsdk_alliancesdk_request",JSON.stringify(f))}}e.setData({impType:"1",screenRatio:100,adType:"BANNER",adData:[],loadFlag:!1,whObj:{}})}}))}}});
},{isPage:false,isComponent:true,currentFile:'pages/market/advertiseNew/ad-sdk.js'});require("pages/market/advertiseNew/ad-sdk.js");