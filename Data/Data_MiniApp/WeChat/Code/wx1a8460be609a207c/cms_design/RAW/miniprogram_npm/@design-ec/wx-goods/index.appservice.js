$gwx_XC_37=function(_,_v,_n,_p,_s,_wp,_wl,$gwn,$gwl,$gwh,wh,$gstack,$gwrt,gra,grb,TestTest,wfor,_ca,_da,_r,_rz,_o,_oz,_1,_1z,_2,_2z,_m,_mz,nv_getDate,nv_getRegExp,nv_console,nv_parseInt,nv_parseFloat,nv_isNaN,nv_isFinite,nv_decodeURI,nv_decodeURIComponent,nv_encodeURI,nv_encodeURIComponent,$gdc,nv_JSON,_af,_gv,_ai,_grp,_gd,_gapi,$ixc,_ic,_w,_ev,_tsd){return function(path,global){
if(typeof global==='undefined'){if (typeof __GWX_GLOBAL__==='undefined')global={};else global=__GWX_GLOBAL__;}if(typeof __WXML_GLOBAL__ === 'undefined') {__WXML_GLOBAL__={};
}__WXML_GLOBAL__.modules = __WXML_GLOBAL__.modules || {};
var e_={}
if(typeof(global.entrys)==='undefined')global.entrys={};e_=global.entrys;
var d_={}
if(typeof(global.defines)==='undefined')global.defines={};d_=global.defines;
var f_={}
if(typeof(global.modules)==='undefined')global.modules={};f_=global.modules || {};
var p_={}
__WXML_GLOBAL__.ops_cached = __WXML_GLOBAL__.ops_cached || {}
__WXML_GLOBAL__.ops_set = __WXML_GLOBAL__.ops_set || {};
__WXML_GLOBAL__.ops_init = __WXML_GLOBAL__.ops_init || {};
var z=__WXML_GLOBAL__.ops_set.$gwx_XC_37 || [];
function gz$gwx_XC_37_1(){
if( __WXML_GLOBAL__.ops_cached.$gwx_XC_37_1)return __WXML_GLOBAL__.ops_cached.$gwx_XC_37_1
__WXML_GLOBAL__.ops_cached.$gwx_XC_37_1=[];
(function(z){var a=11;function Z(ops){z.push(ops)}
Z([a,[[7],[3,'prefixCls']],[3,' '],[[2,'?:'],[[7],[3,'isOpacity']],[[2,'+'],[[7],[3,'prefixCls']],[1,'-bg--trans']],[1,'']]])
Z([3,'J_Goods'])
Z([[7],[3,'goodCustomStyles']])
Z([[2,'&&'],[[6],[[6],[[7],[3,'formatModuleData']],[3,'content']],[3,'showLayout']],[[2,'>'],[[6],[[7],[3,'goodsClassify']],[3,'length']],[1,0]]])
Z([3,'scrollFix'])
Z([[7],[3,'container']])
Z([[2,'+'],[[7],[3,'prefixCls']],[1,'-sticky-classify']])
Z([3,'wgsidx_3'])
Z([[7],[3,'classifyTopNavHeight']])
Z([3,'fetchGoodsFromClassify'])
Z([[7],[3,'goodsClassify']])
Z([3,'wgsidx_5'])
Z([[2,'&&'],[[7],[3,'formatModuleData']],[[2,'!'],[[7],[3,'classifyLoading']]]])
Z([3,'cartTapHandel'])
Z([3,'dotCallback'])
Z([3,'onGoodsListLoadEnd'])
Z([3,'loadMore'])
Z([[7],[3,'exData']])
Z([[7],[3,'exStyle']])
Z([3,'wgsidx_6'])
Z([[7],[3,'isFetching']])
Z([1,true])
Z([[7],[3,'isManualLoadMore']])
Z(z[21])
Z([3,'good-list'])
Z([[7],[3,'formatModuleData']])
Z([[7],[3,'classifyLoading']])
Z([3,'ecde-classify-loading'])
Z([3,'wgsidx_9'])
Z([1,24])
})(__WXML_GLOBAL__.ops_cached.$gwx_XC_37_1);return __WXML_GLOBAL__.ops_cached.$gwx_XC_37_1
}
__WXML_GLOBAL__.ops_set.$gwx_XC_37=z;
__WXML_GLOBAL__.ops_init.$gwx_XC_37=true;
var x=['./cms_design/RAW/miniprogram_npm/@design-ec/wx-goods/index.wxml'];d_[x[0]]={}
var m0=function(e,s,r,gg){
var z=gz$gwx_XC_37_1()
var hEQ=_mz(z,'view',['class',0,'id',1,'style',1],[],e,s,gg)
var oFQ=_v()
_(hEQ,oFQ)
if(_oz(z,3,e,s,gg)){oFQ.wxVkey=1
var lIQ=_mz(z,'ti-sticky',['usePureCss',-1,'bind:fixed',4,'container',1,'extClass',2,'id',3,'offsetTop',4],[],e,s,gg)
var aJQ=_mz(z,'goods-classify',['bind:fetchGoodsFromClassify',9,'goodsClassify',1,'id',2],[],e,s,gg)
_(lIQ,aJQ)
_(oFQ,lIQ)
}
var cGQ=_v()
_(hEQ,cGQ)
if(_oz(z,12,e,s,gg)){cGQ.wxVkey=1
var tKQ=_mz(z,'good-list',['bind:carttapevent',13,'bind:dotCallback',1,'bind:goodsListLoadEnd',2,'bind:loadMore',3,'exData',4,'exStyle',5,'id',6,'isFetching',7,'isLoadMore',8,'isManualLoadMore',9,'isShowBoxShadow',10,'listType',11,'moduleData',12],[],e,s,gg)
_(cGQ,tKQ)
}
var oHQ=_v()
_(hEQ,oHQ)
if(_oz(z,26,e,s,gg)){oHQ.wxVkey=1
var eLQ=_mz(z,'ti-loading',['visible',-1,'extClass',27,'id',1,'size',2],[],e,s,gg)
_(oHQ,eLQ)
}
oFQ.wxXCkey=1
oFQ.wxXCkey=3
cGQ.wxXCkey=1
cGQ.wxXCkey=3
oHQ.wxXCkey=1
oHQ.wxXCkey=3
_(r,hEQ)
return r
}
e_[x[0]]={f:m0,j:[],i:[],ti:[],ic:[]}
if(path&&e_[path]){
return function(env,dd,global){$gwxc=0;var root={"tag":"wx-page"};root.children=[]
;g="$gwx_XC_37";var main=e_[path].f
if (typeof global==="undefined")global={};global.f=$gdc(f_[path],"",1);
try{
main(env,{},root,global);
_tsd(root)
}catch(err){
console.log(err)
}
;g="";
return root;
}
}
}
}(__g.a,__g.b,__g.c,__g.d,__g.e,__g.f,__g.g,__g.h,__g.i,__g.j,__g.k,__g.l,__g.m,__g.n,__g.o,__g.p,__g.q,__g.r,__g.s,__g.t,__g.u,__g.v,__g.w,__g.x,__g.y,__g.z,__g.A,__g.B,__g.C,__g.D,__g.E,__g.F,__g.G,__g.H,__g.I,__g.J,__g.K,__g.L,__g.M,__g.N,__g.O,__g.P,__g.Q,__g.R,__g.S,__g.T,__g.U,__g.V,__g.W,__g.X,__g.Y,__g.Z,__g.aa);if(__vd_version_info__.delayedGwx||false)$gwx_XC_37();	if (__vd_version_info__.delayedGwx) __wxAppCode__['cms_design/RAW/miniprogram_npm/@design-ec/wx-goods/index.wxml'] = [$gwx_XC_37, './cms_design/RAW/miniprogram_npm/@design-ec/wx-goods/index.wxml'];else __wxAppCode__['cms_design/RAW/miniprogram_npm/@design-ec/wx-goods/index.wxml'] = $gwx_XC_37( './cms_design/RAW/miniprogram_npm/@design-ec/wx-goods/index.wxml' );
	;__wxRoute = "cms_design/RAW/miniprogram_npm/@design-ec/wx-goods/index";__wxRouteBegin = true;__wxAppCurrentFile__="cms_design/RAW/miniprogram_npm/@design-ec/wx-goods/index.js";define("cms_design/RAW/miniprogram_npm/@design-ec/wx-goods/index.js",function(require,module,exports,window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){
"use strict";var a=require("../../../../../@babel/runtime/helpers/toConsumableArray"),t=require("../../../../../@babel/runtime/helpers/objectSpread2"),e=require("../../../../../@babel/runtime/helpers/regeneratorRuntime");require("../../../../../@babel/runtime/helpers/Arrayincludes"),require("../../../titan.bootstrap.js");var i,o=global.bc("package","cms_design"),n=require("../../../titan-scoped-env.js"),s=require("../../../../../@titan/env.js"),r=(i=require("../wx-utils/getPrefixCls.js"))&&i.__esModule?i:{default:i},l=require("../wx-utils/global.js"),u=n.requirePlatform("cms").main.CMS;n.Component({options:{addGlobalClass:!0},properties:{moduleData:Object,exData:{type:Object,value:{}},requestConfig:Object},data:{isChangeCurStickyComHeight:!1,classifyLoading:!1,slot:{text:"测试测试"},goodsClassify:[],container:null,prefixCls:(0,r.default)("goods"),topNavHeight:0,classifyTopNavHeight:0},observers:{"isSetTopNavHeight, exData.contextData":function(a){a&&this.setClassifyTopHeight()}},lifetimes:{ready:function(){var a=this;this.setData({container:function(){return a.createSelectorQuery().select("#J_Goods")}})},attached:function(){this.dataPageNum=1,this.dataPageSize=20,this.init()}},methods:{setClassifyTopHeight:function(){var a,t=this.data,e=t.moduleData,i=(t.goodsClassify,t.topNavHeight),o=t.exData,n=null==o?void 0:o.pagename;if(null!=e&&null!==(a=e.content)&&void 0!==a&&a.showLayout){var s,r,l,u=null==o||null===(s=o.contextData)||void 0===s||null===(r=s.curStickyCom)||void 0===r?void 0:r.height;l=u?Number(i)+u-8:i,["ec-goods-detail"].includes(n)&&(l=u),this.setData({classifyTopNavHeight:l})}},init:function(){var a=this;return(0,s.babel_coroutine)(e().mark((function t(){var i,o,s,r,u,d,c,g,m,p,v,f,h,D,y,b,M,x,C;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.data){t.next=2;break}return t.abrupt("return");case 2:i=a.data,o=i.moduleData,s=void 0===o?{}:o,r=i.exData,u=void 0===r?{}:r,d=s.content,c=void 0===d?{}:d,g=s.style,m=void 0===g?{}:g,s.styleGroup,p=u.pagename,v=void 0===p?"":p,f=u.grayEnabled,h=c.classifyInfo,D=c.items,y=void 0===D?[]:D,b=m.opacity,M=void 0!==b&&b,x=a.isManualLoadMoreFun(s),n.setTimeout((function(){var t=(0,l.getMenuButtonBoundingClientRect)(),e=t.top+t.height+8;a.setData({topNavHeight:e,classifyTopNavHeight:e,isSetTopNavHeight:!0})}),100),C=(null==h?void 0:h.attributeInfo)||[],a.setData({isOpacity:M,formatModuleData:a.formatDataFromMargin(s).newModuleData,goodsClassify:C,isManualLoadMore:x,grayEnabled:f},(function(){x&&0===y.length&&a.loadMore({}),n.setTimeout((function(){a.triggerEvent("moduleCallback",{type:"updateModuleHeight",moduleData:s})}),200)})),a.rprmExposure({originGoodList:y,pagename:v,pagenum:a.dataPageNum});case 7:case"end":return t.stop()}}),t)})))()},fetchGoodsFromClassify:function(a){var e=this,i=a.detail,o=t(t({},void 0===i?{}:i),{},{dataPageNum:1}),s=this.data.exData;!(void 0===s?{}:s).hasLocationMenu&&this.setData({classifyLoading:!0}),this.asyncLoadData({isClassify:!0,params:o,callback:function(a){e.setData({formatModuleData:e.formatDataFromMargin(a).newModuleData,classifyLoading:!1},(function(){n.setTimeout((function(){e.triggerEvent("moduleCallback",{type:"updateModuleHeight",moduleData:a})}),200)}))}})},asyncLoadData:function(a){var e=this,i=a.callback,o=a.params,n=a.isClassify,s=this.data,r=s.moduleData,l=s.exData,u=(void 0===l?{}:l).dataPageSize,d=t({},this.prevModuleData||r),c=n?this.getModuleDataFromClassify(d,null==o?void 0:o.classifyId):d;this.triggerEvent("moduleCallback",{type:"queryModuleData",moduleData:c,params:t({dataPageSize:u},o),callback:function(a){var n,s,r=a.resModuleData,l=r.content,u=(null==l?void 0:l.items)||[];e.rprmExposure({originGoodList:u,pagename:null===(n=e.data)||void 0===n||null===(s=n.exData)||void 0===s?void 0:s.pagename,pagenum:o.dataPageNum}),e.dataPageNum=o.dataPageNum,e.prevModuleData=t({},r),null==i||i(r),e.loadNextPageGoods(r)}})},getModuleDataFromClassify:function(a,e){var i=a.content,o=void 0===i?{}:i,n=o.classifyInfo,s=t(t({},void 0===n?{}:n),{},{classifyId:e}),r=t(t({},o),{},{classifyInfo:s});return t(t({},a),{},{content:r})},formatDataFromMargin:function(a){var e,i,o=a.style,n=void 0===o?{}:o,s=n.bottomMargin,r=n.topMargin;this.isSlide(a)?(e={bottomMargin:s,topMargin:0},i="padding-top: ".concat(r,"rpx; padding-bottom: 0rpx;")):(e={bottomMargin:0,topMargin:0},i="padding-top: ".concat(r,"rpx; padding-bottom: ").concat(s,"rpx;"));var l=t(t(t({},n),e),{},{isShowIntegral:!0});return{newModuleData:t(t({},a),{},{exStyle:{leftMargin:28,rightMargin:28},style:l}),goodCustomStyles:i}},isSlide:function(a){return 4===Number(null==a?void 0:a.styleGroup)},mergeDataSource:function(e){var i,o,s,r=this,l=e.content,u=void 0===l?{}:l,d=(null==u?void 0:u.items)||[],c=(null===(i=this.data)||void 0===i||null===(o=i.formatModuleData)||void 0===o||null===(s=o.content)||void 0===s?void 0:s.items)||[],g=[].concat(a(c),a(d)),m=t(t({},u),{},{items:g}),p=t(t({},e),{},{content:m});this.setData({formatModuleData:this.formatDataFromMargin(p).newModuleData},(function(){n.setTimeout((function(){r.triggerEvent("moduleCallback",{type:"updateModuleHeight",moduleData:e})}),200)}))},loadMore:function(a){var t=this,e=a.detail,i=(void 0===e?{}:e).callback,o=void 0===i?function(){}:i,n=this.dataPageNum+=1;this.asyncLoadData({params:{dataPageNum:n},callback:function(a){null==o||o(),t.mergeDataSource(a)}})},cartTapHandel:function(a){this.triggerEvent("moduleCallback",{type:"addCart",item:a.detail})},dotCallback:function(a){var e=this.data.moduleData;this.triggerEvent("moduleCallback",t(t({},a.detail),{},{moduleData:e}))},scrollFix:function(a){var t=a.detail,e=(void 0===t?{}:t).isFixed;this.setData({isFixed:e})},rprmExposure:function(a){var t=a.originGoodList,e=void 0===t?[]:t,i=(a.pagename,a.pagenum),o=void 0===i?1:i;if(Array.isArray(e)&&e.length>0){var n=e.map((function(a){return a.goodsId||a.id})),s=this.data.moduleData;this.triggerEvent("moduleCallback",{type:"moduleRec",moduleData:s,data:{en:"goods_exposure",eventtype:"exposure",elementid:"goods",goodslist:JSON.stringify(n),pagesize:n.length,pagenum:o}}),null==e||e.forEach((function(a){var t;null==u||u.callYouShuMethod("track","expose_sku_component",{sku:{sku_id:String(a.id),sku_name:a.title},spu:{spu_id:String(a.id),spu_name:a.title}});var e=a.id,i=a.title,o=a.minOriginalPrice,n=a.minSalePrice;null==u||null===(t=u.nativeReportEvent)||void 0===t||t.call(u,"wxdata_expose_goods",{spu_id:e,spu_name:i,sku_id:e,sku_name:i,price_original:parseInt(100*o),price_current:parseInt(100*n)})}))}},loadNextPageGoods:function(a){var t=this,e=this.data.exData,i=void 0===e?{}:e,o=a.hasNextPage;if(i.hasLocationMenu&&o&&!this.isSlide(a)){var n=this.dataPageNum+=1;this.asyncLoadData({params:{dataPageNum:n},callback:function(a){t.mergeDataSource(a)}})}},isManualLoadMoreFun:function(a){var t=this.isSlide(a);return(this.data.exData||{}).hasLocationMenu&&!t},onGoodsListLoadEnd:function(){var a=this.data.moduleData,t=void 0===a?{}:a;this.setData({goodCustomStyles:this.formatDataFromMargin(t).goodCustomStyles})}}}),global.ec(o);
},{isPage:false,isComponent:true,currentFile:'cms_design/RAW/miniprogram_npm/@design-ec/wx-goods/index.js'});require("cms_design/RAW/miniprogram_npm/@design-ec/wx-goods/index.js");